(function(t){function e(e){for(var n,a,s=e[0],c=e[1],h=e[2],l=0,d=[];l<s.length;l++)a=s[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(d.length)d.shift()();return r.push.apply(r,h||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],n=!0,a=1;a<i.length;a++){var c=i[a];0!==o[c]&&(n=!1)}n&&(r.splice(e--,1),t=s(s.s=i[0]))}return t}var n={},o={app:0},r=[];function a(t){return s.p+"js/"+({about:"about"}[t]||t)+"."+{about:"d5dbac9e"}[t]+".js"}function s(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.e=function(t){var e=[],i=o[t];if(0!==i)if(i)e.push(i[2]);else{var n=new Promise((function(e,n){i=o[t]=[e,n]}));e.push(i[2]=n);var r,c=document.createElement("script");c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.src=a(t);var h=new Error;r=function(e){c.onerror=c.onload=null,clearTimeout(l);var i=o[t];if(0!==i){if(i){var n=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;h.message="Loading chunk "+t+" failed.\n("+n+": "+r+")",h.name="ChunkLoadError",h.type=n,h.request=r,i[1](h)}o[t]=void 0}};var l=setTimeout((function(){r({type:"timeout",target:c})}),12e4);c.onerror=c.onload=r,document.head.appendChild(c)}return Promise.all(e)},s.m=t,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],h=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=h;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"195e":function(t,e,i){},"20df":function(t,e,i){"use strict";i("6ae5")},"362c":function(t,e,i){},"3c95":function(t,e,i){},"495b":function(t,e,i){},"4a0b":function(t,e,i){"use strict";i("195e")},"54c1":function(t,e,i){"use strict";i("bae3")},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("7a23"),o={id:"app",class:"blackbg"},r=Object(n["h"])("div",{class:"spinner-border text-secondary",style:{width:"4rem",height:"4rem"},role:"status"},null,-1),a={key:1,id:"main-workspace"};function s(t,e,i,s,c,h){var l=Object(n["v"])("Header"),u=Object(n["v"])("Main"),d=Object(n["v"])("Footer");return Object(n["q"])(),Object(n["d"])("div",o,[c.showLoader?(Object(n["q"])(),Object(n["d"])("div",{key:0,id:"main-loader",class:["blackbg",c.loaded?"fadeout":""]},[r],2)):(Object(n["q"])(),Object(n["d"])("div",a,[Object(n["h"])(l,{"onDocument:new":h.newDocument,"onSvg:create":h.createSVG},null,8,["onDocument:new","onSvg:create"]),Object(n["h"])(u,{ref:"main","onTooltip:update":h.tooltipUpdate,"onDocument:update":h.documentUpdate},null,8,["onTooltip:update","onDocument:update"]),Object(n["h"])(d,{tooltip:c.tooltip},null,8,["tooltip"])]))])}var c={id:"header",class:"darkbg navbar navbar-expand-sm navbar-dark"},h={class:"container-fluid"},l=Object(n["f"])('<label class="navbar-brand"><span style="font-weight:bold;">MU</span><span style="color:#aaaaaa;">LIN</span></label><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDarkDropdown" aria-controls="navbarNavDarkDropdown" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>',2),u={class:"collapse navbar-collapse",id:"navbarNavDarkDropdown"},d={class:"navbar-nav"},f={class:"nav-item dropdown"},p=Object(n["h"])("a",{class:"nav-link dropdown-toggle",id:"navbarDarkDropdownMenuLink",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," File ",-1),v={class:"dropdown-menu","aria-labelledby":"navbarDarkDropdownMenuLink"},b=Object(n["h"])("li",null,[Object(n["h"])("a",{class:"dropdown-item"},"Open")],-1);function y(t,e,i,o,r,a){var s=Object(n["v"])("new-doc-dialog");return Object(n["q"])(),Object(n["d"])("nav",c,[Object(n["h"])("div",h,[l,Object(n["h"])("div",u,[Object(n["h"])("ul",d,[Object(n["h"])("li",f,[p,Object(n["h"])("ul",v,[Object(n["h"])("li",null,[Object(n["h"])("a",{class:"dropdown-item",onClick:e[1]||(e[1]=function(){return a.openNewDocDialog&&a.openNewDocDialog.apply(a,arguments)})},"New")]),b,Object(n["h"])("li",null,[Object(n["h"])("a",{class:"dropdown-item",onClick:e[2]||(e[2]=function(){return a.generateSVG&&a.generateSVG.apply(a,arguments)})},"Download SVG")])])])])]),Object(n["h"])(s,{show:r.showDocDialog,"onDialog:hidden":a.docDialogHidden},null,8,["show","onDialog:hidden"])])])}i("b0c0");var g={class:"modal fade",id:"new-doc-dialog",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"},m={class:"modal-dialog modal-dialog-centered doc-root"},k={class:"modal-content"},O=Object(n["h"])("div",{class:"modal-header"},[Object(n["h"])("h5",{class:"modal-title",id:"staticBackdropLabel"},[Object(n["h"])("i",{class:"iconfont icon-document"}),Object(n["g"])(" New Document ")]),Object(n["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),j={class:"modal-body"},w={class:"container"},x={class:"row"},C={class:"row",style:{"margin-top":"20px"}},_={class:"col"},S={class:"input-group"},P=Object(n["h"])("span",{class:"input-group-text"},"Width",-1),F=Object(n["h"])("span",{class:"input-group-text"},"px",-1),A={class:"col"},T={class:"input-group"},R=Object(n["h"])("span",{class:"input-group-text"},"Height",-1),M=Object(n["h"])("span",{class:"input-group-text"},"px",-1),D={class:"modal-footer"},V=Object(n["h"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function B(t,e,i,o,r,a){return Object(n["q"])(),Object(n["d"])("div",g,[Object(n["h"])("div",m,[Object(n["h"])("div",k,[O,Object(n["h"])("div",j,[Object(n["h"])("div",w,[Object(n["h"])("div",x,[Object(n["E"])(Object(n["h"])("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":e[1]||(e[1]=function(t){return r.selectedTemplate=t})},[(Object(n["q"])(!0),Object(n["d"])(n["a"],null,Object(n["u"])(r.sizeTemplate,(function(t){return Object(n["q"])(),Object(n["d"])("option",{key:t.name},Object(n["x"])(t.name),1)})),128))],512),[[n["A"],r.selectedTemplate]])]),Object(n["h"])("div",C,[Object(n["h"])("div",_,[Object(n["h"])("div",S,[P,Object(n["E"])(Object(n["h"])("input",{"onUpdate:modelValue":e[2]||(e[2]=function(t){return r.width=t}),type:"number",class:"form-control","aria-label":"Amount (to the nearest dollar)"},null,512),[[n["B"],r.width]]),F])]),Object(n["h"])("div",A,[Object(n["h"])("div",T,[R,Object(n["E"])(Object(n["h"])("input",{"onUpdate:modelValue":e[3]||(e[3]=function(t){return r.height=t}),type:"number",class:"form-control","aria-label":"Amount (to the nearest dollar)"},null,512),[[n["B"],r.height]]),M])])])])]),Object(n["h"])("div",D,[V,Object(n["h"])("button",{type:"button",class:"btn btn-primary",onClick:e[4]||(e[4]=function(){return a.createDocument&&a.createDocument.apply(a,arguments)})}," Create ")])])])])}i("c35a"),i("a9e3"),i("159b");var E={name:"NewDocumentDialog",emits:["dialog:hidden","dialog:shown"],mounted:function(){var t=this,e=document.getElementById("new-doc-dialog");e&&(e.addEventListener("hidden.bs.modal",(function(e){t.$emit("dialog:hidden",{type:t.type,width:Number.parseFloat(t.width),height:Number.parseFloat(t.height)})})),e.addEventListener("shown.bs.modal",(function(e){t.$emit("dialog:shown")})),this.dialog=new bootstrap.Modal(e))},methods:{createDocument:function(){this.type="create",this.dialog.hide()}},data:function(){return{dialog:null,width:300,height:300,type:"cancel",sizeTemplate:[{name:"Custom",width:300,height:300},{name:"Letter",width:612,height:792},{name:"A4",width:595.28,height:841.89},{name:"A3",width:841.89,height:1190.55},{name:"B5",width:515.91,height:728.5},{name:"B4",width:728.5,height:1031.81}],selectedTemplate:"Custom"}},watch:{show:function(t,e){this.dialog&&(t?(this.type="cancel",this.dialog.show()):this.dialog.hide())},selectedTemplate:function(t,e){var i=this;this.sizeTemplate.forEach((function(e){e.name==t&&(i.width=e.width,i.height=e.height)}))}},props:{show:{type:Boolean,default:!1}}};i("8aa9");E.render=B;var q=E,I={name:"Header",components:{NewDocDialog:q},emits:["document:new","svg:create"],data:function(){return{showDocDialog:!1}},methods:{openNewDocDialog:function(t){this.showDocDialog||(this.showDocDialog=!0)},docDialogHidden:function(t){this.showDocDialog=!1,"create"==t.type&&this.$emit("document:new",t)},generateSVG:function(){this.$emit("svg:create")}}};i("be6a");I.render=y;var z=I,H={id:"editor-main"},N={id:"main-left",class:"blackbg"},L={id:"main-center"},G={id:"main-right"};function U(t,e,i,o,r,a){var s=Object(n["v"])("document"),c=Object(n["v"])("Canvas"),h=Object(n["v"])("PropertyBar");return Object(n["q"])(),Object(n["d"])("div",H,[Object(n["h"])("div",N,[Object(n["h"])(s,{nodes:a.nodes},null,8,["nodes"])]),Object(n["h"])("div",L,[Object(n["h"])(c,{ref:"canvas","onSelection:change":a.selectionChange,"onTooltip:update":a.tooltipUpdate,"onRoot:update":a.rootFigureUpdate},null,8,["onSelection:change","onTooltip:update","onRoot:update"])]),Object(n["h"])("div",G,[Object(n["h"])(h,{currentSelections:r.selections,"onProperty:change":a.propertyChange},null,8,["currentSelections","onProperty:change"])])])}i("ac1f"),i("1276");var W={id:"tool",class:"darkbg"};function Y(t,e,i,o,r,a){return Object(n["q"])(),Object(n["d"])("div",W,[(Object(n["q"])(!0),Object(n["d"])(n["a"],null,Object(n["u"])(r.tools,(function(t){return Object(n["q"])(),Object(n["d"])("div",{key:t.id,class:["icon-container",t.split?"icon-spliter":""]},[Object(n["h"])("i",{onClick:e[1]||(e[1]=function(){return a.click&&a.click.apply(a,arguments)}),id:t.id,class:["iconfont",t.icon+" "+a.iconClass(t.id)]},null,10,["id"])],2)})),128))])}var K={name:"ToolsBar",emits:["tool:update"],props:{currentTool:{type:String,default:null},disabled:{type:Boolean,default:!0}},data:function(){return{tools:[{id:"select",icon:"icon-mousepointer"},{id:"vertex-select",icon:"icon-vertexpointer",split:!0},{id:"pen",icon:"icon-pen",split:!0},{id:"line",icon:"icon-square"},{id:"rect",icon:"icon-square"},{id:"ellipse",icon:"icon-circle"},{id:"star",icon:"icon-star"},{id:"polygon",icon:"icon-polygon",split:!0}]}},methods:{click:function(t){if(!this.disabled){var e=t.currentTarget.id;e&&this.currentTool!=e&&this.$emit("tool:update",e)}},iconClass:function(t){return this.disabled?"deactive-icon":this.isActive(t)?"active-tool":"deactive-icon clickable-icon"},isActive:function(t){return t==this.currentTool&&!this.disabled}}};i("8358");K.render=Y;var X=K,$={id:"property-view",class:"darkbg"},Q={id:"selection-title"},J={id:"properties-accordions-container"},Z={class:"accordion accordion-flush properties-accordion-root",id:"collapse-root"},tt={class:"accordion-item properties-accordion-item"},et=Object(n["h"])("h2",{class:"accordion-header",id:"basic-properties"},[Object(n["h"])("button",{id:"accordion-button1",class:"accordion-button properties-accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne","aria-expanded":"true","aria-controls":"flush-collapseOne"},[Object(n["h"])("i",{class:"iconfont icon-position",style:{"margin-right":"5px"}}),Object(n["h"])("span",null,"Transform")])],-1),it={id:"flush-collapseOne",class:"accordion-collapse collapse show","aria-labelledby":"basic-properties","data-bs-parent":"#collapse-root"},nt={class:"property-accordion-contents"},ot={key:0,class:"property-row"},rt={key:1,class:"property-row"},at={key:2,class:"property-row"},st={key:3,class:"property-row"},ct={key:4,class:"property-row"},ht={key:5,class:"property-row"},lt={key:6,class:"sub-property-row"},ut={id:"vertex-type-container"},dt={style:{width:"100%","text-align":"start",margin:"5px 0 0px 0"}},ft=Object(n["h"])("div",{style:{"margin-bottom":"5px"}},[Object(n["h"])("small",null,"Vertex Type")],-1),pt={class:"pagination pagination-sm justify-content-start"},vt=Object(n["h"])("label",{class:"page-link"},[Object(n["h"])("i",{class:"fas fa-wave-square"})],-1),bt=Object(n["h"])("label",{class:"page-link"},[Object(n["h"])("i",{class:"fas fa-bezier-curve"})],-1),yt=Object(n["h"])("label",{class:"page-link"},[Object(n["h"])("i",{class:"fas fa-code-branch"})],-1),gt=Object(n["h"])("div",{style:{height:"1px",width:"100%","background-color":"#444444"}},null,-1),mt={key:7,class:"sub-property-row"},kt={class:"property-row"},Ot={key:8,class:"sub-property-row"},jt={class:"property-row"},wt={key:9,class:"sub-property-row"},xt={class:"single-row"},Ct={class:"form-check form-switch"},_t=Object(n["h"])("label",{for:"closePath"},"Closed",-1),St={key:10,class:"sub-property-row"},Pt={class:"single-row"},Ft={class:"form-check form-switch"},At=Object(n["h"])("label",{for:"inController"},"In Controller",-1),Tt={key:0,class:"property-row"},Rt={key:11,class:"sub-property-row"},Mt={class:"single-row"},Dt={class:"form-check form-switch"},Vt=Object(n["h"])("label",{for:"outController"},"Out Controller",-1),Bt={key:0,class:"property-row"},Et={class:"accordion-item properties-accordion-item"},qt=Object(n["h"])("h2",{class:"accordion-header",id:"border-property"},[Object(n["h"])("button",{class:"accordion-button collapsed properties-accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseTwo","aria-expanded":"false","aria-controls":"flush-collapseTwo"},[Object(n["h"])("i",{class:"iconfont icon-border",style:{"margin-right":"5px"}}),Object(n["g"])(" Border ")])],-1),It={id:"flush-collapseTwo",class:"accordion-collapse collapse","aria-labelledby":"border-property","data-bs-parent":"#collapse-root"},zt={class:"property-accordion-contents"},Ht={class:"accordion-item properties-accordion-item"},Nt=Object(n["h"])("h2",{class:"accordion-header",id:"flush-headingThree"},[Object(n["h"])("button",{class:"accordion-button collapsed properties-accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseThree","aria-expanded":"false","aria-controls":"flush-collapseThree"},[Object(n["h"])("i",{class:"iconfont icon-fill",style:{"margin-right":"5px"}}),Object(n["g"])(" Fill ")])],-1),Lt={id:"flush-collapseThree",class:"accordion-collapse collapse","aria-labelledby":"flush-headingThree","data-bs-parent":"#collapse-root"},Gt={class:"property-accordion-contents"};function Ut(t,e,i,o,r,a){var s=Object(n["v"])("Property"),c=Object(n["v"])("BorderProperty"),h=Object(n["v"])("fill-property");return Object(n["q"])(),Object(n["d"])("div",$,[Object(n["h"])("div",Q,[Object(n["h"])("i",{id:"title-icon",class:["iconfont",a.titleIcon]},null,2),Object(n["h"])("strong",null,Object(n["x"])(a.title),1)]),Object(n["h"])("div",J,[Object(n["h"])("div",Z,[Object(n["h"])("div",tt,[et,Object(n["h"])("div",it,[Object(n["h"])("div",nt,[a.canShow?(Object(n["q"])(),Object(n["d"])("div",ot,[Object(n["h"])(s,{name:"x",pk:"x",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"]),Object(n["h"])(s,{name:"y",pk:"y",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"])])):Object(n["e"])("",!0),a.showDimension?(Object(n["q"])(),Object(n["d"])("div",rt,[Object(n["h"])(s,{name:"width",pk:"width",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"]),Object(n["h"])(s,{name:"height",pk:"height",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"])])):Object(n["e"])("",!0),a.showScale?(Object(n["q"])(),Object(n["d"])("div",at,[Object(n["h"])(s,{name:"scaleX",pk:"scalex",step:.1,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["step","selections","onProperty:change"]),Object(n["h"])(s,{name:"scaleY",pk:"scaley",step:.1,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["step","selections","onProperty:change"])])):Object(n["e"])("",!0),a.showSkew?(Object(n["q"])(),Object(n["d"])("div",st,[Object(n["h"])(s,{name:"skewX",pk:"skewx",transformToAngel:!0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"]),Object(n["h"])(s,{name:"skewY",pk:"skewy",transformToAngel:!0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"])])):Object(n["e"])("",!0),a.showRotation?(Object(n["q"])(),Object(n["d"])("div",ct,[Object(n["h"])(s,{name:"rotation",pk:"rotation",transformToAngel:!0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"])])):Object(n["e"])("",!0),a.isRect?(Object(n["q"])(),Object(n["d"])("div",ht,[Object(n["h"])(s,{name:"radiusX",pk:"radiusx",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"]),Object(n["h"])(s,{name:"radiusY",pk:"radiusy",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"])])):Object(n["e"])("",!0),a.isVertex?(Object(n["q"])(),Object(n["d"])("div",lt,[Object(n["h"])("div",ut,[Object(n["h"])("div",dt,[ft,Object(n["h"])("ul",pt,[Object(n["h"])("li",{id:"vertexType0",onClick:e[1]||(e[1]=Object(n["G"])((function(){return a.changeVertexType&&a.changeVertexType.apply(a,arguments)}),["stop"])),class:[0==a.vertexType?"active":"","page-item"]},[vt],2),Object(n["h"])("li",{id:"vertexType1",class:["page-item",1==a.vertexType?"active":""],onClick:e[2]||(e[2]=Object(n["G"])((function(){return a.changeVertexType&&a.changeVertexType.apply(a,arguments)}),["stop"]))},[bt],2),Object(n["h"])("li",{id:"vertexType2",class:["page-item",2==a.vertexType?"active":""],onClick:e[3]||(e[3]=Object(n["G"])((function(){return a.changeVertexType&&a.changeVertexType.apply(a,arguments)}),["stop"]))},[yt],2)])]),gt])])):Object(n["e"])("",!0),a.isStar?(Object(n["q"])(),Object(n["d"])("div",mt,[Object(n["h"])("div",kt,[Object(n["h"])(s,{name:"corners",pk:"corners",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"]),Object(n["h"])(s,{name:"inner",pk:"radius",fixed:2,step:.1,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["step","selections","onProperty:change"])])])):Object(n["e"])("",!0),a.isPolygon?(Object(n["q"])(),Object(n["d"])("div",Ot,[Object(n["h"])("div",jt,[Object(n["h"])(s,{name:"sides",pk:"sides",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"])])])):Object(n["e"])("",!0),a.isPath?(Object(n["q"])(),Object(n["d"])("div",wt,[Object(n["h"])("div",xt,[Object(n["h"])("div",Ct,[_t,Object(n["h"])("input",{onChange:e[4]||(e[4]=function(){return a.pathCloseChange&&a.pathCloseChange.apply(a,arguments)}),checked:a.pathClosed,class:"form-check-input",type:"checkbox",id:"closePath"},null,40,["checked"])])])])):Object(n["e"])("",!0),a.showIn?(Object(n["q"])(),Object(n["d"])("div",St,[Object(n["h"])("div",Pt,[Object(n["h"])("div",Ft,[At,Object(n["h"])("input",{onChange:e[5]||(e[5]=function(){return a.controllerChange&&a.controllerChange.apply(a,arguments)}),checked:a.hasInController,class:"form-check-input",type:"checkbox",id:"inController"},null,40,["checked"])])]),a.hasInController?(Object(n["q"])(),Object(n["d"])("div",Tt,[Object(n["h"])(s,{name:"x",pk:"inX",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"]),Object(n["h"])(s,{name:"y",pk:"inY",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"])])):Object(n["e"])("",!0)])):Object(n["e"])("",!0),a.showIn?(Object(n["q"])(),Object(n["d"])("div",Rt,[Object(n["h"])("div",Mt,[Object(n["h"])("div",Dt,[Vt,Object(n["h"])("input",{onChange:e[6]||(e[6]=function(){return a.controllerChange&&a.controllerChange.apply(a,arguments)}),checked:a.hasOutController,class:"form-check-input",type:"checkbox",id:"outController"},null,40,["checked"])])]),a.hasOutController?(Object(n["q"])(),Object(n["d"])("div",Bt,[Object(n["h"])(s,{name:"x",pk:"outX",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"]),Object(n["h"])(s,{name:"y",pk:"outY",fixed:0,selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"])])):Object(n["e"])("",!0)])):Object(n["e"])("",!0)])])]),Object(n["h"])("div",Et,[qt,Object(n["h"])("div",It,[Object(n["h"])("div",zt,[Object(n["h"])(c,{selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"])])])]),Object(n["h"])("div",Ht,[Nt,Object(n["h"])("div",Lt,[Object(n["h"])("div",Gt,[Object(n["h"])(h,{selections:i.currentSelections,"onProperty:change":a.propertyChange},null,8,["selections","onProperty:change"])])])])])])])}i("a15b");var Wt={key:0,style:{"text-algin":"left",color:"grey"}},Yt=Object(n["h"])("small",null,"Nothing",-1),Kt={key:1},Xt={class:"sub-property-row"},$t={class:"single-row"},Qt={class:"form-check form-switch"},Jt=Object(n["h"])("label",{for:"showBorder"},"Show border",-1),Zt=Object(n["h"])("div",{class:"gray-splitter"},null,-1),te={key:0},ee={class:"property-row"},ie={class:"property-item"},ne=Object(n["h"])("label",{class:"property-lable"},"width",-1),oe={class:"property-item"},re=Object(n["h"])("label",{class:"property-lable"},"miter",-1),ae={class:"sub-property-row"},se={id:"vertex-type-container"},ce={style:{width:"100%","text-align":"start",margin:"5px 0 0px 0"}},he=Object(n["h"])("div",{style:{"margin-bottom":"5px"}},[Object(n["h"])("small",null,"Join")],-1),le={class:"pagination pagination-sm justify-content-center"},ue=Object(n["h"])("label",{class:"page-link"},"Bevel",-1),de=Object(n["h"])("label",{class:"page-link"},"Miter",-1),fe=Object(n["h"])("label",{class:"page-link"},"Round",-1),pe=Object(n["h"])("div",{class:"gray-splitter"},null,-1),ve={class:"sub-property-row"},be={id:"vertex-type-container"},ye={style:{width:"100%","text-align":"start",margin:"5px 0 0px 0"}},ge=Object(n["h"])("div",{style:{"margin-bottom":"5px"}},[Object(n["h"])("small",null,"Cap")],-1),me={class:"pagination pagination-sm justify-content-center"},ke=Object(n["h"])("label",{class:"page-link"},"Butt",-1),Oe=Object(n["h"])("label",{class:"page-link"},"Round",-1),je=Object(n["h"])("label",{class:"page-link"},"Square",-1),we=Object(n["h"])("div",{class:"gray-splitter"},null,-1),xe=Object(n["h"])("div",{style:{"margin-top":"10px","text-align":"left"}},[Object(n["h"])("small",null,"Color")],-1),Ce={class:"sub-property-row"};function _e(t,e,i,o,r,a){var s=Object(n["v"])("ColorProperty");return Object(n["q"])(),Object(n["d"])("div",null,[t.hasBorderOrFillProperty?(Object(n["q"])(),Object(n["d"])("div",Kt,[Object(n["h"])("div",Xt,[Object(n["h"])("div",$t,[Object(n["h"])("div",Qt,[Jt,Object(n["h"])("input",{onChange:e[1]||(e[1]=function(){return a.showBorderChange&&a.showBorderChange.apply(a,arguments)}),checked:a.showBorder,class:"form-check-input",type:"checkbox",id:"showBorder"},null,40,["checked"])])]),Zt,a.showBorder?(Object(n["q"])(),Object(n["d"])("div",te,[Object(n["h"])("div",ee,[Object(n["h"])("div",ie,[ne,Object(n["E"])(Object(n["h"])("input",{"onUpdate:modelValue":e[2]||(e[2]=function(t){return a.width=t}),id:"border-width",class:"form-control form-control-sm property-input",type:"number",onClick:e[3]||(e[3]=function(){return t.selectText&&t.selectText.apply(t,arguments)}),onKeypress:e[4]||(e[4]=Object(n["F"])((function(){return t.confirm&&t.confirm.apply(t,arguments)}),["enter"]))},null,544),[[n["B"],a.width,void 0,{lazy:!0}]])]),Object(n["h"])("div",oe,[re,Object(n["E"])(Object(n["h"])("input",{"onUpdate:modelValue":e[5]||(e[5]=function(t){return a.miter=t}),id:"border-miter",class:"form-control form-control-sm property-input",type:"number",onClick:e[6]||(e[6]=function(){return t.selectText&&t.selectText.apply(t,arguments)}),onKeypress:e[7]||(e[7]=Object(n["F"])((function(){return t.confirm&&t.confirm.apply(t,arguments)}),["enter"]))},null,544),[[n["B"],a.miter,void 0,{lazy:!0}]])])]),Object(n["h"])("div",ae,[Object(n["h"])("div",se,[Object(n["h"])("div",ce,[he,Object(n["h"])("ul",le,[Object(n["h"])("li",{id:"Bevel",onClick:e[8]||(e[8]=Object(n["G"])((function(){return a.changeJoinType&&a.changeJoinType.apply(a,arguments)}),["stop"])),class:[2==a.join.value?"active":"","page-item"]},[ue],2),Object(n["h"])("li",{id:"Miter",class:["page-item",0==a.join.value?"active":""],onClick:e[9]||(e[9]=Object(n["G"])((function(){return a.changeJoinType&&a.changeJoinType.apply(a,arguments)}),["stop"]))},[de],2),Object(n["h"])("li",{id:"Round",class:["page-item",1==a.join.value?"active":""],onClick:e[10]||(e[10]=Object(n["G"])((function(){return a.changeJoinType&&a.changeJoinType.apply(a,arguments)}),["stop"]))},[fe],2)])]),pe])]),Object(n["h"])("div",ve,[Object(n["h"])("div",be,[Object(n["h"])("div",ye,[ge,Object(n["h"])("ul",me,[Object(n["h"])("li",{id:"Butt",onClick:e[11]||(e[11]=Object(n["G"])((function(){return a.changeCapType&&a.changeCapType.apply(a,arguments)}),["stop"])),class:[0==a.cap.value?"active":"","page-item"]},[ke],2),Object(n["h"])("li",{id:"Round",class:["page-item",1==a.cap.value?"active":""],onClick:e[12]||(e[12]=Object(n["G"])((function(){return a.changeCapType&&a.changeCapType.apply(a,arguments)}),["stop"]))},[Oe],2),Object(n["h"])("li",{id:"Square",class:["page-item",2==a.cap.value?"active":""],onClick:e[13]||(e[13]=Object(n["G"])((function(){return a.changeCapType&&a.changeCapType.apply(a,arguments)}),["stop"]))},[je],2)])])])]),we,xe,Object(n["h"])("div",Ce,[Object(n["h"])(s,{selections:i.selections,"onProperty:change":a.colorChanged,rk:"br",gk:"bg",bk:"bb",ak:"ba"},null,8,["selections","onProperty:change"])])])):Object(n["e"])("",!0)])])):(Object(n["q"])(),Object(n["d"])("div",Wt,[Yt]))])}i("25eb");var Se={methods:{confirm:function(t){t.target.select()},selectText:function(t){t.target.select()}}},Pe=i("d4ec"),Fe=i("bee2"),Ae=i("1341"),Te=i("45eb"),Re=i("7e84"),Me=i("262e"),De=i("2caf"),Ve=(i("cb29"),i("ade3")),Be=(i("d3b7"),Math.pow(2,31)),Ee=function(){function t(){Object(Pe["a"])(this,t)}return Object(Fe["a"])(t,null,[{key:"newID",value:function(){return null==this.currentId&&(this.currentId=0),this.currentId+=1,this.currentId>Be&&(this.currentId=0),this.currentId}},{key:"initCanvasKit",value:function(t){var e=this;return new Promise((function(i,n){CanvasKitInit({locateFile:function(e){return t+e}}).then((function(t){window&&(window.CanvasKit=t),e.CanvasKit=t,i(t)}))}))}},{key:"ClipOp",get:function(){return this.CanvasKit.ClipOp}},{key:"StrokeCap",get:function(){return this.CanvasKit.StrokeCap}},{key:"StrokeJoin",get:function(){return this.CanvasKit.StrokeJoin}},{key:"makeCanvasSurface",value:function(t){return this.CanvasKit.MakeCanvasSurface(t)}},{key:"newPaint",value:function(){if(CanvasKit)return new this.CanvasKit.Paint}},{key:"newPath",value:function(){if(CanvasKit)return new this.CanvasKit.Path}},{key:"TRANSPARENT",get:function(){return this.CanvasKit.TRANSPARENT}},{key:"fillStyle",get:function(){return this.CanvasKit.PaintStyle.Fill}},{key:"strokeStyle",get:function(){return this.CanvasKit.PaintStyle.Stroke}},{key:"newXYWHRect",value:function(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return CanvasKit.XYWHRect(t,e,i,n,o)}},{key:"newRRectXY",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return CanvasKit.RRectXY(t,e,i,n)}},{key:"getJoinText",value:function(t){return t.value==this.StrokeJoin.Bevel.value?"bevel":t.value==this.StrokeJoin.Round.value?"round":t.value==this.StrokeJoin.Miter.value?"miter":void 0}},{key:"getCapText",value:function(t){return t.value==this.StrokeCap.Butt.value?"butt":t.value==this.StrokeCap.Round.value?"round":t.value==this.StrokeCap.Square.value?"square":void 0}}]),t}();Object(Ve["a"])(Ee,"CanvasKit",void 0),Object(Ve["a"])(Ee,"currentId",void 0);var qe=i("1da1"),Ie=(i("96cf"),i("99af"),i("a434"),i("257e")),ze=(i("4ec9"),i("3ca3"),i("ddb0"),function(){function t(){Object(Pe["a"])(this,t)}return Object(Fe["a"])(t,[{key:"dispose",value:function(){this._eventHandlers&&(this._eventHandlers.forEach((function(t,e){t.length=0})),this._eventHandlers.clear(),this._eventHandlers=null)}},{key:"fireEvent",value:function(t,e){var i=this;if(null!=this._eventHandlers){var n=this._eventHandlers.get(t);n&&n.forEach((function(t){t({source:i,event:e})}))}}},{key:"on",value:function(t,e){null==this._eventHandlers&&(this._eventHandlers=new Map);var i=this._eventHandlers.get(t);i||(i=[],this._eventHandlers.set(t,i)),i.push(e)}},{key:"off",value:function(t,e){if(this._eventHandlers){var i=this._eventHandlers.get(t);if(i){var n=i.indexOf(e);-1!=n&&i.splice(n,1)}}}}]),t}()),He=(i("cfc3"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),null),Ne=null,Le=(Math.PI,function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Float32Array(9);Object(Pe["a"])(this,t),this._array=e,this.identity()}return Object(Fe["a"])(t,[{key:"isIdentity",value:function(){var t=this._array;return 1==t[0]&&0==t[1]&&0==t[2]&&0==t[3]&&1==t[4]&&0==t[5]&&0==t[6]&&0==t[7]&&1==t[8]}},{key:"data",get:function(){return this._array}},{key:"clone",value:function(){for(var e=new t,i=this.data,n=e.data,o=0;o<i.length;o++)n[o]=i[o];return e}},{key:"from",value:function(t){for(var e=this.data,i=t.data,n=0;n<e.length;n++)e[n]=i[n]}},{key:"decompose",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.data,i=e[0],n=e[1],o=e[2],r=e[3],a=e[4],s=e[5],c={x:o,y:s},h=0,l={x:1,y:1},u={x:0,y:0},d=i*a-r*n;if(t)if(0!=i||0!=r){var f=Math.sqrt(i*i+r*r);h=r>0?Math.acos(i/f):-Math.acos(i/f),l.x=f,l.y=d/f,u.x=Math.atan((i*n+r*a)/(f*f))}else if(0!=n||0!=a){var p=Math.sqrt(n*n+a*a);h=Math.PI/2-(a>0?Math.acos(-n/p):-Math.acos(n/p)),l.x=d/p,l.y=p,u.y=Math.atan((i*n+r*a)/(p*p))}else l.x=l.y=0;else 0!=i?(u.y=Math.atan(r/i),l.x=i,l.y=d/i,u.x=Math.atan(n/i)):0!=r?(h=Math.PI/2,l.x=r,l.y=d/r,u.x=Math.atan(a/r)):(l.x=n,l.y=a,u.x=Math.PI/4,l.x=0,l.y=1);return{translation:c,rotation:h,scale:l,skew:u}}},{key:"identity",value:function(){var t=this._array;return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,this}},{key:"rotate",value:function(t){var e=Math.cos(t),i=Math.sin(t);return this.multiplyWithSimpleDatas(e,i,-i,e,0,0),this}},{key:"skew",value:function(t,e){return this.multiplyWithSimpleDatas(1,Math.tan(e),Math.tan(t),1,0,0),this}},{key:"scale",value:function(t,e){return this.multiplyWithSimpleDatas(t,0,0,e,0,0),this}},{key:"translate",value:function(t,e){return this.multiplyWithSimpleDatas(1,0,0,1,t,e),this}},{key:"multiplyWithVertexDatas",value:function(t,e,i){null==i&&(i=new Float32Array(2));var n=this.data;return i[0]=n[0]*t+n[1]*e+n[2],i[1]=n[3]*t+n[4]*e+n[5],i}},{key:"multiplyWithVertex",value:function(t,e){return this.multiplyWithVertexDatas(t[0],t[1],e)}},{key:"multiplyWithDatas",value:function(t,e,i,n,o,r,a,s,c){var h=this.data,l=this.data,u=l[0],d=l[3],f=l[6],p=l[1],v=l[4],b=l[7],y=l[2],g=l[5],m=l[8];return h[0]=t*u+e*p+i*y,h[3]=t*d+e*v+i*g,h[6]=t*f+e*b+i*m,h[1]=n*u+o*p+r*y,h[4]=n*d+o*v+r*g,h[7]=n*f+o*b+r*m,h[2]=a*u+s*p+c*y,h[5]=a*d+s*v+c*g,h[8]=a*f+s*b+c*m,this}},{key:"multiplyWithSimpleDatas",value:function(t,e,i,n,o,r){var a=this.data,s=this.data,c=a[0],h=a[3],l=a[1],u=a[4],d=a[2],f=a[5];return s[0]=t*c+e*l,s[3]=t*h+e*u,s[1]=i*c+n*l,s[4]=i*h+n*u,s[2]=o*c+r*l+d,s[5]=o*h+r*u+f,this}},{key:"invert",value:function(){return this.getInvert(this)}},{key:"getInvert",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t,i=e.data,n=this.data,o=n[0],r=n[3],a=n[6],s=n[1],c=n[4],h=n[7],l=n[2],u=n[5],d=n[8],f=d*c-h*u,p=-d*s+h*l,v=u*s-c*l,b=o*f+r*p+a*v;return b?(b=1/b,i[0]=f*b,i[3]=(-d*r+a*u)*b,i[6]=(h*r-a*c)*b,i[1]=p*b,i[4]=(d*o-a*l)*b,i[7]=(-h*o+a*s)*b,i[2]=v*b,i[5]=(-u*o+r*l)*b,i[8]=(c*o-r*s)*b,e):null}},{key:"simpleMultiply",value:function(t){var e=t.data;return this.multiplyWithSimpleDatas(e[0],e[3],e[1],e[4],e[2],e[5])}},{key:"multiply",value:function(t){var e=t.data;return this.multiplyWithDatas(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])}},{key:"toSVGMatrix",value:function(){var t=this.data;return{a:t[0],b:t[3],c:t[1],d:t[4],e:t[2],f:t[5]}}}],[{key:"TEMP",get:function(){return null==He&&(He=new t,He.identity()),He}},{key:"TEMP2",get:function(){return null==Ne&&(Ne=new t,He.identity()),Ne}},{key:"copyFrom",value:function(t,e){var i=e.data,n=t.data;i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5]}},{key:"IdentityMatrix",value:function(e){null==e&&(e=new Float32Array(9));var i=new t(e);return i.identity()}}]),t}()),Ge=(i("25f0"),function(){function t(){Object(Pe["a"])(this,t)}return Object(Fe["a"])(t,null,[{key:"isContacted",value:function(t,e){return!(t.left>e.right||t.top>e.bottom||e.left>t.right||e.top>t.bottom)}},{key:"containsPoint",value:function(t,e,i){return t>=i.left&&t<=i.right&&e>=i.top&&e<=i.bottom}},{key:"transformToRelatedBounds",value:function(t,e){var i=[t.left,t.top],n=[t.right,t.bottom],o=e.multiplyWithVertex(i),r=e.multiplyWithVertex(n),a=Math.min(o[0],r[0]),s=Math.min(o[1],r[1]),c=Math.max(o[0],r[0]),h=Math.max(o[1],r[1]);return{left:a,top:s,right:c,bottom:h}}},{key:"transformRGBToHex",value:function(t,e,i){var n=t.toString(16);1==n.length&&(n="0"+n);var o=e.toString(16);1==o.length&&(o="0"+o);var r=i.toString(16);return 1==r.length&&(r="0"+r),"#".concat(n).concat(o).concat(r)}},{key:"decomposeMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.decompose(e)}},{key:"applyPose",value:function(t,e){t&&e&&(t.x=e.translation.x,t.y=e.translation.y,t.rotation=e.rotation,t.skewx=e.skew.x,t.skewy=e.skew.y,t.scaley=e.scale.y,t.scalex=e.scale.x)}},{key:"distance",value:function(t,e,i,n){var o=t-i,r=e-n;return Math.sqrt(o*o+r*r)}}]),t}()),Ue=2*Math.PI,We=Math.PI/2,Ye=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,width:0,height:0,scalex:1,scaley:1,rotation:0};return Object(Pe["a"])(this,i),t=e.call(this),t.getTarget=function(){return t.__target||(t.__target=Object(Ie["a"])(t)),t.__target},t.getTarget(),t.x=null==n||null==n.x?0:n.x,t.y=null==n||null==n.y?0:n.y,t.width=null==n||null==n.width?0:n.width,t.height=null==n||null==n.height?0:n.height,t.scalex=null==n||null==n.scalex?1:n.scalex,t.scaley=null==n||null==n.scaley?1:n.scaley,t.skewx=null==n||null==n.skewx?0:n.skewx,t.skewy=null==n||null==n.skewy?0:n.skewy,t.rotation=null==n||null==n.rotation?0:n.rotation,t._matrix=new Le,t._transformDirty=!0,t._boundsdirty=!0,t._bounds={left:0,top:0,right:0,bottom:0},t._axis,t.parent,t._disposed=!1,t}return Object(Fe["a"])(i,[{key:"isDisposed",get:function(){return this._disposed}},{key:"width",get:function(){return this._width},set:function(t){this._width!=t&&(this._width=t,this.fireTransformDirty(),this.fireBoundsDirty())}},{key:"height",get:function(){return this._height},set:function(t){this._height!=t&&(this._height=t,this.fireTransformDirty(),this.fireBoundsDirty())}},{key:"scalex",get:function(){return this._scalex},set:function(t){this._scalex!=t&&(this._scalex=t,this.fireTransformDirty())}},{key:"scaley",get:function(){return this._scaley},set:function(t){this._scaley!=t&&(this._scaley=t,this.fireTransformDirty())}},{key:"skewx",get:function(){return this._skewx},set:function(t){this._skewx!=t&&(this._skewx=t,this.fireTransformDirty())}},{key:"skewy",get:function(){return this._skewy},set:function(t){this._skewy!=t&&(this._skewy=t,this.fireTransformDirty())}},{key:"worldVertices",get:function(){for(var t=this.bounds,e=[[t.left,t.top],[t.right,t.top],[t.right,t.bottom],[t.left,t.bottom]],i=this.worldMatrix,n=[],o=0;o<e.length;o++)n.push(i.multiplyWithVertex(e[o]));return n}},{key:"axis",get:function(){return this._axis||(this._axis=[[1,0],[0,1]]),this._axis}},{key:"worldAxis",get:function(){var t=this.worldMatrix.clone(),e=this.axis;t.data[2]=0,t.data[5]=0;var i=[];return e.forEach((function(e){i.push(t.multiplyWithVertexDatas(e[0],e[1]))})),i}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation!=t&&(this._rotation=t,this.fireTransformDirty())}},{key:"x",get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.fireTransformDirty())}},{key:"y",get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.fireTransformDirty())}},{key:"matrix",get:function(){return this._transformDirty&&(i.calculateTransformableMatrix(this.x,this.y,this.width,this.height,this.rotation,this.scalex,this.scaley,this.skewx,this.skewy,this._matrix),this._transformDirty=!1),this._matrix}},{key:"worldMatrix",get:function(){if(this.parent){var t=this.parent.worldMatrix;return t.clone().multiply(this.matrix)}return this.matrix}},{key:"bounds",get:function(){return this._boundsdirty&&(this._bounds=this.calculateLocalBounds(this._bounds),this._boundsdirty=!1),this._bounds}},{key:"getRelateBounds",value:function(t){if(!t)return this.bounds;for(var e=this.bounds,i=[[e.left,e.top],[e.right,e.top],[e.right,e.bottom],[e.left,e.bottom]],n=[],o=0;o<i.length;o++)n.push(t.multiplyWithVertex(i[o]));var r={left:1/0,top:1/0,right:-1/0,bottom:-1/0};return n.forEach((function(t){r.left=Math.min(t[0],r.left),r.top=Math.min(t[1],r.top),r.right=Math.max(t[0],r.right),r.bottom=Math.max(t[1],r.bottom)})),r}},{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:left,top:top,right:right,bottom:bottom};return t.left=0,t.top=0,t.right=this.width,t.bottom=this.height,t}},{key:"worldBounds",get:function(){var t=this.worldVertices,e={left:1/0,top:1/0,right:-1/0,bottom:-1/0};return t.forEach((function(t){e.left=Math.min(t[0],e.left),e.top=Math.min(t[1],e.top),e.right=Math.max(t[0],e.right),e.bottom=Math.max(t[1],e.bottom)})),e}},{key:"fireBoundsDirty",value:function(){this._boundsdirty=!0,this.fireEvent("boundsDirty",!0)}},{key:"fireTransformDirty",value:function(){this._transformDirty=!0,this.fireEvent("transformDirty",!0)}},{key:"containsPoint",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t,o=e;if(i){var r=this.worldMatrix.clone(),a=r.invert().multiplyWithVertexDatas(n,o);n=a[0],o=a[1]}return Ge.containsPoint(n,o,this.bounds)}},{key:"dispose",value:function(){this.isDisposed||(this._disposed=!0,this.__target=null,this.fireEvent("disposed"),Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this))}}],[{key:"PI2",get:function(){return Ue}},{key:"HALF_PI",get:function(){return We}},{key:"calculateTransformableMatrix",value:function(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:new Le;if(0==r||0==a)return null;var l=h.identity();return l=l.translate(t,e),0!==o&&l.rotate(o),1===r&&1===a||l.scale(r,a),0===s&&0===c||l.skew(s,c),h}}]),i}(ze),Ke=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),n._id=Ee.newID(),n.children=[],n.showChildren=!0,n.visible=!0,n.clip=!1,n}return Object(Fe["a"])(i,[{key:"id",get:function(){return this._id},set:function(t){this._id=t}},{key:"isVisible",get:function(){return this.visible&&0!=this.width&&0!=this.height&&0!=this.scaley&&0!=this.scalex}},{key:"draw",value:function(t){this.isVisible&&(t.save(),this.beforeDrawSelf(),this.beforeTransform(),this.transform(t),this.clip&&this.applyClip(t),this.drawSelf(t),this.beforeDrawChildren(),this.drawChildren(t),t.restore())}},{key:"applyClip",value:function(t){}},{key:"beforeTransform",value:function(){}},{key:"transform",value:function(t){t.concat(this.matrix.data)}},{key:"beforeDrawSelf",value:function(){}},{key:"drawSelf",value:function(t){}},{key:"beforeDrawChildren",value:function(){}},{key:"drawChildren",value:function(t){this.showChildren&&this.children.forEach((function(e){e.draw(t)}))}},{key:"addChild",value:function(t){return this.insertChild(t,this.children.length)}},{key:"insertChild",value:function(t,e){if(-1==e||!t)return!1;if(null==t.parent){if(e>=this.children.length)return this.children.push(t),t.parent=this,this.fireEvent("addChild",{parent:this,child:t,index:this.children.length-1}),!0;this.children.push(t),t.parent=this;for(var i=this.children.length-1;i>e;i--){var n=this.children[i];this.children[i]=this.children[i-1],this.children[i-1]=n}return this.fireEvent("addChild",{parent:this,child:t,index:e}),!0}console.warn("cannot add child because it has a parent,please delete it first")}},{key:"indexOfChild",value:function(t){return this.children.indexOf(t)}},{key:"removeChild",value:function(t){if(t){var e=this.indexOfChild(t);return this.removeAt(e)}}},{key:"removeAt",value:function(t){if(-1!=t){var e=this.children.splice(t,1);if(e&&e[0]){var i=e[0];return i.parent=null,this.fireEvent("removeChild",{parent:this,child:i}),i}}}},{key:"moveIndex",value:function(t,e){if(t==e||t<0||t>this.children.length-1||e<0||e>this.children.length-1)console.warn("invalidate from/to index value :".concat(t," -> ").concat(e));else{if(t>e)for(var i=t;i>e;i--){var n=this.children[t-1];this.children[t-1]=this.children[t],this.children[t]=n}if(t<e)for(var o=t;o<e;o++){var r=this.children[t];this.children[t]=this.children[t+1],this.children[t+1]=r}}}},{key:"dispose",value:function(){this.isDisposed||(this.children.forEach((function(t){t.dispose()})),this.children.length=0,Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this))}},{key:"getSVGString",value:function(){var t=Object(qe["a"])(regeneratorRuntime.mark((function t(){var e,i,n,o,r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e="<".concat(this.getSVGLabelName(),' id="').concat(this.id,'"'),i=this.getSVGPositionString(),i&&(e+=" ".concat(i)),n=this.getSVGDimensionString(),n&&(e+=" ".concat(n)),o=this.getSVGExtensionString(),o&&(e+=" ".concat(o)),!(this.children.length>0)){t.next=29;break}e+=">",r=0;case 10:if(!(r<this.children.length)){t.next=25;break}return a=this.children[r],t.prev=12,t.next=15,a.getSVGString();case 15:s=t.sent,s&&(e+='     \n<g transform="'.concat(a.getSVGTransformString(),'">'),e+="        \n".concat(s),e+="     \n</g>"),t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](12),console.warn(t.t0);case 22:r++,t.next=10;break;case 25:return e+="\n</".concat(this.getSVGLabelName(),">"),t.abrupt("return",e);case 29:return e+="/>",t.abrupt("return",e);case 31:case"end":return t.stop()}}),t,this,[[12,19]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"getSVGTransformString",value:function(){var t="translate(".concat(this.x," ").concat(this.y,")");return 0!=this.rotation&&(t?t+=" ":t="",t+="rotate(".concat(180*this.rotation/Math.PI,")")),1==this.scalex&&1==this.scaley||(t?t+=" ":t="",t+="scale(".concat(this.scalex," ").concat(this.scaley,")")),0!=this.skewx&&(t?t+=" ":t="",t+="skewX(".concat(180*this.skewx/Math.PI,")")),0!=this.skewy&&(t?t+=" ":t="",t+="skewY(".concat(180*this.skewy/Math.PI,")")),t}},{key:"getSVGPositionString",value:function(){}},{key:"getSVGDimensionString",value:function(){return'width="'.concat(this.width,'" height="').concat(this.height,'"')}},{key:"getSVGLabelName",value:function(){return""}},{key:"getSVGExtensionString",value:function(){}}]),i}(Ye);function Xe(t,e){var i=1/0,n=-1/0;return t.forEach((function(t){var o=$e(e[0],e[1],t[0],t[1]);i=Math.min(i,o),n=Math.max(n,o)})),{min:i,max:n}}function $e(t,e,i,n){return t*i+e*n}function Qe(t,e){return!(t.min>e.max||e.min>t.max)}function Je(t,e,i,n){var o={},r=a(e,o);return!!r&&(r=a(n,o),!!r);function a(e,n){for(var o=0;o<e.length;o++){var r=e[o],a=0==r[0]?1/0:r[1]/r[0];if(!n[a]){n[a]=!0;var s=Xe(t,r),c=Xe(i,r),h=Qe(s,c);if(!h)return!1}}return!0}}var Ze={contactTest:Je},ti=i("53ca"),ei=0,ii=1,ni=2,oi=3,ri=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,top:0,right:0,bottom:0},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;if(Object(Pe["a"])(this,t),null==e)throw"QuadTree Bounds can not be null";this.totalNodesCount=0,this.bounds=e,this.maxNodes=i,this.currentDeepth=n,this.maxDeepth=o,this.nodes=[],this.areas=Array(4),this.parent}return Object(Fe["a"])(t,[{key:"findNodes",value:function(e){var i=this;if(!t.isContacted(e,this.bounds))return null;if(0!=this.nodes.length)return this.nodes;var n=function(){for(var t=[],n=i.areas.length-1;n>=0;n--){var o=i.areas[n];if(o){var r=o.findNodes(e);null!=r&&r.forEach((function(e){-1==t.indexOf(e)&&t.push(e)}))}}return{v:t}}();return"object"===Object(ti["a"])(n)?n.v:void 0}},{key:"findSingleNode",value:function(e,i){if(t.containsPoint(e,i,this.bounds)){if(0==this.nodes.length){for(var n=this.areas.length-1;n>=0;n--){var o=this.areas[n];if(o){var r=o.findSingleNode(e,i);if(null!=r)return r}}return null}for(var a=this.nodes.length-1;a>=0;a--){var s=this.nodes[a];if(t.containsPoint(e,i,s.bounds))return s}return null}return null}},{key:"_getArea",value:function(t){return this.areas[t]}},{key:"splitInsert",value:function(e){var i=this.bounds.left,n=this.bounds.right,o=this.bounds.top,r=this.bounds.bottom,a=Math.floor((n+i)/2),s=Math.floor((r+o)/2),c=this.areas[ei];c||(c=new t({left:i,top:o,right:a,bottom:s},this.maxNodes,this.currentDeepth+1,this.maxDeepth),this.areas[ei]=c),c.insert(e);var h=this.areas[ii];h||(h=new t({left:a,top:o,right:n,bottom:s},this.maxNodes,this.currentDeepth+1,this.maxDeepth),this.areas[ii]=h),h.insert(e);var l=this.areas[ni];l||(l=new t({left:i,top:s,right:a,bottom:r},this.maxNodes,this.currentDeepth+1,this.maxDeepth),this.areas[ni]=l),l.insert(e);var u=this.areas[oi];u||(u=new t({left:a,top:s,right:n,bottom:r},this.maxNodes,this.currentDeepth+1,this.maxDeepth),this.areas[oi]=u),u.insert(e)}},{key:"_createRelationShip",value:function(t,e){t.__related_quad||(t.__related_quad=[]),-1==t.__related_quad.indexOf(e)&&t.__related_quad.push(e)}},{key:"_deleteRelationShip",value:function(t,e){if(t.__related_quad){var i=t.__related_quad.indexOf(e);-1!=i&&t.__related_quad.splice(i,1)}}},{key:"insert",value:function(e){var i=this;return!!t.isContacted(e.bounds,this.bounds)&&(this.totalNodesCount>=this.maxNodes?(this.totalNodesCount++,this.currentDeepth==this.maxDeepth?(this.nodes.push(e),this._createRelationShip(e,this),!0):(this.nodes.forEach((function(t){i._deleteRelationShip(t,i),i.splitInsert(t)})),this.splitInsert(e),this._deleteRelationShip(e,this),this.nodes.length=0,!0)):(this.totalNodesCount++,this.nodes.push(e),this._createRelationShip(e,this),!0))}},{key:"merge",value:function(){var t=this;this.areas.forEach((function(e){e&&(e.nodes.forEach((function(e){t.nodes.push(e)})),e.nodes.length=0)}));for(var e=0;e<this.areas.length;e++)this.areas[e]=null}},{key:"decreaseTotalNodes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t[this]||(t[this]=!0,this.totalNodesCount--,this.totalNodesCount<this.maxNodes&&(e[this]=!0),this.parent&&this.parent.decreaseTotalNodes(t,e))}},{key:"remove",value:function(e){if(t.isContacted(e.bounds,this.bounds)){if(0!=this.nodes.length){var i=this.nodes.indexOf(e);return-1!=i&&(this.nodes.splice(i,1),this.totalNodesCount--,!0)}var n=this.areas[0],o=!1;n||(o|=n.remove(e));var r=this.areas[1];r||(o|=r.remove(e));var a=this.areas[2];a||(o|=a.remove(e));var s=this.areas[3];return s||(o|=s.remove(e)),o?(this.totalNodesCount--,this.totalNodesCount<this.maxNodes&&this.merge()):console.warn("这里发生了buuuugggg"),o}return!1}},{key:"dispose",value:function(){this.nodes.length=0,this.nodes=null,this.areas.forEach((function(t){t&&t.dispose()})),this.areas=null}}],[{key:"deleteNodeForce",value:function(t){if(t){var e=t.__related_quad;if(null!=e){var i={},n={};e.forEach((function(e){var o=e.nodes.indexOf(t);-1!=o&&(e.nodes.splice(o,1),e.decreaseTotalNodes(i,n))})),e.length=0}}}},{key:"containsPoint",value:function(t,e,i){return Ge.containsPoint(t,e,i)}},{key:"isContacted",value:function(t,e){return Ge.isContacted(t,e)}}]),t}(),ai=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),n.name=null==t||null==t.name?"Figure":t.name,n.useQuadTree=!1,n.quadtree=new ri({left:0,top:0,right:n.width,bottom:n.height}),n}return Object(Fe["a"])(i,[{key:"width",get:function(){return Object(Te["a"])(Object(Re["a"])(i.prototype),"width",this)},set:function(t){this.width!=t&&(Object(Ae["a"])(Object(Re["a"])(i.prototype),"width",t,this,!0),this._recreateQuadTree())}},{key:"height",get:function(){return Object(Te["a"])(Object(Re["a"])(i.prototype),"height",this)},set:function(t){this.height!=t&&(Object(Ae["a"])(Object(Re["a"])(i.prototype),"height",t,this,!0),this._recreateQuadTree())}},{key:"simpleClone",value:function(){}},{key:"insertChildQuadNode",value:function(t){this.useQuadTree&&(this.quadtree||(this.quadtree=new ri({left:0,top:0,right:this.width,bottom:this.height})),this.quadtree.insert(t.getQuadTreeNode()),console.log("新加入quadnode",this.quadtree,this.quadtree.nodes.length))}},{key:"matrix",get:function(){return this._transformDirty&&this.updateRelatedQuadTree(),Object(Te["a"])(Object(Re["a"])(i.prototype),"matrix",this)}},{key:"updateRelatedQuadTree",value:function(){this._quadTreeNode&&this.parent.useQuadTree&&(console.log("位置改变更新quadnode",this._quadTreeNode),ri.deleteNodeForce(this._quadTreeNode),console.log("强制删除quadnode",this.parent.quadtree),this._quadTreeNode=null,this.parent&&this.parent.insertChildQuadNode(this))}},{key:"_recreateQuadTree",value:function(){var t=this;if(this.useQuadTree){null==this._reQT&&(this._reQT=0),this._reQT++;var e=this._reQT;e==this._reQT&&(this.quadtree&&this.quadtree.dispose(),this.quadtree=new ri({left:0,top:0,right:this.width,bottom:this.height}),this.children.forEach((function(e){var i=e.getQuadTreeNode(t.matrix);i&&t.quadtree.insert(i)})),this._reQT=null)}}},{key:"getQuadTreeNode",value:function(){if(!this._quadTreeNode){var t=this.worldBounds;this._quadTreeNode={bounds:{left:t.left,top:t.top,right:t.right,bottom:t.bottom},value:this}}return this._quadTreeNode}},{key:"insertChild",value:function(t,e){var n=Object(Te["a"])(Object(Re["a"])(i.prototype),"insertChild",this).call(this,t,e);return n?(this.parent?this.parent.recordAdd(t):this.recordAdd(t),this.insertChildQuadNode(t),n):n}},{key:"recordAdd",value:function(t){}},{key:"recordRemove",value:function(t){}},{key:"removeChild",value:function(t){var e=Object(Te["a"])(Object(Re["a"])(i.prototype),"removeChild",this).call(this,t);if(e)return this.parent?this.parent.recordRemove(t):this.recordRemove(t),t&&this.quadtree&&this.useQuadTree&&(ri.deleteNodeForce(t._quadTreeNode),console.log("删除quadnode",t._quadTreeNode)),e}},{key:"findChildren",value:function(t){var e=this.worldMatrix.clone();e.invert();try{var i=Ge.transformToRelatedBounds(t,e);if(this.quadtree&&this.useQuadTree){var n=this.quadtree.findNodes(i);return n}var o=[];return this.children.forEach((function(e){Ge.isContacted(e.worldBounds,t)&&o.push(e)})),o}catch(r){console.error(r)}}},{key:"findFigure",value:function(t,e){if(!this.isVisible)return null;var i=this.worldMatrix.clone(),n=i.invert().multiplyWithVertexDatas(t,e);if(this.containsPoint(n[0],n[1],!1)){if(this.quadtree&&this.useQuadTree){var o=this.quadtree.findSingleNode(n[0],n[1]);if(o){var r=o.value;return r.findFigure(t,e)}return this}for(var a=this.children.length-1;a>=0;a--){var s=this.children[a],c=s.findFigure(t,e);if(c)return c}return this}return null}},{key:"drawSelf",value:function(t){Object(Te["a"])(Object(Re["a"])(i.prototype),"drawSelf",this).call(this,t)}},{key:"dispose",value:function(){this.quadtree&&this.quadtree.dispose(),Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this)}}]),i}(Ke),si=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),n._paint=Ee.newPaint(),n.setAntiAlias(!0),n.r=null==t||null==t.r?255:t.r,n.g=null==t||null==t.g?255:t.g,n.b=null==t||null==t.b?255:t.b,n.a=null==t||null==t.a?1:t.a,n.br=null==t||null==t.br?0:t.br,n.bg=null==t||null==t.bg?0:t.bg,n.bb=null==t||null==t.bb?0:t.bb,n.ba=null==t||null==t.ba?1:t.ba,n.alpha=null==t||null==t.alpha?1:t.alpha,n.fill=null==t||null==t.fill||t.fill,n.showBorder=null==t||null==t.showBorder||t.showBorder,n.borderWidth=null==t||null==t.borderWidth?1:t.borderWidth,n.cap=null==t||null==t.cap?Ee.StrokeCap.Butt:t.cap,n.join=null==t||null==t.join?Ee.StrokeJoin.Bevel:t.join,n.miter=null==t||null==t.miter?2:t.miter,n}return Object(Fe["a"])(i,[{key:"setAntiAlias",value:function(t){this._paint&&this.getTarget()._paint.setAntiAlias(t)}},{key:"cap",get:function(){if(this._paint)return this.getTarget()._paint.getStrokeCap()},set:function(t){this._paint&&this.getTarget()._paint.setStrokeCap(t)}},{key:"join",get:function(){if(this._paint)return this.getTarget()._paint.getStrokeJoin()},set:function(t){this._paint&&this.getTarget()._paint.setStrokeJoin(t)}},{key:"miter",get:function(){if(this._paint)return this.getTarget()._paint.getStrokeMiter()},set:function(t){this._paint&&this.getTarget()._paint.setStrokeMiter(t)}},{key:"borderWidth",get:function(){if(this._paint)return this.getTarget()._paint.getStrokeWidth()},set:function(t){this._paint&&this.getTarget()._paint.setStrokeWidth(t)}},{key:"width",get:function(){return Object(Te["a"])(Object(Re["a"])(i.prototype),"width",this)},set:function(t){t!=this.width&&(Object(Ae["a"])(Object(Re["a"])(i.prototype),"width",t,this,!0),this.fireShapeDirty())}},{key:"height",get:function(){return Object(Te["a"])(Object(Re["a"])(i.prototype),"height",this)},set:function(t){t!=this.height&&(Object(Ae["a"])(Object(Re["a"])(i.prototype),"height",t,this,!0),this.fireShapeDirty())}},{key:"deletePath",value:function(){this._path&&(this.getTarget()._path.delete(),this._path=null)}},{key:"fireShapeDirty",value:function(){this.deletePath(),this.fireBoundsDirty(),this.updateRelatedQuadTree(),this.fireEvent("shapeDirty")}},{key:"getPath",value:function(){return this._path||(this._path=Ee.newPath(),this.drawPath(this._path)),this._path}},{key:"applyClip",value:function(t){var e=this.getPath();e&&t.clipPath(e,Ee.ClipOp.Intersect,!0)}},{key:"drawSelf",value:function(t){if(!(this.alpha<=0)){var e=this.getPath();e&&(this.a>0&&this.fill&&(this._paint.setStyle(Ee.fillStyle),this._paint.setColorComponents(this.r/255,this.g/255,this.b/255,this.a*this.alpha),t.drawPath(e,this._paint)),this.showBorder&&this.borderWidth>0&&this.ba>0&&(this._paint.setStyle(Ee.strokeStyle),this._paint.setColorComponents(this.br/255,this.bg/255,this.bb/255,this.ba*this.alpha),t.drawPath(e,this._paint)))}}},{key:"drawPath",value:function(t){}},{key:"dispose",value:function(){this.isDisposed||(this.deletePath(),this.deletePaint(),Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this))}},{key:"deletePaint",value:function(){this._paint&&(this.getTarget()._paint.delete(),this._paint=null)}},{key:"getSVGExtensionString",value:function(){var t;if(this.fill?(t='fill="'.concat(Ge.transformRGBToHex(this.r,this.g,this.b),'"'),1!=this.a&&(t+=' fill-opacity:"'.concat(this.a,'"'))):t='fill="none"',this.showBorder){t||(t=""),t+=' stroke="'.concat(Ge.transformRGBToHex(this.br,this.bg,this.bb),'"'),t+=' stroke-width="'.concat(this.borderWidth,'"');var e=Ee.getJoinText(this.join);e&&(t+=' stroke-linejoin="'.concat(e,'"')),"miter"==e&&(t+=' stroke-miterlimit="'.concat(this.miter,'"'));var i=Ee.getCapText(this.cap);i&&(t+=' stroke-linecap="'.concat(i,'"')),1!=this.ba&&(t+=' stroke-opacity="'.concat(this.ba,'"'))}else t||(t=""),t+='stroke="none"';return t}}]),i}(ai),ci=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),n.radiusx=null==t||null==t.radiusx?0:t.radiusx,n.radiusy=null==t||null==t.radiusy?0:t.radiusy,null!=t&&null!=t.radius&&(n.radius=t.radius),n}return Object(Fe["a"])(i,[{key:"radius",set:function(t){this.radiusy=t,this.radiusx=t}},{key:"radiusx",get:function(){return this._radiusx},set:function(t){this._radiusx!=t&&(this._radiusx=t,this.fireShapeDirty())}},{key:"radiusy",get:function(){return this._radiusy},set:function(t){this._radiusy!=t&&(this._radiusy=t,this.fireShapeDirty())}},{key:"drawPath",value:function(t){var e=Ee.newXYWHRect(0,0,this.width,this.height);null==this.radiusx||null==this.radiusy||0==this.radiusx&&0==this.radiusy?t.addRect(e):(e=Ee.newRRectXY(e,this.radiusx,this.radiusy),t.addRRect(e))}}]),i}(si),hi=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),Object(Ve["a"])(Object(Ie["a"])(n),"_childDirty",(function(){n.deletePath()})),n}return Object(Fe["a"])(i,[{key:"showBorder",get:function(){return this._getAnyPropertyValue("showBorder",!0)},set:function(t){this._setAllChildren("showBorder",t)}},{key:"borderWidth",get:function(){return this._getAnyPropertyValue("borderWidth",0)},set:function(t){this._setAllChildren("borderWidth",t)}},{key:"miter",get:function(){return this._getAnyPropertyValue("miter",0)},set:function(t){this._setAllChildren("miter",t)}},{key:"join",get:function(){return this._getAnyPropertyValue("join",Ee.StrokeJoin.Bevel)},set:function(t){this._setAllChildren("join",t)}},{key:"cap",get:function(){return this._getAnyPropertyValue("cap",Ee.StrokeCap.Butt)},set:function(t){this._setAllChildren("cap",t)}},{key:"br",get:function(){return this._getAnyPropertyValue("br",0)},set:function(t){this._setAllChildren("br",t)}},{key:"bb",get:function(){return this._getAnyPropertyValue("bb",0)},set:function(t){this._setAllChildren("bb",t)}},{key:"bg",get:function(){return this._getAnyPropertyValue("bg",0)},set:function(t){this._setAllChildren("bg",t)}},{key:"ba",get:function(){return this._getAnyPropertyValue("ba",1)},set:function(t){this._setAllChildren("ba",t)}},{key:"fill",get:function(){return this._getAnyPropertyValue("fill",!0)},set:function(t){this._setAllChildren("fill",t)}},{key:"r",get:function(){return this._getAnyPropertyValue("r",0)},set:function(t){this._setAllChildren("r",t)}},{key:"b",get:function(){return this._getAnyPropertyValue("b",0)},set:function(t){this._setAllChildren("b",t)}},{key:"g",get:function(){return this._getAnyPropertyValue("g",0)},set:function(t){this._setAllChildren("g",t)}},{key:"a",get:function(){return this._getAnyPropertyValue("a",1)},set:function(t){this._setAllChildren("a",t)}},{key:"_getAnyPropertyValue",value:function(t,e){if(0==this.children.length)return e;for(var i=this.children[0][t],n=1;n<this.children.length;n++){var o=this.children[n];if(o[t]!=i)return e}return i}},{key:"_setAllChildren",value:function(t,e){for(var i=0;i<this.children.length;i++){var n=this.children[i];n[t]=e}}},{key:"getPath",value:function(){var t=this;return this._path||(this.getTarget()._path=Ee.newPath(),this.children.forEach((function(e){if(e.getPath){var i=e.getTarget().getPath().copy();i.transform(e.matrix.data),t.getTarget()._path.addPath(i)}}))),this._path}},{key:"insertChild",value:function(t,e){var n=Object(Te["a"])(Object(Re["a"])(i.prototype),"insertChild",this).call(this,t,e);return n&&(this.deletePath(),t.on("transformDirty",this._childDirty),t.on("boundsDirty",this._childDirty)),n}},{key:"removeAt",value:function(t){var e=Object(Te["a"])(Object(Re["a"])(i.prototype),"removeAt",this).call(this,t);return e&&(this.deletePath(),e.off("transformDirty",this._childDirty),e.off("boundsDirty",this._childDirty)),e}},{key:"deletePath",value:function(){this._path&&(this.getTarget()._path.delete(),this._path=null)}},{key:"dispose",value:function(){var t=this;this.isDisposed||(this.deletePath(),this.children.forEach((function(e){e.off("transformDirty",t._childDirty),e.off("boundsDirty",t._childDirty)})),Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this))}}]),i}(ai),li=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(Pe["a"])(this,i),t=e.call(this),t.x=null==n?0:n,t.y=null==o?0:o,t._type=null==r?0:r,t.parent,t}return Object(Fe["a"])(i,[{key:"type",get:function(){return this._type},set:function(t){this._type!=t&&(this._type=t)}},{key:"fireDirty",value:function(){this.fireEvent("dirty",!0)}},{key:"x",get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.fireDirty())}},{key:"y",get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.fireDirty())}},{key:"in",get:function(){return this._in},set:function(t){t!=this._in&&(this._in=t,this.fireDirty())}},{key:"out",get:function(){return this._out},set:function(t){t!=this._out&&(this._out=t,this.fireDirty())}},{key:"inX",get:function(){if(this.in)return this.in[0]},set:function(t){null==this._in&&(this._in=[this.x,this.y]),t!=this._in[0]&&(this._in[0]=t,this.fireDirty())}},{key:"inY",get:function(){if(this.in)return this.in[1]},set:function(t){null==this._in&&(this._in=[this.x,this.y]),t!=this._in[1]&&(this._in[1]=t,this.fireDirty())}},{key:"outX",get:function(){if(this.out)return this.out[0]},set:function(t){null==this._out&&(this._out=[this.x,this.y]),t!=this._out[0]&&(this._out[0]=t,this.fireDirty())}},{key:"outY",get:function(){if(this.out)return this.out[1]},set:function(t){null==this._out&&(this._out=[this.x,this.y]),t!=this._out[1]&&(this._out[1]=t,this.fireDirty())}},{key:"copyFrom",value:function(t){this.equals(t)||(this.type=t.type,this.x=t.x,this.y=t.y,t.in?(this.inX=t.inX,this.inY=t.inY):this._in=null,t.out?(this.outX=t.outX,this.outY=t.outY):this._out=null)}},{key:"clone",value:function(){var t=new i;return t.copyFrom(this),t}},{key:"equals",value:function(t){if(!t)return!1;if(t==this)return!0;if(t.x!=this.x||t.y!=this.y)return!1;if(!(t.in&&this.in||!t.in&&!this.in)||!(t.out&&this.out||!t.out&&!this.out))return!1;if(t.in&&this.in){if(t.inX!=this.inX)return!1;if(t.inY!=this.inY)return!1}if(t.out&&this.out){if(t.outX!=this.outX)return!1;if(t.outY!=this.outY)return!1}return!0}}]),i}(ze),ui={emits:["property:change"],methods:{firePropertyChangeEvents:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.$emit("property:change",t)},canChangeProperty:function(t){return!0},changeProperty:function(t,e){var i=this;if(this.hasSelection){var n=[];this.selections.forEach((function(o){i.canChangeProperty(o)&&n.push({model:o,property:t,value:e})})),this.firePropertyChangeEvents(n)}},changeMultipleProperties:function(t){var e=this;if(this.hasSelection){var i=[];this.selections.forEach((function(n){if(e.canChangeProperty(n))for(var o in t){var r=t[o];i.push({model:n,property:o,value:r})}})),this.firePropertyChangeEvents(i)}},getAnyPropertyValue:function(t,e){if(!this.selections||0==this.selections.length)return e;for(var i=this.selections[0][t],n=1;n<this.selections.length;n++){var o=this.selections[n];if(o[t]!=i)return e}return null==i?e:i}},computed:{currentSelection:function(){if(this.selections)return this.selections[0]},hasSelection:function(){return!(!this.selections||0==this.selections.length)},hasBorderOrFillProperty:function(){if(this.hasSelection){for(var t=0;t<this.selections.length;t++){var e=this.selections[t];if(e instanceof li)return!1}return!0}return!1},isShape:function(){if(null==this.selections||1!=this.selections.length)return!1;var t=this.currentSelection;return t instanceof si},isGroup:function(){if(null==this.selections||1!=this.selections.length)return!1;var t=this.currentSelection;return t instanceof hi}},props:{selections:{type:Array}}},di={class:"property-item"},fi={key:0,class:"form-control form-control-sm property-input",disabled:""};function pi(t,e,i,o,r,a){return Object(n["q"])(),Object(n["d"])("div",di,[Object(n["h"])("div",{class:["property-lable",a.disabled?"disabled-label":""]},Object(n["x"])(i.name),3),a.disabled?(Object(n["q"])(),Object(n["d"])("input",fi)):Object(n["E"])((Object(n["q"])(),Object(n["d"])("input",{key:1,class:"form-control form-control-sm property-input","onUpdate:modelValue":e[1]||(e[1]=function(t){return a.pvalue=t}),type:i.type,step:i.step,max:i.max,min:i.min,onClick:e[2]||(e[2]=function(){return a.selectText&&a.selectText.apply(a,arguments)}),onKeypress:e[3]||(e[3]=Object(n["F"])((function(){return a.confirm&&a.confirm.apply(a,arguments)}),["enter"]))},null,40,["type","step","max","min"])),[[n["z"],a.pvalue,void 0,{lazy:!0}]])])}i("b680"),i("c7cd");var vi={name:"Property",emits:["property:change"],computed:{pvalue:{get:function(){if(!this.disabled){var t=this.selections[0],e=t[this.pk];if(null!=e){if(this.transformToAngel){var i=180*e/Math.PI;return i.toFixed(this.fixed)}return e.toFixed(this.fixed)}}},set:function(t){var e=t;"number"==this.type&&(e=Number.parseFloat(t)),this.transformToAngel&&(e=t*Math.PI/180),this.$emit("property:change",[{model:this.selections[0],property:this.pk,value:e}])}},disabled:function(){if(!this.selections||1!=this.selections.length)return!0;var t=this.selections[0];if(null==t)return!0;var e=!this.pk in t;return e}},methods:{confirm:function(t){t.target.select()},selectText:function(t){t.target.select()}},props:{name:"",fixed:{type:Number,default:2},transformToAngel:{type:Boolean,default:!1},pk:{type:String},selections:{type:Array},step:{type:Number,default:1},max:{type:Number},min:{type:Number},type:{type:String,default:"number"}}};vi.render=pi;var bi=vi,yi={class:"color-container"},gi={class:"color-input-container"},mi={key:0},ki={class:"color-rgb-container"},Oi={class:"color-value-container"},ji=Object(n["h"])("small",null,"R",-1),wi={class:"color-value-container"},xi=Object(n["h"])("small",null,"G",-1),Ci={class:"color-value-container"},_i=Object(n["h"])("small",null,"B",-1),Si={class:"color-a-container"},Pi=Object(n["h"])("small",{style:{"margin-right":"5px"}},"Opacity",-1);function Fi(t,e,i,o,r,a){return Object(n["q"])(),Object(n["d"])("div",yi,[Object(n["h"])("div",gi,[null!=i.title?(Object(n["q"])(),Object(n["d"])("small",mi,Object(n["x"])(i.title),1)):Object(n["e"])("",!0),Object(n["h"])("input",{type:"color",class:"form-control form-control-sm form-control-color my-color-input",onChange:e[1]||(e[1]=function(){return a.colorChanged&&a.colorChanged.apply(a,arguments)}),value:a.currentColorString},null,40,["value"])]),Object(n["h"])("div",ki,[Object(n["h"])("div",Oi,[ji,Object(n["E"])(Object(n["h"])("input",{class:"form-control form-control-sm property-input",type:"number",max:"255",min:"0",placeholder:"R","onUpdate:modelValue":e[2]||(e[2]=function(t){return a.r=t}),onClick:e[3]||(e[3]=function(){return t.selectText&&t.selectText.apply(t,arguments)}),onKeypress:e[4]||(e[4]=Object(n["F"])((function(){return t.confirm&&t.confirm.apply(t,arguments)}),["enter"]))},null,544),[[n["B"],a.r,void 0,{lazy:!0}]])]),Object(n["h"])("div",wi,[xi,Object(n["E"])(Object(n["h"])("input",{class:"form-control form-control-sm property-input",placeholder:"G",type:"number",max:"255",min:"0","onUpdate:modelValue":e[5]||(e[5]=function(t){return a.g=t}),onClick:e[6]||(e[6]=function(){return t.selectText&&t.selectText.apply(t,arguments)}),onKeypress:e[7]||(e[7]=Object(n["F"])((function(){return t.confirm&&t.confirm.apply(t,arguments)}),["enter"]))},null,544),[[n["B"],a.g,void 0,{lazy:!0}]])]),Object(n["h"])("div",Ci,[_i,Object(n["E"])(Object(n["h"])("input",{class:"form-control form-control-sm property-input",placeholder:"B",type:"number",max:"255",min:"0","onUpdate:modelValue":e[8]||(e[8]=function(t){return a.b=t}),onClick:e[9]||(e[9]=function(){return t.selectText&&t.selectText.apply(t,arguments)}),onKeypress:e[10]||(e[10]=Object(n["F"])((function(){return t.confirm&&t.confirm.apply(t,arguments)}),["enter"]))},null,544),[[n["B"],a.b,void 0,{lazy:!0}]])])]),Object(n["h"])("div",Si,[Pi,Object(n["E"])(Object(n["h"])("input",{class:"form-control form-control-sm property-input",type:"number",max:"1",min:"0",step:"0.1","onUpdate:modelValue":e[11]||(e[11]=function(t){return a.a=t}),onClick:e[12]||(e[12]=function(){return t.selectText&&t.selectText.apply(t,arguments)}),onKeypress:e[13]||(e[13]=Object(n["F"])((function(){return t.confirm&&t.confirm.apply(t,arguments)}),["enter"]))},null,544),[[n["B"],a.a,void 0,{lazy:!0}]])])])}var Ai={name:"ColorProperty",mixins:[Se,ui],methods:{canChangeProperty:function(t){return!(t instanceof li)},colorChanged:function(t){var e=this.currentSelection;if(e){var i=t.target.value;if(i&&7==i.length){var n=i.substring(1,3);n=Number.parseInt(n,16);var o=i.substring(3,5);o=Number.parseInt(o,16);var r=i.substring(5,7);r=Number.parseInt(r,16);var a={};a[this.rk]=n,a[this.gk]=o,a[this.bk]=r,this.changeMultipleProperties(a)}}}},computed:{currentColorString:function(){return Ge.transformRGBToHex(this.r,this.g,this.b)},r:{get:function(){return this.getAnyPropertyValue(this.rk,0)},set:function(t){t=Number.parseInt(t),this.changeProperty(this.rk,t)}},g:{get:function(){return this.getAnyPropertyValue(this.gk,0)},set:function(t){t=Number.parseInt(t),this.changeProperty(this.gk,t)}},b:{get:function(){return this.getAnyPropertyValue(this.bk,0)},set:function(t){t=Number.parseInt(t),this.changeProperty(this.bk,t)}},a:{get:function(){return this.getAnyPropertyValue(this.ak,0)},set:function(t){this.currentSelection;this.changeProperty(this.ak,t)}}},props:{title:{type:String},rk:{type:String,default:"r"},gk:{type:String,default:"g"},bk:{type:String,default:"b"},ak:{type:String,default:"a"}}};i("20df");Ai.render=Fi;var Ti=Ai,Ri={name:"BorderProperty",mixins:[Se,ui],components:{Property:bi,ColorProperty:Ti},emits:["property:change"],computed:{width:{get:function(){return this.getAnyPropertyValue("borderWidth",0)},set:function(t){var e=Number.parseInt(t);this.changeProperty("borderWidth",e)}},miter:{get:function(){return this.getAnyPropertyValue("miter",0)},set:function(t){var e=Number.parseInt(t);this.changeProperty("miter",e)}},join:{get:function(){return this.getAnyPropertyValue("join",Ee.StrokeCap.Bevel)}},cap:{get:function(){return this.getAnyPropertyValue("cap",Ee.StrokeCap.Butt)}},showBorder:function(){return this.getAnyPropertyValue("showBorder",!1)}},methods:{canChangeProperty:function(t){return!(t instanceof li)},colorChanged:function(t){this.firePropertyChangeEvents(t)},changeCapType:function(t){var e,i=t.currentTarget.id;i&&("Butt"==i&&(e=Ee.StrokeCap.Butt),"Square"==i&&(e=Ee.StrokeCap.Square),"Round"==i&&(e=Ee.StrokeCap.Round),e&&e!=this.cap&&this.changeProperty("cap",e))},changeJoinType:function(t){var e,i=t.currentTarget.id;i&&("Bevel"==i&&(e=Ee.StrokeJoin.Bevel),"Miter"==i&&(e=Ee.StrokeJoin.Miter),"Round"==i&&(e=Ee.StrokeJoin.Round),e&&e!=this.join&&this.changeProperty("join",e))},showBorderChange:function(t){var e=t.target.checked;e!=this.showBorder&&this.changeProperty("showBorder",e)}},props:{selections:{type:Array}}};Ri.render=_e;var Mi=Ri,Di=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(Pe["a"])(this,i),t=e.call(this),t._points=[],t._closed=n,t.parent,t}return Object(Fe["a"])(i,[{key:"isClosed",get:function(){return this._closed}},{key:"pointsCount",get:function(){return this._points.length}},{key:"points",get:function(){return this._points}},{key:"close",value:function(){this._closed=!0}},{key:"open",value:function(){this._closed=!1}},{key:"draw",value:function(t){if(t&&!(this._points.length<=1)){var e,i=this._points[0],n=i;if(null!=i){t.moveTo(i.x,i.y);for(var o=1;o<this._points.length;o++)e=this._points[o],this._lineToNext(n,e,t),n=e;this.isClosed&&(e=i,this._lineToNext(n,e,t))}}}},{key:"_lineToNext",value:function(t,e,i){var n=t.out,o=e.in;if(0!=t.type||0!=e.type)if(null==n&&null==o)i.lineTo(e.x,e.y);else{var r=n,a=o;if(null==r||null==a){var s=r;s=s||a,i.quadTo(s[0],s[1],e.x,e.y)}else i.cubicTo(r[0],r[1],a[0],a[1],e.x,e.y)}else i.lineTo(e.x,e.y)}},{key:"dispose",value:function(){this._points&&(this._points.forEach((function(t){t.dispose(),t.parent=null})),this._points.length=0),this._points=null,Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this)}},{key:"getPoint",value:function(t){return this.points[t]}},{key:"deleteAt",value:function(t){if(-1!=t){var e=this._points.splice(t,1);if(e&&e[0]){var i=e[0];return i.dispose(),i.parent=null,this.fireEvent("dirty"),i}}}},{key:"deletePoint",value:function(t){var e=this.getPointIndex(t);return this.deleteAt(e)}},{key:"getPointIndex",value:function(t){if(!t)return-1;for(var e=0;e<this._points.length;e++){var i=this._points[e];if(i.equals(t))return e}return-1}},{key:"addPoint",value:function(t){this.insertPoint(t,this._points.length)}},{key:"insertPoint",value:function(t,e){var i=this;if(-1==e||!t)return!1;if(e>=this._points.length)return this._points.push(t),t.parent=this,t.on("dirty",(function(){i.fireEvent("dirty")})),this.fireEvent("dirty"),!0;this._points.push(t),t.on("dirty",(function(){i.fireEvent("dirty")}));for(var n=this._points.length-1;n>e;n--){var o=this._points[n];this._points[n]=this._points[n-1],this._points[n-1]=o}return this.fireEvent("dirty"),!0}}]),i}(ze),Vi=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),Object(Ve["a"])(Object(Ie["a"])(n),"_pathModelChanged",(function(){n.fireShapeDirty()})),n.boundsRect=new Float32Array(4),n}return Object(Fe["a"])(i,[{key:"pointsCount",get:function(){return this.getPathModel().points.length}},{key:"deletePathModel",value:function(){this._pathModel&&(this._pathModel.dispose(),this._pathModel.parent=null,this._pathModel=null)}},{key:"insertPoint",value:function(t,e){return this.getPathModel().insertPoint(t,e)}},{key:"deleteAt",value:function(t){return this.getPathModel().deleteAt(t)}},{key:"addPoint",value:function(t){var e=this.getPathModel();return e.addPoint(t)}},{key:"deletePoint",value:function(t){var e=this.getPathModel();return e.deletePoint(t)}},{key:"drawPath",value:function(t){var e=this.getPathModel();e.draw(t)}},{key:"_configPathPoints",value:function(t){}},{key:"_createPathModel",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=new Di(t);return this._configPathPoints(e),e}},{key:"getPathModel",value:function(){return null==this._pathModel&&(this._pathModel=this._createPathModel(),this._pathModel.parent=this,this._pathModel.on("dirty",this._pathModelChanged)),this._pathModel}},{key:"dispose",value:function(){this.isDisposed||(this.deletePathModel(),Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this))}},{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:left,top:top,right:right,bottom:bottom};this.getTarget().getPath().getBounds(this.boundsRect);var e=this.boundsRect;return t.left=e[0],t.top=e[1],t.right=e[2],t.bottom=e[3],t}},{key:"containsPoint",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._containsPoint=void 0;var n=t,o=e;if(i){var r=this.worldMatrix.clone(),a=r.invert().multiplyWithVertexDatas(n,o);n=a[0],o=a[1]}return this.getTarget().getPath().contains(n,o)}},{key:"getSVGLabelName",value:function(){return"path"}},{key:"getSVGDimensionString",value:function(){}},{key:"getSVGExtensionString",value:function(){var t=Object(Te["a"])(Object(Re["a"])(i.prototype),"getSVGExtensionString",this).call(this),e=this.getTarget().getPath();return e&&(t||(t=""),t+=' d="'.concat(e.toSVGString(),'"')),t}}]),i}(si),Bi=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),n.close=null!=t&&null!=t.close&&t.close,n}return Object(Fe["a"])(i,[{key:"_createPathModel",value:function(){return Object(Te["a"])(Object(Re["a"])(i.prototype),"_createPathModel",this).call(this,this.close)}},{key:"width",get:function(){return this._width},set:function(t){}},{key:"height",get:function(){return this._height},set:function(t){}},{key:"isVisible",get:function(){return this.visible&&0!=this.scalex&&0!=this.scaley}},{key:"close",get:function(){return this._close},set:function(t){this._close!=t&&(this._close=t,this._close?this.getPathModel().close():this.getPathModel().open(),this.fireShapeDirty())}}]),i}(Vi),Ei=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),n.sides=null==t||null==t.sides?5:t.sides,n}return Object(Fe["a"])(i,[{key:"_configPathPoints",value:function(t){for(var e=this.width/2,i=this.height/2,n=-Math.PI/2,o=2*Math.PI/this.sides,r=this.width/2,a=this.height/2,s=0;s<this.sides;s++){var c=Math.cos(n)*e+r,h=Math.sin(n)*i+a;t.addPoint(new li(c,h)),n+=o}}},{key:"fireShapeDirty",value:function(){this._pathModel&&(this._pathModel.dispose(),this._pathModel=null),Object(Te["a"])(Object(Re["a"])(i.prototype),"fireShapeDirty",this).call(this)}},{key:"sides",get:function(){return this._sides},set:function(t){this._sides!=t&&(this._sides=t,this.fireShapeDirty())}}]),i}(Vi),qi=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),n.radius=null==t||null==t.radius?.5:t.radius,n.corners=null==t||null==t.corners?5:Math.floor(t.corners),n}return Object(Fe["a"])(i,[{key:"fireShapeDirty",value:function(){this._pathModel&&(this._pathModel.dispose(),this._pathModel=null),Object(Te["a"])(Object(Re["a"])(i.prototype),"fireShapeDirty",this).call(this)}},{key:"_configPathPoints",value:function(t){for(var e=2*this.corners,i=0;i<e;i++)t.addPoint(new li);for(var n=this.corners,o=Ye.PI2/n,r=-Ye.HALF_PI,a=0,s=r+o/2,c=1,h=this.width/2,l=h*this.radius,u=this.height/2,d=u*this.radius,f=this.width/2,p=this.height/2,v=0,b=0,y=0;v<n;v++){var g=b+r,m=Math.cos(g)*h,k=Math.sin(g)*u,O=t.points[y+a];O.x=m+f,O.y=k+p,g=b+s,m=Math.cos(g)*l,k=Math.sin(g)*d;var j=t.points[y+c];j.x=m+f,j.y=k+p,b+=o,y+=2}}},{key:"radius",get:function(){return this._radius},set:function(t){this._radius!=t&&(this._radius=t,this.fireShapeDirty())}},{key:"corners",get:function(){return this._corners},set:function(t){var e=Math.floor(t);this._corners!=e&&(this._corners=e,this.fireShapeDirty())}}]),i}(Vi),Ii={key:0,style:{"text-algin":"left",color:"grey"}},zi=Object(n["h"])("small",null,"Nothing",-1),Hi={key:1},Ni={class:"sub-property-row"},Li={class:"single-row"},Gi={class:"form-check form-switch"},Ui=Object(n["h"])("label",{for:"showBorder"},"Fill",-1),Wi=Object(n["h"])("div",{class:"gray-splitter"},null,-1),Yi={key:0},Ki=Object(n["h"])("div",{style:{"margin-top":"10px","text-align":"left"}},[Object(n["h"])("small",null,"Color")],-1);function Xi(t,e,i,o,r,a){var s=Object(n["v"])("color-property");return Object(n["q"])(),Object(n["d"])("div",null,[t.hasBorderOrFillProperty?(Object(n["q"])(),Object(n["d"])("div",Hi,[Object(n["h"])("div",Ni,[Object(n["h"])("div",Li,[Object(n["h"])("div",Gi,[Ui,Object(n["h"])("input",{onChange:e[1]||(e[1]=function(){return a.fillChange&&a.fillChange.apply(a,arguments)}),checked:a.canFill,class:"form-check-input",type:"checkbox",id:"showBorder"},null,40,["checked"])])]),Wi,a.canFill?(Object(n["q"])(),Object(n["d"])("div",Yi,[Ki,Object(n["h"])(s,{"onProperty:change":t.firePropertyChangeEvents,selections:t.selections,ak:"a",rk:"r",bk:"b",gk:"g"},null,8,["onProperty:change","selections"])])):Object(n["e"])("",!0)])])):(Object(n["q"])(),Object(n["d"])("div",Ii,[zi]))])}var $i={name:"FillProperty",mixins:[Se,ui],components:{ColorProperty:Ti},methods:{fillChange:function(t){var e=t.target.checked;this.canFill!=e&&this.changeProperty("fill",e)}},computed:{canFill:function(){return this.getAnyPropertyValue("fill",!1)}}};$i.render=Xi;var Qi=$i,Ji=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){return Object(Pe["a"])(this,i),e.call(this,t)}return Object(Fe["a"])(i,[{key:"radiusx",get:function(){return this.width/2},set:function(t){this.width=2*t}},{key:"radiusy",get:function(){return this.height/2},set:function(t){this.height=2*t}},{key:"drawPath",value:function(t){var e=Ee.newXYWHRect(0,0,this.width,this.height);t.addOval(e)}}]),i}(si),Zi={default:"default",select:"default",move:"move",add:"crosshair","e-resize":"e-resize","s-resize":"s-resize","w-resize":"w-resize","n-resize":"n-resize","se-resize":"se-resize","ne-resize":"ne-resize","sw-resize":"sw-resize","nw-resize":"nw-resize",rotate:"url(/assets/images/cursor-rotate.png), auto",pen:"url(/assets/images/add-vertex.png), auto",deleteVertex:"url(/assets/images/add-vertex.png), auto","vertex-select":"url()","move-root":"grab"},tn=function(){function t(){Object(Pe["a"])(this,t)}return Object(Fe["a"])(t,null,[{key:"calculateFiguresBounds",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t||0==t.length)return{left:0,top:0,right:0,bottom:0};var i={left:1/0,top:1/0,right:-1/0,bottom:-1/0};return t.forEach((function(t){if(e){var n=t.worldBounds;i.left=Math.min(n.left,i.left),i.right=Math.max(n.right,i.right),i.top=Math.min(n.top,i.top),i.bottom=Math.max(n.bottom,i.bottom)}else i.left=Math.min(t.x,i.left),i.right=Math.max(t.x+t.width,i.right),i.top=Math.min(t.y,i.top),i.bottom=Math.max(t.y+t.height,i.bottom)})),i}},{key:"objectIcon",value:function(t){if(t){if(t instanceof ci)return"icon-square";if(t instanceof Ji)return"icon-circle";if(t instanceof qi)return"icon-star";if(t instanceof Ei)return"icon-polygon";if(t instanceof Bi)return"icon-circle";if(t instanceof hi)return"icon-group"}}}]),t}();Object(Ve["a"])(tn,"CURSOR",Zi);var en=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),n.endX=null==t||null==t.endX?n.x:t.endX,n.endY=null==t||null==t.endY?n.y:t.endY,n}return Object(Fe["a"])(i,[{key:"isVisible",value:function(){return this.visible&&this.endX-this.x!=this.x&&this.endY-this.y!=this.y}},{key:"showBorder",get:function(){return!0},set:function(t){}},{key:"fill",get:function(){return!1},set:function(t){}},{key:"width",get:function(){},set:function(t){}},{key:"height",get:function(){},set:function(t){}},{key:"endX",get:function(){return this._endX},set:function(t){t!=this._endX&&(this._endX=t,this.fireShapeDirty())}},{key:"endY",get:function(){return this._endY},set:function(t){t!=this._endY&&(this._endY=t,this.fireShapeDirty())}},{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,top:0,right:0,bottom:0};t.left=Math.min(this.x,this.endX)-this.x,t.right=Math.max(this.x,this.endX)-this.x,t.top=Math.min(this.y,this.endY)-this.y,t.bottom=Math.max(this.y,this.endY)-this.y;var e=Math.abs(t.bottom-t.top),i=Math.abs(t.right-t.left);if(e<5){var n=5-e;t.left-=n/2,t.right+=n/2}if(i<5){var o=5-i;t.top-=o/2,t.bottom+=o/2}return t}},{key:"drawPath",value:function(t){t.moveTo(0,0),t.lineTo(this.endX-this.x,this.endY-this.y)}},{key:"getSVGLabelName",value:function(){return"path"}},{key:"getSVGDimensionString",value:function(){}},{key:"getSVGExtensionString",value:function(){var t=Object(Te["a"])(Object(Re["a"])(i.prototype),"getSVGExtensionString",this).call(this),e=this.getTarget().getPath();return e&&(t||(t=""),t+=' d="'.concat(e.toSVGString(),'"')),t}}]),i}(si),nn={name:"PropertyBar",emits:["property:change"],computed:{title:function(){if(!this.currentSelections||0==this.currentSelections.length)return"No Selections";if(this.currentSelections){if(this.currentSelections.length>1)return"Multiple Selections";var t=this.currentSelections[0];return t.name?t.name:t instanceof li?"Vertex":"Unknown"}},titleIcon:function(){if(this.currentSelections&&0!=this.currentSelections.length){if(this.currentSelections){if(this.currentSelections.length>1)return"icon-shapes";var t=this.currentSelections[0];return tn.objectIcon(t)}}else;},canShow:function(){return this.currentSelections&&1==this.currentSelections.length},isVertex:function(){return!!this.canShow&&this.currentSelections[0]instanceof li},isRect:function(){if(this.canShow){var t=this.currentSelections[0];return t instanceof ci}return!1},isStar:function(){if(this.canShow){var t=this.currentSelections[0];return t instanceof qi}return!1},isPolygon:function(){if(this.canShow){var t=this.currentSelections[0];return t instanceof Ei}return!1},isPath:function(){if(this.canShow){var t=this.currentSelections[0];if(t instanceof Bi)return!this.isStar&&!this.isPolygon}return!1},isLine:function(){if(this.canShow){var t=this.currentSelections[0];if(t instanceof en)return!0}return!1},showDimension:function(){return!!this.canShow&&!(this.isVertex||this.isPath||this.isLine)},showScale:function(){return!!this.canShow&&!this.isVertex},showSkew:function(){return!!this.canShow&&!this.isVertex},showRotation:function(){return!!this.canShow&&!this.isVertex},showIn:function(){return this.isVertex},hasInController:function(){return!!this.isVertex&&null!=this.currentSelections[0].in},hasOutController:function(){return!!this.isVertex&&null!=this.currentSelections[0].out},pathClosed:function(){return!!this.isPath&&this.currentSelections[0].close},vertexType:function(){if(this.isVertex)return this.currentSelections[0].type}},methods:{propertyChange:function(t){this.$emit("property:change",t)},changeVertexType:function(t){var e=t.currentTarget.id;if(e){var i=e.indexOf("vertexType");if(-1!=i)e.substring(i+10)}},controllerChange:function(t){var e="in";"outController"==t.target.id&&(e="out");var i=this.currentSelections[0],n=t.target.checked,o=null;n&&(o=[i.x,i.y]);var r={model:i,property:e,value:o};this.propertyChange([r])},pathCloseChange:function(t){var e=t.target.checked;this.propertyChange([{model:this.currentSelections[0],property:"close",value:e}])}},components:{Property:bi,BorderProperty:Mi,FillProperty:Qi},props:{currentSelections:{type:Array,default:null}}};i("c5a6");nn.render=Ut;var on=nn,rn={id:"tools-container"},an={id:"canvas-space"},sn={id:"canvas-toolbar"},cn=Object(n["h"])("canvas",{id:"front-canvas",class:"painter-canvas",style:{"z-index":"2"}},null,-1),hn=Object(n["h"])("canvas",{id:"main-canvas",class:"painter-canvas",style:{"z-index":"1"}},null,-1),ln=Object(n["h"])("canvas",{id:"backend-canvas",class:"painter-canvas",style:{"z-index":"0"}},null,-1);function un(t,e,i,o,r,a){var s=Object(n["v"])("tools-bar"),c=Object(n["v"])("action-bar");return Object(n["q"])(),Object(n["d"])("div",{id:"work-space",class:a.canvasBGColor},[Object(n["h"])("div",rn,[Object(n["h"])(s,{"onTool:update":a.toolUpdate,currentTool:r.currentTool,disabled:null==this.mainRoot},null,8,["onTool:update","currentTool","disabled"])]),Object(n["h"])("div",an,[Object(n["h"])("div",sn,[Object(n["h"])(c,{ref:"actionBar",selections:r.currentSelections,actionStack:r.actionStack,rootFigure:r.mainRoot,"onCanvas:group":t.groupFigures,"onCanvas:ungroup":t.unGroupFigures,"onCanvas:clip":t.clipFigures,"onCanvas:unclip":t.unClipFigures},null,8,["selections","actionStack","rootFigure","onCanvas:group","onCanvas:ungroup","onCanvas:clip","onCanvas:unclip"])]),Object(n["h"])("div",{id:"canvas-container",style:"cursor:"+r.cursor,onMousedown:e[1]||(e[1]=function(){return a.mousedown&&a.mousedown.apply(a,arguments)}),onMouseleave:e[2]||(e[2]=function(){return a.mouseleave&&a.mouseleave.apply(a,arguments)}),onMousemove:e[3]||(e[3]=function(){return a.mousemove&&a.mousemove.apply(a,arguments)}),onMouseup:e[4]||(e[4]=function(){return a.mouseup&&a.mouseup.apply(a,arguments)}),onMouseover:e[5]||(e[5]=function(){return a.mouseover&&a.mouseover.apply(a,arguments)}),onMouseout:e[6]||(e[6]=function(){return a.mouseout&&a.mouseout.apply(a,arguments)}),onMousewheel:e[7]||(e[7]=function(){return a.mousewheel&&a.mousewheel.apply(a,arguments)})},[cn,hn,ln],36)])],2)}var dn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n){var o;return Object(Pe["a"])(this,i),o=e.call(this,n),o.surface=t,o._rAFid,o._figureMap=new Map,o}return Object(Fe["a"])(i,[{key:"isVisible",value:function(){return!0}},{key:"recordAdd",value:function(t){t&&this._figureMap&&this._figureMap.set(t.id,t)}},{key:"recordRemove",value:function(t){t&&this._figureMap&&this._figureMap.delete(t.id)}},{key:"getFigureById",value:function(t){if(t&&this._figureMap)return this._figureMap.get(t)}},{key:"clear",value:function(){this.surface&&(this._rAFid&&this.getTarget().surface.cancelAnimationFrame(this._rAFid),this._rAFid=this.getTarget().surface.requestAnimationFrame((function(t){t.clear(Ee.TRANSPARENT)})))}},{key:"refresh",value:function(t){var e=this;this.surface&&(this._rAFid&&this.getTarget().surface.cancelAnimationFrame(this._rAFid),this._rAFid=this.getTarget().surface.requestAnimationFrame((function(i){t&&t(),i.clear(Ee.TRANSPARENT),e.getTarget().draw(i)})))}},{key:"dispose",value:function(){this.isDisposed||(this.surface=null,this._rAFid&&cancelAnimationFrame(this._rAFid),this._rAFid=null,this._figureMap.clear(),Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this))}},{key:"getSVGPositionString",value:function(){}},{key:"getSVGTransformString",value:function(){}},{key:"getSVGLabelName",value:function(){return"svg"}},{key:"getSVGExtensionString",value:function(){return'viewbox="0 0 '.concat(this.width," ").concat(this.height,'" ').concat(fn,' style="background-color:gray"')}}]),i}(ai),fn='xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"',pn=(i("18a5"),function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){return Object(Pe["a"])(this,i),e.call(this,t)}return Object(Fe["a"])(i,[{key:"drawPath",value:function(t){var e=Ee.newXYWHRect(-this.width/2,-this.height/2,this.width,this.height);null==this.radiusx||null==this.radiusy||0==this.radiusx&&0==this.radiusy?t.addRect(e):(e=Ee.newRRectXY(e,this.radiusx,this.radiusy),t.addRRect(e))}},{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,top:0,right:0,bottom:0};return t.left=-this.width/2,t.top=-this.height/2,t.right=this.width/2,t.bottom=this.height/2,t}},{key:"getSVGLabelName",value:function(){return"rect"}},{key:"getSVGPositionString",value:function(){return'x="'.concat(-this.width/2,'" y="').concat(-this.height/2,'"')}}]),i}(ci)),vn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){return Object(Pe["a"])(this,i),e.call(this,t)}return Object(Fe["a"])(i,[{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:left,right:right,top:top,bottom:bottom},e=Object(Te["a"])(Object(Re["a"])(i.prototype),"calculateLocalBounds",this).call(this,t);return e.left-=this.width,e.top-=this.height,e.right+=this.width,e.bottom+=this.height,e}}]),i}(pn),bn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){return Object(Pe["a"])(this,i),e.call(this,t)}return Object(Fe["a"])(i,[{key:"drawPath",value:function(t){var e=Ee.newXYWHRect(-this.width/2,-this.height/2,this.width,this.height);t.addOval(e)}},{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,top:0,right:0,bottom:0};return t.left=-this.width/2,t.top=-this.height/2,t.right=this.width/2,t.bottom=this.height/2,t}},{key:"getSVGLabelName",value:function(){return"ellipse"}},{key:"getSVGPositionString",value:function(){return'cx="0" cy="0"'}},{key:"getSVGDimensionString",value:function(){return'rx="'.concat(this.width/2,'" ry="').concat(this.height/2,'"')}}]),i}(Ji),yn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){return Object(Pe["a"])(this,i),e.call(this,t)}return Object(Fe["a"])(i,[{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:left,right:right,top:top,bottom:bottom},e=Object(Te["a"])(Object(Re["a"])(i.prototype),"calculateLocalBounds",this).call(this,t);return e.left-=this.width,e.top-=this.height,e.right+=this.width,e.bottom+=this.height,e}}]),i}(bn),gn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){return Object(Pe["a"])(this,i),e.call(this,t)}return Object(Fe["a"])(i,[{key:"containsPoint",value:function(t,e,i){return!1}}]),i}(ci),mn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),n.relatedSelection,n.relateFigure,n}return Object(Fe["a"])(i,[{key:"fireShapeDirty",value:function(){}},{key:"copyPath",value:function(t){this._path&&this.getTarget()._path.delete(),t.getPath?this.getTarget()._path=t.getTarget().getPath().copy():(this.getTarget()._path=Ee.newPath(),this.getTarget()._path.addRect(Ee.newXYWHRect(0,0,t.width,t.height)))}},{key:"isVisible",value:function(){return this.visible&&(0!=this.scalex||0!=this.scaley)}}]),i}(si),kn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o,r){var a;return Object(Pe["a"])(this,i),a=e.call(this),a.frontRoot=t,a.mainRoot=n,a.backendRoot=o,a.id=r,a.actived=!1,a.using=!1,a.currentFeedbacks,a}return Object(Fe["a"])(i,[{key:"currentSelections",get:function(){return this._selections},set:function(t){this._selections=t}},{key:"defaultCursor",get:function(){var t=tn.CURSOR[this.id];return t||"default"}},{key:"toolTipUpdate",value:function(t){this.fireEvent("updateTooltip",{tooltip:t})}},{key:"updateCurrentSelections",value:function(t){this.currentSelections=t}},{key:"addNewFigure",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"图形";this.fireEvent("addFigure",{figure:t,name:e})}},{key:"changeCursor",value:function(t){this.fireEvent("cursorChange",{cursor:t})}},{key:"switchTool",value:function(t,e,i,n){this.fireEvent("toolSwitch",{id:t,x:e,y:i,args:n})}},{key:"fireSelectionChangeEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"new";this.fireEvent("selectionChange",{type:e,selections:t})}},{key:"prepare",value:function(t){this.using=!0}},{key:"unUse",value:function(t){this.using=!1,cancelAnimationFrame(this._moveRefreshId),this._moveRefreshId=null}},{key:"active",value:function(t,e,i){this._moveRefreshId&&cancelAnimationFrame(this._moveRefreshId),this.sx=t,this.sy=e,this.lx=t,this.ly=e,this.actived=!0,this.fireEvent("active",{id:this.id,x:t,y:e}),this.toolActived(t,e,i)}},{key:"move",value:function(t,e,i){var n=this;this._moveRefreshId&&cancelAnimationFrame(this._moveRefreshId),this._moveRefreshId=requestAnimationFrame((function(){var o;if(n.actived){var r=t-n.lx,a=e-n.ly,s=Math.min(t,n.sx),c=Math.min(e,n.sy),h=Math.max(t,n.sx),l=Math.max(e,n.sy);o=n.activeMove(t,e,s,c,h,l,r,a,i),n.lx=t,n.ly=e}else o=n.hoverMove(t,e,i);o||(o="x:".concat(t,",y:").concat(e)),n.toolTipUpdate(o)}))}},{key:"activeMove",value:function(t,e,i,n,o,r,a,s,c){}},{key:"hoverMove",value:function(t,e,i){}},{key:"deactive",value:function(t,e,i){if(this.actived){this._moveRefreshId&&cancelAnimationFrame(this._moveRefreshId),this.ex=t,this.ey=e;try{var n=this.toolDeactived(t,e,i);this.fireEvent("complete",{id:this.id,result:n})}catch(o){console.error(o)}finally{this.reset()}}}},{key:"reset",value:function(){this.actived=!1,cancelAnimationFrame(this._moveRefreshId),this._moveRefreshId=null,this.sx=this.sy=this.ex=this.ey=this.lx=this.ly=null}},{key:"toolActived",value:function(t,e,i){}},{key:"toolDeactived",value:function(t,e,i){}}],[{key:"createDelegateFigure",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=new mn;if(i.copyPath(t),i.relatedSelection=t,this.setFeedbackColors(i),e){var n=t.worldMatrix,o=n.decompose();Ge.applyPose(i,o)}return i}},{key:"setFeedbackColors",value:function(t){t.br=this.FEEDBACK_B_COLOR[0],t.bg=this.FEEDBACK_B_COLOR[1],t.bb=this.FEEDBACK_B_COLOR[2],t.ba=1,t.r=this.FEEDBACK_COLOR[0],t.g=this.FEEDBACK_COLOR[1],t.b=this.FEEDBACK_COLOR[2],t.a=.3}},{key:"setErrorColors",value:function(t){t.showBorder=!1,t.r=255,t.g=0,t.b=0,t.a=1}},{key:"copyPoseDatas",value:function(t,e){t&&e&&(e.x=t.x,e.y=t.y,e.scalex=t.scalex,e.scaley=t.scaley,e.skewx=t.skewx,e.skewy=t.skewy,e.rotation=t.rotation,e.width=t.width,e.height=t.height)}},{key:"FEEDBACK_COLOR",get:function(){return On}},{key:"FEEDBACK_B_COLOR",get:function(){return jn}}]),i}(ze),On=[9,124,244],jn=[14,98,234],wn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;Object(Pe["a"])(this,i),n=e.call(this,t),n.anchorSize=null==t||null==t.as?6:t.as,n.padding=null==t||null==t.padding?5:t.padding,n.feedbackContainer=new gn({a:0,showBorder:!1}),n.addChild(n.feedbackContainer),n.rotateAnchor=new yn({width:n.anchorSize,height:n.anchorSize,r:22,g:199,b:154}),n.addChild(n.rotateAnchor),n.topAnchor=new vn({width:n.anchorSize,height:n.anchorSize}),n.addChild(n.topAnchor),n.bottomAnchor=new vn({width:n.anchorSize,height:n.anchorSize}),n.addChild(n.bottomAnchor),n.leftAnchor=new vn({width:n.anchorSize,height:n.anchorSize}),n.addChild(n.leftAnchor),n.rightAnchor=new vn({width:n.anchorSize,height:n.anchorSize}),n.addChild(n.rightAnchor),n.seAnchor=new vn({width:n.anchorSize,height:n.anchorSize}),n.addChild(n.seAnchor),n.neAnchor=new vn({width:n.anchorSize,height:n.anchorSize}),n.addChild(n.neAnchor),n.swAnchor=new vn({width:n.anchorSize,height:n.anchorSize}),n.addChild(n.swAnchor),n.nwAnchor=new vn({width:n.anchorSize,height:n.anchorSize}),n.addChild(n.nwAnchor),n.anchor={x:.5,y:.5};var o=kn.FEEDBACK_B_COLOR;return n.br=o[0],n.bg=o[1],n.bb=o[2],n.a=0,n}return Object(Fe["a"])(i,[{key:"initFeedbackContainer",value:function(){this.feedbackContainer&&(this.feedbackContainer.width=this.width,this.feedbackContainer.height=this.height,this.feedbackContainer.rotation=0,this.feedbackContainer.scalex=this.feedbackContainer.scaley=1,this.feedbackContainer.skewx=this.feedbackContainer.skewy=0)}},{key:"addFeedback",value:function(t){this.feedbackContainer.addChild(t)}},{key:"removeFeedback",value:function(t){this.feedbackContainer.removeChild(t)}},{key:"updateAnchorsPostion",value:function(){if(this.topAnchor&&(this.topAnchor.y=-this.padding,this.topAnchor.x=this.width/2),this.bottomAnchor&&(this.bottomAnchor.y=this.height+this.padding,this.bottomAnchor.x=this.width/2),this.leftAnchor&&(this.leftAnchor.y=this.height/2,this.leftAnchor.x=-this.padding),this.rightAnchor&&(this.rightAnchor.y=this.height/2,this.rightAnchor.x=this.width+this.padding),this.seAnchor&&(this.seAnchor.y=this.height+this.padding,this.seAnchor.x=this.width+this.padding),this.neAnchor&&(this.neAnchor.y=-this.padding,this.neAnchor.x=this.width+this.padding),this.swAnchor&&(this.swAnchor.y=this.height+this.padding,this.swAnchor.x=-this.padding),this.nwAnchor&&(this.nwAnchor.y=-this.padding,this.nwAnchor.x=-this.padding),this.rotateAnchor&&(this.rotateAnchor.y=-this.padding-2*this.rotateAnchor.width,this.rotateAnchor.x=this.width+this.padding+2*this.rotateAnchor.height),this.feedbackContainer){var t=this.feedbackContainer.width,e=this.feedbackContainer.height;0==this.width&&(this.feedbackContainer.scalex=0),0==this.height&&(this.feedbackContainer.scaley=0),0!=t&&(this.feedbackContainer.scalex=this.width/t),0!=e&&(this.feedbackContainer.scaley=this.height/e)}}},{key:"width",get:function(){return Object(Te["a"])(Object(Re["a"])(i.prototype),"width",this)},set:function(t){t!=Object(Te["a"])(Object(Re["a"])(i.prototype),"width",this)&&(Object(Ae["a"])(Object(Re["a"])(i.prototype),"width",t,this,!0),this.updateAnchorsPostion())}},{key:"height",get:function(){return Object(Te["a"])(Object(Re["a"])(i.prototype),"height",this)},set:function(t){t!=Object(Te["a"])(Object(Re["a"])(i.prototype),"height",this)&&(Object(Ae["a"])(Object(Re["a"])(i.prototype),"height",t,this,!0),this.updateAnchorsPostion())}},{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:left,top:top,right:right,bottom:bottom};return t.left=-this.padding-this.anchorSize/2-this.anchorSize,t.top=-this.padding-this.anchorSize/2-3*this.anchorSize,t.right=this.width+this.padding+this.anchorSize/2+3*this.anchorSize,t.bottom=this.height+this.padding+this.anchorSize/2+this.anchorSize,t}},{key:"drawPath",value:function(t){var e=this.padding;t.addRect(Ee.newXYWHRect(-e,-e,this.width+2*e,this.height+2*e))}},{key:"drawSelf",value:function(t){Object(Te["a"])(Object(Re["a"])(i.prototype),"drawSelf",this).call(this,t),this._paint.setStyle(Ee.strokeStyle);var e=this.width/2,n=e,o=this.height/2-this.anchorSize,r=o+2*this.anchorSize;t.drawLine(e,o,n,r,this._paint),e=this.width/2-this.anchorSize,n=e+2*this.anchorSize,o=this.height/2,r=o,t.drawLine(e,o,n,r,this._paint)}}]),i}(ci),xn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;Object(Pe["a"])(this,t),this.max=e,this.redos=[],this.undos=[]}return Object(Fe["a"])(t,[{key:"excute",value:function(t){if(t.excute(),this.undos.length>=this.max){var e=this.undos.shift();e.disposeUndo()}this.undos.push(t),this.redos.forEach((function(t){t.disposeRedo()})),this.redos.length=0}},{key:"canRedo",value:function(){return this.redos.length>0}},{key:"canUndo",value:function(){return this.undos.length>0}},{key:"redo",value:function(){if(this.canRedo()){var t=this.redos.pop();t.redo(),this.undos.push(t)}}},{key:"undo",value:function(){if(this.canUndo()){var t=this.undos.pop();t.undo(),this.redos.push(t)}}},{key:"dispose",value:function(){this.undos.forEach((function(t){t.dispose()})),this.undos.length=0,this.redos.forEach((function(t){t.dispose()})),this.redos.length=0}}]),t}(),Cn=function(){function t(e){Object(Pe["a"])(this,t),this.name=e}return Object(Fe["a"])(t,[{key:"excute",value:function(){}},{key:"redo",value:function(){}},{key:"undo",value:function(){}},{key:"disposeRedo",value:function(){}},{key:"disposeUndo",value:function(){}},{key:"dispose",value:function(){}}]),t}(),_n=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n){var o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"添加图形";return Object(Pe["a"])(this,i),o=e.call(this,r),o.child=t,o.parent=n,o}return Object(Fe["a"])(i,[{key:"excute",value:function(){null!=this.index?this.parent.insertChild(this.child,this.index):this.parent.addChild(this.child)}},{key:"redo",value:function(){this.excute()}},{key:"undo",value:function(){this.index=this.parent.children.indexOf(this.child),this.parent.removeChild(this.child)}},{key:"dispose",value:function(){this.parent&&this.parent.dispose(),this.child&&this.child.dispose(),this.parent=null,this.child=null}},{key:"disposeRedo",value:function(){this.child&&this.child.dispose(),this.child=null}},{key:"disposeUndo",value:function(){}}]),i}(Cn),Sn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"移动图形";return Object(Pe["a"])(this,i),r=e.call(this,a),r.figure=t,r.dx=n,r.dy=o,r}return Object(Fe["a"])(i,[{key:"excute",value:function(){var t=this.figure;t.x+=this.dx,t.y+=this.dy}},{key:"redo",value:function(){this.excute()}},{key:"undo",value:function(){var t=this.figure;t.x-=this.dx,t.y-=this.dy}},{key:"dispose",value:function(){this.figure&&this.figure.dispose(),this.figure=null}}]),i}(Cn),Pn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Composite Actions";return Object(Pe["a"])(this,i),t=e.call(this,n),t.actions=[],t}return Object(Fe["a"])(i,[{key:"add",value:function(t){t&&this.actions.push(t)}},{key:"remove",value:function(t){if(t){var e=this.actions.indexOf(t);-1!=e&&this.actions.splice(e,1)}}},{key:"excute",value:function(){this.actions.forEach((function(t){t.excute()}))}},{key:"redo",value:function(){this.excute()}},{key:"undo",value:function(){for(var t=this.actions.length-1;t>=0;t--){var e=this.actions[t];e.undo()}}},{key:"disposeRedo",value:function(){}},{key:"disposeUndo",value:function(){}},{key:"dispose",value:function(){this.actions.forEach((function(t){t.dispose()}))}}]),i}(Cn),Fn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n){var o;return Object(Pe["a"])(this,i),o=e.call(this,"姿势更改"),o.pose=n,o.figure=t,o.old={x:t.x,y:t.y,rotation:t.rotation,scalex:t.scalex,scaley:t.scaley,skewx:t.skewx,skewy:t.skewy},o}return Object(Fe["a"])(i,[{key:"excute",value:function(){this.figure.x=this.pose.translation.x,this.figure.y=this.pose.translation.y,this.figure.rotation=this.pose.rotation,this.figure.scalex=this.pose.scale.x,this.figure.scaley=this.pose.scale.y,this.figure.skewx=this.pose.skew.x,this.figure.skewy=this.pose.skew.y}},{key:"redo",value:function(){this.excute()}},{key:"undo",value:function(){this.figure.x=this.old.x,this.figure.y=this.old.y,this.figure.rotation=this.old.rotation,this.figure.scalex=this.old.scalex,this.figure.scaley=this.old.scaley,this.figure.skewx=this.old.skewx,this.figure.skewy=this.old.skewy}},{key:"dispose",value:function(){this.figure&&this.figure.dispose(),this.figure=null}}]),i}(Cn),An=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"添加顶点";return Object(Pe["a"])(this,i),r=e.call(this,a),r.point=t,r.path=n,r.index=o,r}return Object(Fe["a"])(i,[{key:"excute",value:function(){this.path.insertPoint(this.point,this.index)}},{key:"redo",value:function(){this.path.insertPoint(this.point.clone(),this.index)}},{key:"undo",value:function(){this.path.deleteAt(this.index)}},{key:"dispose",value:function(){this.path&&this.path.dispose(),this.path=null,this.point=null}}]),i}(Cn),Tn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r;return Object(Pe["a"])(this,i),r=e.call(this,"更改属性值"),r.model=t,r.property=n,r.value=o,r}return Object(Fe["a"])(i,[{key:"excute",value:function(){void 0==this.oldValue&&(this.oldValue=this.model[this.property]),this.model[this.property]=this.value}},{key:"redo",value:function(){this.excute()}},{key:"undo",value:function(){this.model[this.property]=this.oldValue}},{key:"dispose",value:function(){this.model&&this.model.dispose&&this.model.dispose(),this.model=null}},{key:"disposeRedo",value:function(){}},{key:"disposeUndo",value:function(){}}]),i}(Cn),Rn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n){var o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"删除顶点";return Object(Pe["a"])(this,i),o=e.call(this,r),o.path=t,o.index=n,o}return Object(Fe["a"])(i,[{key:"excute",value:function(){this.point=this.path.deleteAt(this.index)}},{key:"undo",value:function(){this.path.insertPoint(this.point.clone(),this.index)}},{key:"redo",value:function(){this.path.deleteAt(this.index)}},{key:"dispose",value:function(){this.path&&this.path.dispose(),this.path=null,this.point=null}}]),i}(Cn),Mn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n){var o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"删除图形";return Object(Pe["a"])(this,i),o=e.call(this,r),o.child=t,o.parent=n,o}return Object(Fe["a"])(i,[{key:"excute",value:function(){this.index=this.parent.children.indexOf(this.child),this.parent.removeChild(this.child)}},{key:"redo",value:function(){this.excute()}},{key:"undo",value:function(){this.parent.insertChild(this.child,this.index)}},{key:"dispose",value:function(){this.parent&&this.parent.dispose(),this.parent=null,this.figure&&this.figure.dispose(),this.figure=null}},{key:"disposeUndo",value:function(){this.figure&&this.figure.dispose(),this.figure=null}}]),i}(Cn),Dn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n){var o;return Object(Pe["a"])(this,i),o=e.call(this,"Change Index"),o.figure=t,o.index=n,o.oldIndex=o.figure.parent.indexOfChild(o.figure),o}return Object(Fe["a"])(i,[{key:"excute",value:function(){var t=this.figure.parent;t.removeChild(this.figure),t.insertChild(this.figure,this.index)}},{key:"redo",value:function(){this.excute()}},{key:"undo",value:function(){var t=this.figure.parent;t.removeChild(this.figure),t.insertChild(this.figure,this.oldIndex)}},{key:"dispose",value:function(){this.figure&&this.figure.dispose(),this.figure=null}}]),i}(Cn),Vn=function(){function t(){Object(Pe["a"])(this,t)}return Object(Fe["a"])(t,null,[{key:"newChangeIndexAction",value:function(t,e){return new Dn(t,e)}},{key:"newRemoveFigureAction",value:function(t,e){return new Mn(t,e)}},{key:"newChangePropertyAction",value:function(t,e,i){return new Tn(t,e,i)}},{key:"newInsertPointAction",value:function(t,e,i){return new An(t,e,i)}},{key:"newDeletePointAction",value:function(t,e){return new Rn(t,e)}},{key:"newAddFigureAction",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"添加图形";return new _n(t,e,i)}},{key:"newTranslateAction",value:function(t,e,i){var n=new Pn;return t.forEach((function(t){n.add(new Sn(t,e,i))})),n}},{key:"newPoseChangeAction",value:function(t){var e=new Pn;return t.forEach((function(t){e.add(new Fn(t.figure,t.pose))})),e}}]),t}(),Bn=function(){function t(e,i){Object(Pe["a"])(this,t),this.x=e,this.y=i}return Object(Fe["a"])(t,[{key:"magnitude",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"radian",get:function(){return Math.atan2(this.y,this.x)}},{key:"normalize",value:function(){var t=this.magnitude;if(0!=t)return this.x=this.x/t,this.y=this.y/t,this}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this}},{key:"dot",value:function(t,e){return this.x*t+this.y*e}},{key:"plus",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"rotate",value:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.x*i+this.y*e,o=this.x*e-this.y*i;return this.x=o,this.y=n,this}},{key:"clone",value:function(){return new t(this.x,this.y)}}]),t}(),En=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o,r){var a;return Object(Pe["a"])(this,i),a=e.call(this,t,n,o,r),a.currentFeedbacks,a}return Object(Fe["a"])(i,[{key:"prepare",value:function(t){Object(Te["a"])(Object(Re["a"])(i.prototype),"prepare",this).call(this,t),t&&t.transformFeedback&&(this._transformFeedback=t.transformFeedback),t&&t.currentFeedbacks&&(this.currentFeedbacks=t.currentFeedbacks)}},{key:"unUse",value:function(t){this.updateFeedbackId&&cancelAnimationFrame(this.updateFeedbackId),this.updateFeedbackId=null,t&&t.keepFeedback||this._transformFeedback&&(this.frontRoot.removeChild(this._transformFeedback),this.transformFeedback.dispose(),this._transformFeedback=null,this.frontRoot.refresh()),Object(Te["a"])(Object(Re["a"])(i.prototype),"unUse",this).call(this,t)}},{key:"requestUpdateFeedbackFigures",value:function(){var t=this;if(this.using){var e=this.transformFeedback;this.updateFeedbackId&&cancelAnimationFrame(this.updateFeedbackId),this.updateFeedbackId=requestAnimationFrame((function(){if(e.visible=!1,e.rotation=0,e.scalex=e.scaley=1,e.skewx=e.skewy=0,t.currentFeedbacks||(t.currentFeedbacks=[]),t.currentSelections.sort((function(t,e){var i=t.parent,n=e.parent;return i&&n?i.indexOfChild(t)-n.indexOfChild(e):0})),t.currentFeedbacks.forEach((function(t){t.parent&&t.parent.removeChild(t),t.dispose(),t.parent=null,t.relatedSelection=null})),t.currentFeedbacks.length=0,t.currentSelections.forEach((function(e){while(e.parent!=t.mainRoot)e=e.parent;var i=kn.createDelegateFigure(e,!1);t.transformFeedback.addFeedback(i),t.currentFeedbacks.push(i)})),t.currentFeedbacks&&0!=t.currentFeedbacks.length){t.transformFeedback.visible=!0;for(var n,o=!0,r=t.currentSelections[0].rotation,a=1;a<t.currentSelections.length;a++){var s=t.currentSelections[a];while(s.parent!=t.mainRoot)s=s.parent;if(!i.isSameRadian(r,s.rotation)){o=!1;break}}if(o){var c=new Bn(1,0).rotate(r),h=new Bn(0,1).rotate(r),l=[1/0,-1/0],u=[1/0,-1/0];t.currentSelections.forEach((function(e){while(e.parent!=t.mainRoot)e=e.parent;var i=e.worldVertices;i.forEach((function(t){var e=c.dot(t[0],t[1]);l[0]=Math.min(l[0],e),l[1]=Math.max(l[1],e);var i=h.dot(t[0],t[1]);u[0]=Math.min(u[0],i),u[1]=Math.max(u[1],i)}))}));var d=c.clone().scale(l[0]),f=c.clone().scale(l[1]),p=h.clone().scale(u[0]),v=h.clone().scale(u[1]),b=new Bn(d.x-p.x,d.y-p.y),y=b.dot(c.x,c.y);b.x=y*c.x+p.x,b.y=y*c.y+p.y;var g=new Bn(f.x-v.x,f.y-v.y);y=g.dot(c.x,c.y),g.x=y*c.x+v.x,g.y=y*c.y+v.y;var m=new Bn(g.x-b.x,g.y-b.y),k=c.dot(m.x,m.y),O=h.dot(m.x,m.y);t.transformFeedback.rotation=r,n={left:b.x,top:b.y,right:b.x+k,bottom:b.y+O}}else n=tn.calculateFiguresBounds(t.currentSelections);t.transformFeedback.x=n.left,t.transformFeedback.y=n.top,t.transformFeedback.width=n.right-n.left,t.transformFeedback.height=n.bottom-n.top,t.transformFeedback.initFeedbackContainer();var j=t.transformFeedback.worldMatrix.clone().invert();t.currentFeedbacks.forEach((function(t){var e=j.clone().multiply(t.relatedSelection.worldMatrix),i=e.decompose();Ge.applyPose(t,i)}))}t.feedbackFiguresUpdated(),t.frontRoot.refresh(),t.updateFeedbackId=null}))}}},{key:"feedbackFiguresUpdated",value:function(){}},{key:"updateCurrentSelections",value:function(t){Object(Te["a"])(Object(Re["a"])(i.prototype),"updateCurrentSelections",this).call(this,t),this.requestUpdateFeedbackFigures()}},{key:"transformFeedback",get:function(){return null==this._transformFeedback&&(this._transformFeedback=new wn,this.frontRoot.addChild(this._transformFeedback)),this._transformFeedback}}],[{key:"isSameRadian",value:function(t,e){return t==e||Math.abs(t-e)<=qn}}]),i}(kn),qn=1e-5,In=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r;return Object(Pe["a"])(this,i),r=e.call(this,t,n,o,"select"),r.notifySelectionChange=!0,r}return Object(Fe["a"])(i,[{key:"rect",get:function(){if(!this._selectRect){var t=kn.FEEDBACK_COLOR,e=kn.FEEDBACK_B_COLOR;this._selectRect=new ci({r:t[0],g:t[1],b:t[2],a:.5,showBorder:!0,br:e[0],bg:e[1],bb:e[2],borderWidth:1}),this.frontRoot.addChild(this._selectRect)}return this._selectRect}},{key:"toolActived",value:function(t,e){this.rect.visible=!1,this.deleteHoverFigure();var i=this.frontRoot.findFigure(t,e);i=i==this.frontRoot?null:i;var n=this.getTransformToolId(i);if(n)this.notifySelectionChange=!1,this.switchTool(n,t,e,{currentFeedbacks:this.currentFeedbacks,transformFeedback:this.transformFeedback,keepFeedback:!0});else if(i=this.mainRoot.findFigure(t,e),i=i==this.mainRoot?null:i,i){while(i.parent!=this.mainRoot)i=i.parent;this.currentSelections&&-1!=this.currentSelections.indexOf(i)&&(this.notifySelectionChange=!1),this.switchTool("move",t,e,{currentFeedbacks:this.currentFeedbacks,transformFeedback:this.transformFeedback,keepFeedback:!0})}else this.rect.width=this.rect.height=0,this.rect.visible=!0}},{key:"toolDeactived",value:function(t,e){var i=this;if(this.notifySelectionChange){var n=Math.min(this.sx,this.ex),o=Math.min(this.sy,this.ey),r=Math.max(this.sx,this.ex),a=Math.max(this.sy,this.ey);if(n==r&&o==a){var s=this.mainRoot.findFigure(n,o);if(s=s==this.mainRoot?null:s,s)while(s.parent!=this.mainRoot)s=s.parent;var c=[];return s&&c.push(s),{selections:c,type:"new"}}var h=this.mainRoot.findChildren({left:n,top:o,right:r,bottom:a}),l=[];return h&&0!=h.length&&h.forEach((function(t){var e=t instanceof ri?t.value:t;Ze.contactTest(e.worldVertices,e.worldAxis,i.rect.worldVertices,[[0,1],[1,0]])&&l.push(e)})),{selections:l,type:"new"}}}},{key:"hoverMove",value:function(t,e){if(0!=this.mainRoot.children.length){var i=this.frontRoot.findFigure(t,e),n=this.getTransformToolId(i);if(this.changeCursor(this.defaultCursor),n){var o=tn.CURSOR[n];return o&&this.changeCursor(o),this.deleteHoverFigure(),this.frontRoot.refresh(),"变换:".concat(n)}var r=this.mainRoot.findFigure(t,e);return r=r==this.mainRoot?null:r,r instanceof hi&&(r=null),this.currentSelectionsContains(r)&&this.changeCursor(tn.CURSOR["move"]),this.updateHoverFigure(r),this.frontRoot.refresh(),r?"".concat(r.name," [x:").concat(r.x.toFixed(0),",y:").concat(r.y.toFixed(0),",w:").concat(r.width,",h:").concat(r.height,"]"):void 0}}},{key:"feedbackFiguresUpdated",value:function(){this.updateHoverFigure()}},{key:"currentSelectionsContains",value:function(t){if(!this.currentSelections||!t)return!1;for(var e=0;e<this.currentSelections.length;e++){var i=this.currentSelections[e];if(i.id==t.id)return!0}return!1}},{key:"getTransformToolId",value:function(t){if(t){var e=this.transformFeedback;if(null!=e){if(t==e.rotateAnchor)return"rotate";if(t==e.topAnchor)return"n-resize";if(t==e.bottomAnchor)return"s-resize";if(t==e.leftAnchor)return"w-resize";if(t==e.rightAnchor)return"e-resize";if(t==e.seAnchor)return"se-resize";if(t==e.neAnchor)return"ne-resize";if(t==e.swAnchor)return"sw-resize";if(t==e.nwAnchor)return"nw-resize"}}}},{key:"isTransformTool",value:function(t){var e=this.transformFeedback;if(null!=e)return t==e.topAnchor||t==e.rotateAnchor||t==e.bottomAnchor||t==e.rightAnchor||t==e.leftAnchor||t==e.seAnchor||t==e.neAnchor||t==e.swAnchor||t==e.nwAnchor}},{key:"deleteHoverFigure",value:function(){this._lastHoverDelegate&&(this._lastHoverDelegate.dispose(),this.frontRoot.removeChild(this._lastHoverDelegate),this._lastHoverDelegate.parent=null,this._lastHoverDelegate.relatedSelection=null,this._lastHoverDelegate=null)}},{key:"updateHoverFigure",value:function(t){t?this._lastHoverDelegate?this._lastHoverDelegate.relatedSelection.id!=t.id&&(this.deleteHoverFigure(),this._lastHoverDelegate=kn.createDelegateFigure(t),this.frontRoot.addChild(this._lastHoverDelegate)):this.isTransformTool(t)||(this._lastHoverDelegate=kn.createDelegateFigure(t),this.frontRoot.addChild(this._lastHoverDelegate)):this.deleteHoverFigure()}},{key:"activeMove",value:function(t,e,i,n,o,r){this.rect.x=i,this.rect.y=n,this.rect.width=o-i,this.rect.height=r-n,this.frontRoot.refresh()}},{key:"reset",value:function(){Object(Te["a"])(Object(Re["a"])(i.prototype),"reset",this).call(this),this.deleteHoverFigure(),this.notifySelectionChange=!0,this.rect.visible=!1,this.rect.width=this.rect.height=0,this.frontRoot.refresh()}},{key:"unUse",value:function(){this.deleteHoverFigure(),Object(Te["a"])(Object(Re["a"])(i.prototype),"unUse",this).call(this)}}]),i}(En),zn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r;return Object(Pe["a"])(this,i),r=e.call(this,t,n,o,"move"),r.startPosition={},r}return Object(Fe["a"])(i,[{key:"prepare",value:function(t){t&&(this.currentFeedbacks=t.currentFeedbacks,this.transformFeedback=t.transformFeedback)}},{key:"toolActived",value:function(t,e){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"toolActived",this).call(this,t,e),this.currentFeedbacks&&this.currentFeedbacks.length>0){var n=this.currentFeedbacks[0];this.startPosition=n.worldMatrix.decompose().translation}}},{key:"activeMove",value:function(t,e,n,o,r,a,s,c){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"activeMove",this).call(this,t,e,n,o,r,a),this.currentFeedbacks&&this.transformFeedback){var h=this.transformFeedback.worldMatrix.invert(),l=h.multiplyWithVertexDatas(this.lx,this.ly),u=h.multiplyWithVertexDatas(t,e);s=u[0]-l[0],c=u[1]-l[1],this.currentFeedbacks.forEach((function(t){t.x+=s,t.y+=c})),this.frontRoot.refresh()}}},{key:"toolDeactived",value:function(t,e){Object(Te["a"])(Object(Re["a"])(i.prototype),"toolDeactived",this).call(this,t,e);var n=this.ex-this.sx,o=this.ey-this.sy;if(0!=n||0!=o){var r=[];return this.currentSelections.forEach((function(t){return r.push(t)})),{figures:r,dx:n/this.mainRoot.scalex,dy:o/this.mainRoot.scaley}}}}]),i}(kn),Hn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o,r){return Object(Pe["a"])(this,i),e.call(this,t,n,o,r)}return Object(Fe["a"])(i,[{key:"prepare",value:function(t){t&&(this.currentFeedbacks=t.currentFeedbacks,this.transformFeedback=t.transformFeedback)}},{key:"isIllegalData",get:function(){return!1}},{key:"processFinalResult",value:function(t){}},{key:"toolDeactived",value:function(t,e){var n=this;if(Object(Te["a"])(Object(Re["a"])(i.prototype),"toolDeactived",this).call(this,t,e),!this.isIllegalData){var o=[];return this.currentFeedbacks.forEach((function(t){try{var e,i=t.relatedSelection;if(null==i)return void console.error("发生错误，没有找到feedbackfigure id对应的figure");e=i.parent?i.parent.worldMatrix.clone().invert():new Le;var r=t.worldMatrix;e.multiply(r);var a=e.decompose();n.processFinalResult(a),o.push({figure:i,pose:a})}catch(s){console.error(s)}})),o}}}]),i}(kn),Nn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r;return Object(Pe["a"])(this,i),r=e.call(this,t,n,o,"rotate"),r.sr,r.anchor={x:.5,y:.5},r}return Object(Fe["a"])(i,[{key:"prepare",value:function(t){Object(Te["a"])(Object(Re["a"])(i.prototype),"prepare",this).call(this,t),this.anchor=null!=t&&null!=t.anchor?t.anchor:this.anchor}},{key:"active",value:function(t,e){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"active",this).call(this,t,e),this.transformFeedback){var n=this.transformFeedback,o=n.worldMatrix.clone();this.cx=this.w=this.anchor.x*n.width,this.cy=this.h=this.anchor.y*n.height;var r=o.multiplyWithVertexDatas(this.cx,this.cy);this.cx=r[0],this.cy=r[1],this.sr=Math.atan2(e-this.cy,t-this.cx),this.startRotation=this.transformFeedback.rotation}}},{key:"activeMove",value:function(t,e,n,o,r,a,s,c){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"activeMove",this).call(this,t,e,n,o,r,a,s,c),this.transformFeedback){var h=this.transformFeedback,l=Math.atan2(e-this.cy,t-this.cx),u=l-this.sr,d=(new Le).translate(this.cx,this.cy).rotate(u+this.startRotation).translate(-this.w,-this.h).decompose();Ge.applyPose(h,d),h.scalex=h.scaley=1,h.skewx=h.skewy=0,this.frontRoot.refresh()}}},{key:"isIllegalData",get:function(){if(this.transformFeedback)return this.transformFeedback.rotation-this.startRotation==0}},{key:"reset",value:function(){Object(Te["a"])(Object(Re["a"])(i.prototype),"reset",this).call(this),this.startRotation=null,this.sr=null,this.cx=this.cy=null}}]),i}(Hn),Ln=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){return Object(Pe["a"])(this,i),e.call(this,t,n,o,"e-resize")}return Object(Fe["a"])(i,[{key:"isIllegalData",get:function(){return this.ex-this.sx==0}},{key:"activeMove",value:function(t,e,n,o,r,a,s,c){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"activeMove",this).call(this,t,e,n,o,r,a,s,c),this.transformFeedback){var h=Ge.distance(this.lx,this.ly,t,e);0==s&&(h=0),s<0&&(h*=-1),this.transformFeedback.width+=h,this.frontRoot.refresh()}}}]),i}(Hn),Gn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){return Object(Pe["a"])(this,i),e.call(this,t,n,o,"w-resize")}return Object(Fe["a"])(i,[{key:"activeMove",value:function(t,e,n,o,r,a,s,c){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"activeMove",this).call(this,t,e,n,o,r,a,s,c),this.transformFeedback){var h=Ge.distance(this.lx,this.ly,t,e);0==s&&(h=0),s>0&&(h*=-1),this.transformFeedback.width+=h;var l=new Bn(-1,0).rotate(this.transformFeedback.rotation);l.scale(h),this.transformFeedback.y+=l.y,this.transformFeedback.x+=l.x,this.frontRoot.refresh()}}},{key:"isIllegalData",get:function(){return this.ex-this.sx==0}}]),i}(Hn),Un=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){return Object(Pe["a"])(this,i),e.call(this,t,n,o,"n-resize")}return Object(Fe["a"])(i,[{key:"isIllegalData",get:function(){return this.ey-this.sy==0}},{key:"activeMove",value:function(t,e,n,o,r,a,s,c){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"activeMove",this).call(this,t,e,n,o,r,a,s,c),this.transformFeedback){var h=Ge.distance(this.lx,this.ly,t,e);0==c&&(h=0),c>0&&(h*=-1),this.transformFeedback.height+=h;var l=new Bn(0,-1).rotate(this.transformFeedback.rotation);l.scale(h),this.transformFeedback.y+=l.y,this.transformFeedback.x+=l.x,this.frontRoot.refresh()}}}]),i}(Hn),Wn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){return Object(Pe["a"])(this,i),e.call(this,t,n,o,"s-resize")}return Object(Fe["a"])(i,[{key:"isIllegalData",get:function(){return this.ey-this.sy==0}},{key:"activeMove",value:function(t,e,n,o,r,a,s,c){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"activeMove",this).call(this,t,e,n,o,r,a,s,c),this.transformFeedback){var h=Ge.distance(this.lx,this.ly,t,e);0==c&&(h=0),c<0&&(h*=-1),this.transformFeedback.height+=h,this.frontRoot.refresh()}}}]),i}(Hn),Yn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o,r){return Object(Pe["a"])(this,i),e.call(this,t,n,o,r)}return Object(Fe["a"])(i,[{key:"isIllegalData",get:function(){return this.ex-this.sx==0&&this.ey-this.ex==0}},{key:"activeMove",value:function(t,e,n,o,r,a,s,c){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"activeMove",this).call(this,t,e,n,o,r,a,s,c),this.transformFeedback){var h=this.transformFeedback.worldMatrix.clone().invert(),l=h.multiplyWithVertexDatas(this.lx,this.ly),u=h.multiplyWithVertexDatas(t,e);s=u[0]-l[0],c=u[1]-l[1],this.updateTransformFeedback(this.transformFeedback,s,c,t,e),this.frontRoot.refresh()}}},{key:"updateTransformFeedback",value:function(t,e,i){}}]),i}(Hn),Kn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){return Object(Pe["a"])(this,i),e.call(this,t,n,o,"se-resize")}return Object(Fe["a"])(i,[{key:"updateTransformFeedback",value:function(t,e,i){t.height+=i,t.width+=e}}]),i}(Yn),Xn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){return Object(Pe["a"])(this,i),e.call(this,t,n,o,"ne-resize")}return Object(Fe["a"])(i,[{key:"updateTransformFeedback",value:function(t,e,i){t.height-=i,t.width+=e,t.y+=i*Math.cos(t.rotation),t.x-=i*Math.sin(t.rotation)}}]),i}(Yn),$n=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){return Object(Pe["a"])(this,i),e.call(this,t,n,o,"sw-resize")}return Object(Fe["a"])(i,[{key:"updateTransformFeedback",value:function(t,e,i){t.height+=i,t.width-=e,t.x+=e*Math.cos(t.rotation),t.y+=e*Math.sin(t.rotation)}}]),i}(Yn),Qn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){return Object(Pe["a"])(this,i),e.call(this,t,n,o,"nw-resize")}return Object(Fe["a"])(i,[{key:"updateTransformFeedback",value:function(t,e,i,n,o){t.height-=i,t.width-=e,t.y-=this.ly-o,t.x-=this.lx-n}}]),i}(Yn),Jn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o,r){return Object(Pe["a"])(this,i),e.call(this,t,n,o,r)}return Object(Fe["a"])(i,[{key:"defaultCursor",get:function(){return tn.CURSOR.add}},{key:"prepare",value:function(){this.fireSelectionChangeEvent([],"new")}},{key:"createShape",value:function(t,e){}},{key:"toolActived",value:function(t,e){this.fireSelectionChangeEvent([],"new"),this._newShape=this.createShape(t,e),this._newShape&&(this._newShape.alpha=.8,this.frontRoot.addChild(this._newShape))}},{key:"updateShapeBounds",value:function(t,e,i,n,o,r){var a=n-e,s=o-i;r.altKey?(t.width=2*a,t.height=2*s,t.x=this.sx,t.y=this.sy):(t.width=a,t.height=s,t.x=e+a/2,t.y=i+s/2)}},{key:"activeMove",value:function(t,e,i,n,o,r,a,s,c){if(this._newShape)return this.updateShapeBounds(this._newShape,i,n,o,r,c),this.frontRoot.refresh(),"Create ".concat(this._newShape.name," [x:").concat(i,",y:").concat(n,",w:").concat(o-i,",h:").concat(r-n,"]")}},{key:"toolDeactived",value:function(t,e){if(this._newShape&&this.mainRoot){var i=this._newShape.worldMatrix.clone();if(this.frontRoot.removeChild(this._newShape),this._newShape.alpha=1,this.frontRoot.refresh(),0==this._newShape.width||0==this._newShape.height)return this._newShape.dispose(),void(this._newShape=null);var n=this.mainRoot.worldMatrix.clone().invert(),o=n.multiply(i).decompose();return this._newShape.x=o.translation.x,this._newShape.y=o.translation.y,this._newShape.width=this._newShape.width*o.scale.x,this._newShape.height=this._newShape.height*o.scale.y,{figure:this._newShape,name:this.figureName}}}},{key:"figureName",get:function(){return"Shape"}},{key:"reset",value:function(){this._newShape=null,Object(Te["a"])(Object(Re["a"])(i.prototype),"reset",this).call(this)}}]),i}(kn),Zn=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rect";return Object(Pe["a"])(this,i),e.call(this,t,n,o,r)}return Object(Fe["a"])(i,[{key:"createShape",value:function(t,e){return new pn({name:"Rectangle"})}}]),i}(Jn),to=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ellipse";return Object(Pe["a"])(this,i),e.call(this,t,n,o,r)}return Object(Fe["a"])(i,[{key:"createShape",value:function(t,e){return new bn({name:"Ellipse"})}}]),i}(Jn),eo=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){return Object(Pe["a"])(this,i),e.call(this,t)}return Object(Fe["a"])(i,[{key:"_configPathPoints",value:function(t){for(var e=2*this.corners,i=0;i<e;i++)t.addPoint(new li);for(var n=this.corners,o=Ye.PI2/n,r=-Ye.HALF_PI,a=0,s=r+o/2,c=1,h=this.width/2,l=h*this.radius,u=this.height/2,d=u*this.radius,f=0,p=0,v=0,b=0,y=0;v<n;v++){var g=b+r,m=Math.cos(g)*h,k=Math.sin(g)*u,O=t.points[y+a];O.x=m+f,O.y=k+p,g=b+s,m=Math.cos(g)*l,k=Math.sin(g)*d;var j=t.points[y+c];j.x=m+f,j.y=k+p,b+=o,y+=2}}}]),i}(qi),io=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"star";return Object(Pe["a"])(this,i),e.call(this,t,n,o,r)}return Object(Fe["a"])(i,[{key:"createShape",value:function(){return new eo({name:"Star"})}}]),i}(Jn),no=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){return Object(Pe["a"])(this,i),e.call(this,t)}return Object(Fe["a"])(i,[{key:"_configPathPoints",value:function(t){for(var e=this.width/2,i=this.height/2,n=-Math.PI/2,o=2*Math.PI/this.sides,r=0,a=0,s=0;s<this.sides;s++){var c=Math.cos(n)*e+r,h=Math.sin(n)*i+a;t.addPoint(new li(c,h)),n+=o}}}]),i}(Ei),oo=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"polygon";return Object(Pe["a"])(this,i),e.call(this,t,n,o,r)}return Object(Fe["a"])(i,[{key:"createShape",value:function(t,e){return new no({name:"Polygon"})}}]),i}(Jn),ro=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;return Object(Pe["a"])(this,i),n=e.call(this,r),n.model=t,n.isOut=o,n.r=122,n.g=255,n.b=0,n.master,n._isfocus=!1,n}return Object(Fe["a"])(i,[{key:"focus",value:function(){this._isfocus=!0}},{key:"blur",value:function(){this._isfocus=!1}},{key:"dispose",value:function(){this.master=null,this.relate=null,Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this)}},{key:"update",value:function(t,e){this.x=t,this.y=e;var i=this.master.worldMatrix.clone().invert(),n=i.multiplyWithVertexDatas(t,e);this.isOut?(this.model.outX=n[0],this.model.outY=n[1]):(this.model.inX=n[0],this.model.inY=n[1])}},{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:left,top:top,right:right,bottom:bottom},e=Object(Te["a"])(Object(Re["a"])(i.prototype),"calculateLocalBounds",this).call(this,t);return e.left-=this.width,e.top-=this.height,e.right+=this.width,e.bottom+=this.height,e}},{key:"drawSelf",value:function(t){this._isfocus?(this.r=255,this.g=0,this.b=0):(this.r=122,this.g=255,this.b=0),Object(Te["a"])(Object(Re["a"])(i.prototype),"drawSelf",this).call(this,t)}}]),i}(bn),ao=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n){var o;return Object(Pe["a"])(this,i),o=e.call(this,n),o.model=t,o._linePaint=Ee.newPaint(),o._linePaint.setStyle(Ee.strokeStyle),o._linePaint.setColorComponents(0,0,255,1),o._linePaint.setAntiAlias(!1),o._isfocus=!1,o}return Object(Fe["a"])(i,[{key:"type",get:function(){if(this.model)return this.model.type},set:function(t){this.model&&this.model.type!=t&&(this.model.type=t)}},{key:"focus",value:function(){this._isfocus=!0}},{key:"blur",value:function(){this._isfocus=!1}},{key:"hideController",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inController&&(this.inController.visible=!0),this.outController&&(this.outController.visible=!0),this.inController&&t&&(this.inController.visible=!1),this.outController&&e&&(this.outController.visible=!1)}},{key:"showController",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inController&&(this.inController.visible=!1),this.outController&&(this.outController.visible=!1),this.inController&&t&&(this.inController.visible=!0),this.outController&&e&&(this.outController.visible=!0)}},{key:"initControllerPoints",value:function(){var t=this.master.worldMatrix;if(!this.inController&&this.model&&this.model.in){var e=this.x,i=this.y;if(this.model.in){e=this.model.inX,i=this.model.inY;var n=t.multiplyWithVertexDatas(e,i);e=n[0],i=n[1]}this.inController=new ro(this.model,!1,{x:e,y:i,width:this.width,height:this.height}),this.inController.master=this.master,this.inController.relate=this,this.parent.addChild(this.inController)}if(!this.outController&&this.model&&this.model.out){var o=this.x,r=this.y;if(this.model.out){o=this.model.outX,r=this.model.outY;var a=t.multiplyWithVertexDatas(o,r);o=a[0],r=a[1]}this.outController=new ro(this.model,!0,{x:o,y:r,width:this.width,height:this.height}),this.outController.master=this.master,this.outController.relate=this,this.parent.addChild(this.outController)}}},{key:"drawSelf",value:function(t){var e=0,n=0;if(this.inController&&this.inController.isVisible){var o=this.inController.x-this.x,r=this.inController.y-this.y;t.drawLine(e,n,o,r,this._linePaint)}if(this.outController&&this.outController.isVisible){var a=this.outController.x-this.x,s=this.outController.y-this.y;t.drawLine(e,n,a,s,this._linePaint)}this.br=255,this.bb=255,this.bg=255,this._isfocus?(this.r=255,this.g=0,this.b=0):(this.r=0,this.g=0,this.b=0),Object(Te["a"])(Object(Re["a"])(i.prototype),"drawSelf",this).call(this,t)}},{key:"dispose",value:function(){this.master=null,this.model&&this.model.dispose(),this._linePaint&&this.getTarget()._linePaint.delete(),this.inController&&(this.inController.parent.removeChild(this.inController),this.inController.dispose(),this.inController=null),this.outController&&(this.outController.parent.removeChild(this.outController),this.outController.dispose(),this.outController=null),Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this)}},{key:"update",value:function(t,e){this.x=t,this.y=e;var i=this.master.worldMatrix.clone().invert(),n=i.multiplyWithVertexDatas(t,e);this.model.x=n[0],this.model.y=n[1]}},{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:left,top:top,right:right,bottom:bottom},e=Object(Te["a"])(Object(Re["a"])(i.prototype),"calculateLocalBounds",this).call(this,t);return e.left-=this.width,e.top-=this.height,e.right+=this.width,e.bottom+=this.height,e}}]),i}(pn),so=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t){var n;return Object(Pe["a"])(this,i),n=e.call(this,t),n.vertexSize=null==t||null==t.vertexSize?7:t.vertexSize,n.vertexFigures=[],n}return Object(Fe["a"])(i,[{key:"deletePathModel",value:function(){Object(Te["a"])(Object(Re["a"])(i.prototype),"deletePathModel",this).call(this),this.vertexFigures.forEach((function(t){var e=t.parent;e&&e.removeChild(t),t.dispose()})),this.vertexFigures.length=0}},{key:"applyWorkingVisible",value:function(){this.hideAllVertex(),this.visible=!0,this.a=.2;var t=this.getLastPreVertexFigure();t&&(t.visible=!0,t.showController(!1,!0));var e=this.getLastVertexFigure();e&&(e.visible=!0,e.showController(!0,!0))}},{key:"applyRestingVisible",value:function(){this.showAllVertex(),this.hideAllVertexController(),this.visible=!0,this.a=0}},{key:"indexOfVertex",value:function(t){for(var e=0;e<this.vertexFigures.length;e++){var i=this.vertexFigures[e];if(t==i)return e}return-1}},{key:"hideAllVertex",value:function(){this.vertexFigures.forEach((function(t){return t.visible=!1}))}},{key:"showAllVertex",value:function(){this.vertexFigures.forEach((function(t){return t.visible=!0}))}},{key:"hideAllVertexController",value:function(){this.vertexFigures.forEach((function(t){t.hideController(!0,!0)}))}},{key:"getVertexFigure",value:function(t){return this.vertexFigures[t]}},{key:"getFirstVertexFigure",value:function(){return this.vertexFigures[0]}},{key:"getLastVertexFigure",value:function(){return this.vertexFigures[this.vertexFigures.length-1]}},{key:"getLastPreVertexFigure",value:function(){return this.vertexFigures[this.vertexFigures.length-2]}},{key:"getVertexFigureCount",value:function(){return this.vertexFigures.length}},{key:"addVertexFigure",value:function(t){if(this.parent&&t){var e=new ao(t,{width:this.vertexSize,height:this.vertexSize,r:0,g:0,b:0});e.master=this;var i=this.worldMatrix,n=i.multiplyWithVertexDatas(t.x,t.y);return e.x=n[0],e.y=n[1],this.parent.addChild(e),this.vertexFigures.push(e),e.initControllerPoints(),e}}},{key:"removeVertexFigure",value:function(t){if(this.parent)for(var e=0;e<this.vertexFigures.length;e++){var i=this.vertexFigures[e];if(i.model.equals(t))return this.vertexFigures.splice(e,1),this.parent.removeChild(i),i.dispose(),i}}},{key:"addPoint",value:function(t){return Object(Te["a"])(Object(Re["a"])(i.prototype),"addPoint",this).call(this,t),this.addVertexFigure(t)}},{key:"insertPoint",value:function(t,e){return Object(Te["a"])(Object(Re["a"])(i.prototype),"insertPoint",this).call(this,t,e),this.addVertexFigure(t)}},{key:"deletePoint",value:function(t){return Object(Te["a"])(Object(Re["a"])(i.prototype),"deletePoint",this).call(this,t),this.removeVertexFigure(t)}},{key:"deleteAt",value:function(t){var e=Object(Te["a"])(Object(Re["a"])(i.prototype),"deleteAt",this).call(this,t);return this.removeVertexFigure(e)}}]),i}(Bi),co=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pen";return Object(Pe["a"])(this,i),r=e.call(this,t,n,o,a),r.vertices=[],r.vertexSize=4,r}return Object(Fe["a"])(i,[{key:"updateCurrentSelections",value:function(t){Object(Te["a"])(Object(Re["a"])(i.prototype),"updateCurrentSelections",this).call(this,t),t&&t[t.length-1]instanceof Bi?null!=this.currentPath||t[t.length-1].close||(this.currentPath=t[t.length-1],this.createShadowPath(this.currentPath)):(this.currentPath=null,this.disposeCurrentShadow()),this.updateVertexShapeFeedback()}},{key:"updateVertexShapeFeedback",value:function(){var t=this;this._updateFeedbackid&&cancelAnimationFrame(this._updateFeedbackid),this.shadowPath&&(this.shadowPath.visible=!1),this._updateFeedbackid=requestAnimationFrame((function(){if(null!=t.shadowPath){var e=t.currentSelections[t.currentSelections.length-1];e.id==t.shadowPath.id&&e&&(t.shadowPath.visible=!0,Ge.applyPose(t.shadowPath,e.worldMatrix.decompose()),t.shadowPath.deletePathModel(),e.getPathModel().points.forEach((function(e){var i=e.clone();t.shadowPath.addPoint(i)})),t.shadowPath.applyRestingVisible(),t.frontRoot.refresh())}}))}},{key:"prepare",value:function(t){}},{key:"unUse",value:function(t){cancelAnimationFrame(this._updateFeedbackid),this._updateFeedbackid=null,this.disposeCurrentShadow(),this.currentPath=null}},{key:"createShadowPath",value:function(t){this.disposeCurrentShadow(),this.shadowPath=new so({x:t.x,y:t.y,a:0,borderWidth:1}),this.shadowPath.id=t.id,kn.setFeedbackColors(this.shadowPath),this.frontRoot.addChild(this.shadowPath),this.frontRoot.refresh()}},{key:"addNewPoint",value:function(t,e){if(null==this.currentPath){this.currentPath=new Bi({x:t,y:e}),this.currentPath.name="Path Shape",this.createShadowPath(this.currentPath);var i=this.currentPath.worldMatrix.clone().invert(),n=i.multiplyWithVertexDatas(t,e),o=new li(n[0],n[1]);this.currentPath.addPoint(o);var r=o.clone();return this.shadowPath.addPoint(r),this.currentAdded=this.currentPath,void this.frontRoot.refresh()}var a=this.currentPath.worldMatrix.clone().invert(),s=a.multiplyWithVertexDatas(t,e),c=new li(s[0],s[1]);this.shadowPath.addPoint(c),this.currentAdded=c,this.shadowPath.applyWorkingVisible(),this.frontRoot.refresh()}},{key:"toolActived",value:function(t,e){Object(Te["a"])(Object(Re["a"])(i.prototype),"toolActived",this).call(this,t,e),this.completeType=null;var n=this.frontRoot.findFigure(t,e);if(n=n==this.frontRoot||n==this.shadowPath?null:n,n){if(this.updateHoverFigure(),!this.shadowPath)return;var o=this.shadowPath.indexOfVertex(n);if(-1!=o&&o!=this.shadowPath.getPathModel().length-1)return this.completeType="minus",this.minusIndex=o,void(0==o&&(this.completeType="close"))}else this.completeType="add",this.addNewPoint(t,e)}},{key:"toolDeactived",value:function(t,e){var n;if(Object(Te["a"])(Object(Re["a"])(i.prototype),"toolDeactived",this).call(this,t,e),"add"==this.completeType){if(this.currentAdded instanceof Bi){var o=this.currentAdded.getPathModel(),r=this.shadowPath.getPathModel(),a=o.getPoint(0);a.copyFrom(r.getPoint(0));var s=this.currentAdded.worldMatrix,c=this.mainRoot.worldMatrix.clone().invert(),h=c.multiply(s).decompose().translation,l=this.currentAdded;this.currentAdded=null,l.x=h.x,l.y=h.y,n={type:"add",figure:l,point:a}}if(this.currentAdded instanceof li){var u=this.currentAdded.clone();this.currentAdded=null,n={type:"add",point:u,path:this.currentPath,index:this.currentPath.pointsCount}}}if("close"==this.completeType){this.disposeCurrentShadow();var d=this.getSelectionById(this.currentPath.id);this.currentPath=null,n={type:this.completeType,path:d}}if("minus"==this.completeType){var f=this.getSelectionById(this.currentPath.id);n={type:this.completeType,index:this.minusIndex,path:f}}return this.shadowPath&&this.shadowPath.applyRestingVisible(),this.frontRoot.refresh(),n}},{key:"getSelectionById",value:function(t){if(this.currentSelections)for(var e=0;e<this.currentSelections.length;e++){var i=this.currentSelections[e];if(i.id==t)return i}}},{key:"disposeCurrentShadow",value:function(){null!=this.shadowPath&&(this.frontRoot.removeChild(this.shadowPath),this.shadowPath.dispose(),this.shadowPath=null,this.frontRoot.refresh())}},{key:"hoverMove",value:function(t,e){var i=this.frontRoot.findFigure(t,e);i==this._lastHover&&null!=i||(i=i instanceof ao?i:null,this.updateHoverFigure(i))}},{key:"updateHoverFigure",value:function(t){this._lastHover!=t&&(this._lastHover&&this._lastHover.blur(),this._lastHover=t,this._lastHover&&this._lastHover.focus(),this.frontRoot.refresh())}},{key:"activeMove",value:function(t,e,n,o,r,a,s,c){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"activeMove",this).call(this,t,e,n,o,r,a,s,c),"add"==this.completeType){var h=this.shadowPath.getLastVertexFigure();if(h){h.outController&&h.inController||(h.type=1,h.model.inX=h.model.x,h.model.inY=h.model.y,h.model.outX=h.model.x,h.model.outY=h.model.y,h.initControllerPoints());var l=h.outController;l.update(l.x+s,l.y+c);var u=h.inController;u.update(u.x-s,u.y-c),this.frontRoot.refresh()}}}},{key:"reset",value:function(){Object(Te["a"])(Object(Re["a"])(i.prototype),"reset",this).call(this),cancelAnimationFrame(this._updateFeedbackid),this._updateFeedbackid=null,this.completeType=null,this.minusIndex=-1}}]),i}(kn),ho=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vertex-select";return Object(Pe["a"])(this,i),e.call(this,t,n,o,r)}return Object(Fe["a"])(i,[{key:"unUse",value:function(){if(this.stopUpdate(),this.disposeShadowPath(),this.deleteLastHover(),this.currentSelections&&this.currentSelections[0]instanceof li){var t=this.currentSelections[0],e=t.parent;while(1){if(null==e||e instanceof Vi)break;e=e.parent}e?this.fireSelectionChangeEvent([e]):this.fireSelectionChangeEvent([])}this.frontRoot.refresh()}},{key:"shadowPath",get:function(){return null==this._shadowPath&&(this._shadowPath=new so({a:0,borderWidth:1}),kn.setFeedbackColors(this._shadowPath),this.frontRoot.addChild(this._shadowPath)),this._shadowPath}},{key:"updateShadowPath",value:function(t){this.shadowPath=null,t&&(t instanceof ro&&(t=t.parent),t instanceof ao&&(this.shadowPath=t.master))}},{key:"disposeShadowPath",value:function(){this._shadowPath&&(this.frontRoot.removeChild(this._shadowPath),this._shadowPath.parent=null,this._shadowPath.dispose(),this._shadowPath.relatedPath=null,this._shadowPath=null,this._selectedVertex=null,this._selectedVertexType=null)}},{key:"updateVertexShapeFeedback",value:function(t){var e=this;if(t){this.shadowPath.id=t.id,this.shadowPath.visible=!0,this.shadowPath.close=t.close,this.shadowPath.relatedPath=t,this.shadowPath.deletePathModel();var i=t.worldMatrix.decompose();Ge.applyPose(this.shadowPath,i),t.getPathModel().points.forEach((function(t){var i=t.clone();e.shadowPath.addPoint(i)})),this.shadowPath.applyRestingVisible(),this.frontRoot.refresh()}}},{key:"updateCurrentSelections",value:function(t){var e=this;Object(Te["a"])(Object(Re["a"])(i.prototype),"updateCurrentSelections",this).call(this,t),this.shadowPath&&(this.shadowPath.visible=!1),this._updateId&&cancelAnimationFrame(this._updateId),this._updateId=requestAnimationFrame((function(){if(e.currentSelections&&1==e.currentSelections.length){var t=e.currentSelections[0];if(t instanceof Bi&&(e.updateVertexShapeFeedback(t),e._selectedVertex&&e._selectedVertex.blur(),e._selectedVertex=null,e._selectedVertexType=null),t instanceof li){if(null==t.parent)return void(e.shadowPath&&e.fireSelectionChangeEvent([e.shadowPath.relatedPath]));var i=e.shadowPath.relatedPath;e.updateVertexShapeFeedback(i);var n=i.getPathModel(),o=n.points.indexOf(t),r=e.shadowPath.getVertexFigure(o);e._lastVertexHover&&e._lastVertexHover.blur(),e._lastVertexHover==r&&(e._lastVertexHover=null),e._selectedVertex&&e._selectedVertex.blur(),e._selectedVertex=r,e._selectedVertex.focus(),e.focusVertex(e._selectedVertex)}}else e.disposeShadowPath(),e.deleteLastHover(),e.frontRoot.refresh()}))}},{key:"findRealModel",value:function(t){t instanceof ro&&(t=t.relate);var e=this.shadowPath.indexOfVertex(t),i=this.mainRoot.getFigureById(this.shadowPath.id);return i.getPathModel().getPoint(e)}},{key:"toolActived",value:function(t,e,n){Object(Te["a"])(Object(Re["a"])(i.prototype),"toolActived",this).call(this,t,e,n),this.actionType=null;var o=this.frontRoot.findFigure(t,e);if(o=o==this.frontRoot?null:o,o instanceof ao||o instanceof ro){var r=this.findRealModel(o),a=this.currentSelections[0],s=!r.equals(a);if(o instanceof ao&&(this.focusVertex(o),this.actionType="changevertex"),o instanceof ro&&(this.actionType="changevertexcontroller"),s&&this.fireSelectionChangeEvent([r]),"changevertex"==this.actionType&&(this._selectedVertexType="v"),"changevertexcontroller"==this.actionType){var c=o==o.relate.inController;this._selectedVertexType=c?"in":"out"}}else{if(o=this.mainRoot.findFigure(t,e),o=o==this.mainRoot?null:o,o instanceof Bi)return this._shadowPath&&this.shadowPath.id==o.id&&!this._selectedVertex||this.fireSelectionChangeEvent([o]),void(this.actionType="move");this.fireSelectionChangeEvent([])}}},{key:"focusVertex",value:function(t){if(t){this.shadowPath.applyRestingVisible(),this.shadowPath.a=.2,t.showController(!0,!0);var e=this.shadowPath.indexOfVertex(t),i=this.shadowPath.getVertexFigure(e+1);i&&i.showController(!0,!1);var n=this.shadowPath.getVertexFigure(e-1);n&&n.showController(!1,!0),this.frontRoot.refresh()}}},{key:"stopUpdate",value:function(){this._updateId&&cancelAnimationFrame(this._updateId),this._updateId=null}},{key:"toolDeactived",value:function(t,e){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"toolDeactived",this).call(this,t,e),this.stopUpdate(),null!=this.actionType&&(this.ex-this.sx!=0||this.ey-this.sy!=0)){if("move"==this.actionType){var n=this.currentSelections[0];if(n&&n instanceof Bi){var o=n.parent.worldMatrix.clone().invert(),r=o.multiplyWithVertexDatas(this.sx,this.sy),a=o.multiplyWithVertexDatas(this.ex,this.ey),s=a[0]-r[0],c=a[1]-r[1];return{type:"move",figures:[n],dx:s,dy:c}}}if("changevertex"==this.actionType||"changevertexcontroller"==this.actionType){var h=this.currentSelections[0];if(h&&h instanceof li&&this._selectedVertex)return{type:"vertex",vertex:h,copy:this._selectedVertex.model.clone()}}}}},{key:"updateVertexHover",value:function(t){this._lastVertexHover!=t&&(null!=this._lastVertexHover&&this._lastVertexHover.blur(),this._lastVertexHover=t,this._lastVertexHover&&this._lastVertexHover.focus(),this.frontRoot.refresh())}},{key:"hoverMove",value:function(t,e){Object(Te["a"])(Object(Re["a"])(i.prototype),"hoverMove",this).call(this,t,e);var n=this.frontRoot.findFigure(t,e);if(n=n==this.frontRoot?null:n,n instanceof ao||n instanceof ro)return this.updateHoverFigure(),this.updateVertexHover(n),void(this._selectedVertex&&this._selectedVertex.focus());var o=this.mainRoot.findFigure(t,e);o=o==this.mainRoot?null:o,(o instanceof Bi||!o)&&(this.updateVertexHover(),this.updateHoverFigure(o)),this._selectedVertex&&this._selectedVertex.focus()}},{key:"deleteLastHover",value:function(){this.lastHoverFigure&&(this.frontRoot.removeChild(this.lastHoverFigure),this.lastHoverFigure.parent=null,this.lastHoverFigure.dispose(),this.lastHoverFigure.relatedSelection=null,this.lastHoverFigure=null)}},{key:"updateHoverFigure",value:function(t){if(t){if(this.lastHoverFigure&&this.lastHoverFigure.relatedSelection.id==t.id)return;this.deleteLastHover(),this.lastHoverFigure=kn.createDelegateFigure(t),this._shadowPath?this.frontRoot.insertChild(this.lastHoverFigure,this.frontRoot.indexOfChild(this._shadowPath)):this.frontRoot.addChild(this.lastHoverFigure)}else this.deleteLastHover();this.frontRoot.refresh()}},{key:"activeMove",value:function(t,e,n,o,r,a,s,c){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"activeMove",this).call(this,t,e,n,o,r,a,s,c),"move"==this.actionType){if(!this.lastHoverFigure){var h=this.currentSelections[0];h&&h instanceof Bi&&(this.lastHoverFigure=kn.createDelegateFigure(h),this.frontRoot.addChild(this.lastHoverFigure))}this.lastHoverFigure&&(this.lastHoverFigure.x+=s,this.lastHoverFigure.y+=c)}if("changevertex"==this.actionType&&this._selectedVertex){this._selectedVertex.update(this._selectedVertex.x+s,this._selectedVertex.y+c);var l=this._selectedVertex.inController;l&&l.update(l.x+s,l.y+c);var u=this._selectedVertex.outController;u&&u.update(u.x+s,u.y+c)}if("changevertexcontroller"==this.actionType){var d=this._selectedVertex.inController,f=this._selectedVertex.outController;if("out"==this._selectedVertexType){var p=d;d=f,f=p}d&&d.update(d.x+s,d.y+c),1==this._selectedVertex.type&&f&&f.update(f.x-s,f.y-c)}this.frontRoot.refresh()}},{key:"getAnotherController",value:function(t){var e=t.parent;if(e instanceof ao){if(t==e.inController)return e.outController;if(t==e.outController)return e.inController}}},{key:"reset",value:function(){this.stopUpdate(),this.deleteLastHover(),Object(Te["a"])(Object(Re["a"])(i.prototype),"reset",this).call(this)}}]),i}(kn),lo=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){return Object(Pe["a"])(this,i),e.call(this,t,n,o,"move-root")}return Object(Fe["a"])(i,[{key:"activeMove",value:function(t,e,i,n,o,r,a,s){this.mainRoot&&(this.mainRoot.x+=a/this.mainRoot.scalex,this.mainRoot.y+=s/this.mainRoot.scaley,this.mainRoot.refresh())}}]),i}(kn),uo=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o){return Object(Pe["a"])(this,i),e.call(this,t,n,o,"line")}return Object(Fe["a"])(i,[{key:"deleteLine",value:function(){this.line&&(this.line.parent.removeChild(this.line),this.line.dispose(),this.line.parent=null,this.line=null)}},{key:"createLine",value:function(){return this.deleteLine(),this.line||(this.line=new en,this.frontRoot.addChild(this.line)),this.line}},{key:"toolActived",value:function(t,e,n){Object(Te["a"])(Object(Re["a"])(i.prototype),"toolActived",this).call(this,t,e,n);var o=this.createLine();o.x=t,o.y=e,o.endX=t,o.endY=e}},{key:"activeMove",value:function(t,e,n,o,r,a,s,c,h){Object(Te["a"])(Object(Re["a"])(i.prototype),"activeMove",this).call(this,t,e,n,o,r,a,s,c,h),this.line.endX+=s,this.line.endY+=c,this.frontRoot.refresh()}},{key:"toolDeactived",value:function(t,e,n){if(Object(Te["a"])(Object(Re["a"])(i.prototype),"toolDeactived",this).call(this,t,e,n),this.line&&this.mainRoot){var o=[this.line.x,this.line.y],r=[this.line.endX,this.line.endY],a=this.mainRoot.worldMatrix.clone().invert();if(o=a.multiplyWithVertexDatas(o[0],o[1]),r=a.multiplyWithVertexDatas(r[0],r[1]),this.deleteLine(),this.frontRoot.refresh(),this.ex-this.sx!=0||this.ey-this.sy!=0)return{figure:new en({x:o[0],y:o[1],endX:r[0],endY:r[1]}),name:"Line"}}}},{key:"reset",value:function(){this.deleteLine(),Object(Te["a"])(Object(Re["a"])(i.prototype),"reset",this).call(this)}},{key:"unUse",value:function(){this.deleteLine(),Object(Te["a"])(Object(Re["a"])(i.prototype),"unUse",this).call(this)}}]),i}(kn),fo={class:"canvas-action-bar graybg"},po={class:"action-bar-main"},vo={class:"action-container"},bo=Object(n["h"])("i",{class:"iconfont icon-trash"},null,-1),yo=Object(n["h"])("div",{class:"action-container"},[Object(n["h"])("div",{class:"action-spliter"})],-1),go={class:"action-container"},mo=Object(n["h"])("i",{class:"iconfont icon-undo"},null,-1),ko={class:"action-container"},Oo=Object(n["h"])("i",{class:"iconfont icon-redo"},null,-1),jo=Object(n["h"])("div",{class:"action-container"},[Object(n["h"])("div",{class:"action-spliter"})],-1),wo={class:"action-container"},xo=Object(n["h"])("i",{class:"iconfont icon-group"},null,-1),Co={class:"action-container"},_o=Object(n["h"])("i",{class:"iconfont icon-ungroup"},null,-1),So=Object(n["h"])("div",{class:"action-container"},[Object(n["h"])("div",{class:"action-spliter"})],-1),Po={class:"action-container"},Fo=Object(n["h"])("i",{class:"iconfont icon-mask-clip larger-action-icon"},null,-1),Ao=Object(n["h"])("i",{class:"iconfont icon-mask-unclip larger-action-icon"},null,-1),To=Object(n["h"])("div",{class:"action-container"},[Object(n["h"])("div",{class:"action-spliter"})],-1),Ro={class:"action-container"},Mo=Object(n["h"])("i",{class:"iconfont icon-bring-front larger-action-icon"},null,-1),Do=Object(n["h"])("i",{class:"iconfont icon-send-back larger-action-icon"},null,-1),Vo=Object(n["h"])("div",{class:"action-container"},[Object(n["h"])("div",{class:"action-spliter"})],-1),Bo={class:"action-container"},Eo=Object(n["h"])("i",{class:"iconfont icon-align-left more-larger-action-icon"},null,-1),qo=Object(n["h"])("i",{class:"iconfont icon-align-center more-larger-action-icon"},null,-1),Io=Object(n["h"])("i",{class:"iconfont icon-align-right more-larger-action-icon"},null,-1),zo=Object(n["h"])("i",{class:"iconfont icon-align-top more-larger-action-icon"},null,-1),Ho=Object(n["h"])("i",{class:"iconfont icon-align-v-center more-larger-action-icon"},null,-1),No=Object(n["h"])("i",{class:"iconfont icon-align-bottom more-larger-action-icon"},null,-1),Lo=Object(n["h"])("div",{class:"action-container"},[Object(n["h"])("div",{class:"action-spliter"})],-1),Go={class:"action-container"},Uo=Object(n["h"])("i",{class:"iconfont icon-distribute-left more-larger-action-icon"},null,-1),Wo=Object(n["h"])("i",{class:"iconfont icon-distribute-center more-larger-action-icon"},null,-1),Yo=Object(n["h"])("i",{class:"iconfont icon-distribute-right more-larger-action-icon"},null,-1),Ko=Object(n["h"])("i",{class:"iconfont icon-distribute-top more-larger-action-icon"},null,-1),Xo=Object(n["h"])("i",{class:"iconfont icon-distribute-v-center more-larger-action-icon"},null,-1),$o=Object(n["h"])("i",{class:"iconfont icon-distribute-bottom more-larger-action-icon"},null,-1),Qo={class:"action-bar-other"};function Jo(t,e,i,o,r,a){return Object(n["q"])(),Object(n["d"])("div",fo,[Object(n["h"])("div",po,[Object(n["h"])("div",vo,[Object(n["h"])("button",{type:"button",class:["btn btn-primary action-button",a.hasSelection?"":"disabled"],onClick:e[1]||(e[1]=function(){return a.deleteSelections&&a.deleteSelections.apply(a,arguments)})},[bo],2)]),yo,Object(n["h"])("div",go,[Object(n["h"])("button",{onClick:e[2]||(e[2]=function(){return a.undo&&a.undo.apply(a,arguments)}),type:"button",class:["btn btn-primary action-button",a.canUndo?"":"disabled"]},[mo],2)]),Object(n["h"])("div",ko,[Object(n["h"])("button",{onClick:e[3]||(e[3]=function(){return a.redo&&a.redo.apply(a,arguments)}),type:"button",class:["btn btn-primary action-button",a.canRedo?"":"disabled"]},[Oo],2)]),jo,Object(n["h"])("div",wo,[Object(n["h"])("button",{onClick:e[4]||(e[4]=function(){return a.groupFigures&&a.groupFigures.apply(a,arguments)}),type:"button",class:["btn btn-primary action-button",a.canGroup?"":"disabled"]},[xo],2)]),Object(n["h"])("div",Co,[Object(n["h"])("button",{onClick:e[5]||(e[5]=function(){return a.unGroup&&a.unGroup.apply(a,arguments)}),type:"button",class:["btn btn-primary action-button",a.canUnGroup?"":"disabled"]},[_o],2)]),So,Object(n["h"])("div",Po,[Object(n["h"])("button",{onClick:e[6]||(e[6]=function(){return a.clip&&a.clip.apply(a,arguments)}),type:"button",class:["btn btn-primary action-button",a.canClip?"":"disabled"]},[Fo],2),Object(n["h"])("button",{onClick:e[7]||(e[7]=function(){return a.unClip&&a.unClip.apply(a,arguments)}),type:"button",class:["btn btn-primary action-button",a.canUnClip?"":"disabled"]},[Ao],2)]),To,Object(n["h"])("div",Ro,[Object(n["h"])("button",{onClick:e[8]||(e[8]=function(){return t.bringFront&&t.bringFront.apply(t,arguments)}),type:"button",class:["btn btn-primary action-button",t.canBringFront?"":"disabled"]},[Mo],2),Object(n["h"])("button",{onClick:e[9]||(e[9]=function(){return t.sendBack&&t.sendBack.apply(t,arguments)}),type:"button",class:["btn btn-primary action-button",t.canSendBack?"":"disabled"]},[Do],2)]),Vo,Object(n["h"])("div",Bo,[Object(n["h"])("button",{onClick:e[10]||(e[10]=function(){return t.alignLeft&&t.alignLeft.apply(t,arguments)}),type:"button",class:["btn btn-primary action-button",t.canAlign?"":"disabled"]},[Eo],2),Object(n["h"])("button",{onClick:e[11]||(e[11]=function(e){return t.alignCenter(!0,"Align Center")}),type:"button",class:["btn btn-primary action-button",t.canAlign?"":"disabled"]},[qo],2),Object(n["h"])("button",{onClick:e[12]||(e[12]=function(){return t.alignRight&&t.alignRight.apply(t,arguments)}),type:"button",class:["btn btn-primary action-button",t.canAlign?"":"disabled"]},[Io],2),Object(n["h"])("button",{onClick:e[13]||(e[13]=function(){return t.alignTop&&t.alignTop.apply(t,arguments)}),type:"button",class:["btn btn-primary action-button",t.canAlign?"":"disabled"]},[zo],2),Object(n["h"])("button",{onClick:e[14]||(e[14]=function(e){return t.alignCenter(!1,"Align V-Center")}),type:"button",class:["btn btn-primary action-button",t.canAlign?"":"disabled"]},[Ho],2),Object(n["h"])("button",{onClick:e[15]||(e[15]=function(){return t.alignBottom&&t.alignBottom.apply(t,arguments)}),type:"button",class:["btn btn-primary action-button",t.canAlign?"":"disabled"]},[No],2)]),Lo,Object(n["h"])("div",Go,[Object(n["h"])("button",{onClick:e[16]||(e[16]=function(e){return t.distribute("left",!0)}),type:"button",class:["btn btn-primary action-button",t.canDistribute?"":"disabled"]},[Uo],2),Object(n["h"])("button",{onClick:e[17]||(e[17]=function(e){return t.distribute("center",!0)}),type:"button",class:["btn btn-primary action-button",t.canDistribute?"":"disabled"]},[Wo],2),Object(n["h"])("button",{onClick:e[18]||(e[18]=function(e){return t.distribute("right",!0)}),type:"button",class:["btn btn-primary action-button",t.canDistribute?"":"disabled"]},[Yo],2),Object(n["h"])("button",{onClick:e[19]||(e[19]=function(e){return t.distribute("top",!1)}),type:"button",class:["btn btn-primary action-button",t.canDistribute?"":"disabled"]},[Ko],2),Object(n["h"])("button",{onClick:e[20]||(e[20]=function(e){return t.distribute("center",!1)}),type:"button",class:["btn btn-primary action-button",t.canDistribute?"":"disabled"]},[Xo],2),Object(n["h"])("button",{onClick:e[21]||(e[21]=function(e){return t.distribute("bottom",!1)}),type:"button",class:["btn btn-primary action-button",t.canDistribute?"":"disabled"]},[$o],2)])]),Object(n["h"])("div",Qo,[Object(n["E"])(Object(n["h"])("input",{class:"form-control form-control-sm property-input","onUpdate:modelValue":e[22]||(e[22]=function(t){return a.mainScale=t}),onClick:e[23]||(e[23]=function(){return t.selectText&&t.selectText.apply(t,arguments)}),onKeypress:e[24]||(e[24]=Object(n["F"])((function(){return t.confirm&&t.confirm.apply(t,arguments)}),["enter"])),style:{width:"6em","text-align":"center"}},null,544),[[n["C"],a.hasRootFigure],[n["B"],a.mainScale,void 0,{lazy:!0}]])])])}var Zo={methods:{bringFront:function(){if(this.selections){var t=this.selections[0],e=this.rootFigure.indexOfChild(t);e+=1;var i=Vn.newChangeIndexAction(t,e);this.actionStack.excute(i)}},sendBack:function(){if(this.selections){var t=this.selections[0],e=this.rootFigure.indexOfChild(t);e-=1;var i=Vn.newChangeIndexAction(t,e);this.actionStack.excute(i)}}},computed:{canBringFront:function(){if(this.selections&&1==this.selections.length){var t=this.selections[0];if(t instanceof ai&&this.rootFigure.children[this.rootFigure.children.length-1]!=t)return!0}return!1},canSendBack:function(){if(this.selections&&1==this.selections.length){var t=this.selections[0];if(t instanceof ai&&this.rootFigure.children[0]!=t)return!0}return!1}}},tr={computed:{canAlign:function(){return this.actionStack&&this.selections&&this.selections.length>1}},methods:{alignCenter:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"align",n=tn.calculateFiguresBounds(this.selections),o=n.left+(n.right-n.left)/2,r=n.top+(n.bottom-n.top)/2,a=new Pn(i);this.selections.forEach((function(i){var n,s=i.worldBounds,c=s.left+(s.right-s.left)/2,h=s.top+(s.bottom-s.top)/2,l=o-c,u=r-h;n=e?Vn.newTranslateAction([i],l/t.rootFigure.scalex,0):Vn.newTranslateAction([i],0,u/t.rootFigure.scaley),a.add(n)})),this.actionStack.excute(a)},alignLeft:function(){this.align("left","Align Left",!0,!0)},alignRight:function(){this.align("right","Align right",!1,!0)},alignTop:function(){this.align("top","Align top",!0,!1)},alignBottom:function(){this.align("bottom","Align bottom",!1,!1)},align:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"align",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=this.selections[0].worldBounds[t],a={};this.selections.forEach((function(e){var i=a[e.id];null==i&&(a[e.id]=e.worldBounds,i=a[e.id]),r=n?Math.min(r,i[t]):Math.max(r,i[t])}));var s=new Pn(i);for(var c in this.selections.forEach((function(i){var n,c=a[i.id],h=r-c[t];n=o?Vn.newTranslateAction([i],h/e.rootFigure.scalex,0):Vn.newTranslateAction([i],0,h/e.rootFigure.scaley),s.add(n)})),a)delete a[c];a=null,this.actionStack.excute(s)}}},er=(i("d81d"),{computed:{canDistribute:function(){return this.actionStack&&this.selections&&this.selections.length>2}},methods:{distribute:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"left",e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.selections.map((function(t){return t})),n=new Pn;function o(t,e,i){return"center"==t?e?i.left+(i.right-i.left)/2:i.top+(i.bottom-i.top)/2:i[t]}i.sort((function(i,n){var r=i.worldBounds,a=n.worldBounds;return o(t,e,r)-o(t,e,a)}));for(var r=i[0],a=i[i.length-1],s=r.worldBounds,c=a.worldBounds,h=o(t,e,s),l=o(t,e,c),u=l-h,d=u/(i.length-1),f=h+d,p=1;p<i.length-1;p++){var v=i[p],b=v.worldBounds,y=o(t,e,b),g=f-y;e?n.add(Vn.newTranslateAction([v],g/this.rootFigure.scalex,0)):n.add(Vn.newTranslateAction([v],0,g/this.rootFigure.scaley)),f+=d}this.actionStack.excute(n)},distributeLeft:function(){this.distribute("left",!0)}}}),ir={name:"ActionBar",mixins:[Se,Zo,tr,er],emits:["canvas:refresh","canvas:group","canvas:ungroup","canvas:clip","canvas:unclip"],computed:{hasRootFigure:function(){var t=null!=this.rootFigure;return t},mainScale:{get:function(){if(this.rootFigure){var t=this.rootFigure.zoom,e=(100*t).toFixed(2)+"%";return e}},set:function(t){if(this.rootFigure){var e=Number.parseFloat(t);if(isNaN(e))return;this.rootFigure.zoom=e/100,this.rootFigure.placeAtCenter(),this.rootFigure.refresh()}}},canRedo:function(){if(this.actionStack)return this.actionStack.canRedo()},canUndo:function(){if(this.actionStack)return this.actionStack.canUndo()},hasSelection:function(){if(this.selections)return this.selections.length>0},canGroup:function(){return!!this.selections&&this.selections.length>1},canUnGroup:function(){if(!this.selections)return!1;if(0==this.selections.length)return!1;for(var t=0;t<this.selections.length;t++){var e=this.selections[t];if(!(e instanceof hi))return!1}return!0},clipMask:function(){if(this.selections&&this.selections.length>1){for(var t,e=-1,i=0;i<this.selections.length;i++){var n=this.selections[i],o=n.parent;if(o){var r=o.indexOfChild(n);r>e&&(e=r,t=n)}}if(t instanceof si)return t}},canClip:function(){return null!=this.clipMask},canUnClip:function(){if(this.selections)for(var t=0;t<this.selections.length;t++){var e=this.selections[t];if(e.clip&&e.children.length>=1)return!0}return!1}},methods:{clip:function(){var t=this.clipMask,e=[];this.selections.forEach((function(i){t!=i&&e.push(i)})),e.sort((function(t,e){var i=t.parent,n=i.indexOfChild(t);i=e.parent;var o=i.indexOfChild(e);return n-o})),this.$emit("canvas:clip",{mask:t,figures:e})},unClip:function(){if(this.canUnClip){var t=[];this.selections.forEach((function(e){e.clip&&e.children.length>=1&&t.push(e)})),this.$emit("canvas:unclip",t)}},unGroup:function(){this.canUnGroup&&this.$emit("canvas:ungroup",this.selections)},groupFigures:function(t){this.canGroup&&this.$emit("canvas:group",this.selections)},deleteSelections:function(t){if(this.hasSelection&&this.actionStack){var e=new Pn;this.selections.forEach((function(t){if(t instanceof ai){var i=new Mn(t,t.parent);e.add(i)}if(t instanceof li){var n=t.parent;while(1){if(null==n||n instanceof Vi)break;n=n.parent}if(n){var o=n.getPathModel().points.indexOf(t);if(-1!=o){var r=new Vn.newDeletePointAction(n,o);e.add(r)}}}})),this.actionStack.excute(e)}},undo:function(){this.canUndo&&this.actionStack.undo()},redo:function(){this.canRedo&&this.actionStack.redo()},triggerCanvasRefresh:function(){this.$emit("canvas:refresh")}},props:{actionStack:null,selections:null,rootFigure:null}};i("f693");ir.render=Jo;var nr=ir,or=16382,rr=function(t){Object(Me["a"])(i,t);var e=Object(De["a"])(i);function i(t,n,o,r){var a;return Object(Pe["a"])(this,i),a=e.call(this,t,r),a.screanWidth=n,a.screanHeight=o,a.zoom=null==r.zoom?1:r.zoom,a.padding=50,a}return Object(Fe["a"])(i,[{key:"init",value:function(){var t=this.screanWidth,e=this.screanHeight,i=this.width+2*this.padding,n=this.height+2*this.padding,o=i>t?t/i:1,r=n>e?e/n:1,a=Math.min(r,o);if(a<1)a=Math.max(a,.25),this.zoom=a;else{var s=.5*t+2*this.padding,c=.5*e+2*this.padding;r=n<c?c/this.width:1,o=i<s?s/this.height:1;var h=Math.min(r,o);h=Math.min(h,5),this.zoom=h}this.placeAtCenter()}},{key:"placeAtCenter",value:function(){var t=this.screanWidth,e=this.screanHeight,i=this.width*this.zoom,n=this.height*this.zoom,o=(t-i)/2,r=(e-n)/2;this.x=o,this.y=r}},{key:"zoom",get:function(){return this._zoom},set:function(t){this._zoom=t,this.scalex=t,this.scaley=t}},{key:"configPath",value:function(t){t.addRect(Ee.newXYWHRect(0,0,this.width,this.height))}},{key:"calculateLocalBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,top:0,right:0,bottom:0};return t.left=-(or-this.width)/2,t.top=-(or-this.height)/2,t.right=t.left+or,t.bottom=t.top+or,t}},{key:"getDocPath",value:function(){return null==this._path&&(this._path=Ee.newPath(),this.configPath(this._path)),this._path}},{key:"getPaint",value:function(){return null==this._paint&&(this._paint=Ee.newPaint()),this._paint}},{key:"drawSelf",value:function(t){Object(Te["a"])(Object(Re["a"])(i.prototype),"drawSelf",this).call(this,t);var e=this.getDocPath(),n=this.getPaint();n.setColorComponents(1,1,1,1),n.setStyle(Ee.fillStyle),t.drawPath(e,n),n.setColorComponents(0,0,0,1),n.setStyle(Ee.strokeStyle),t.drawPath(e,n)}},{key:"deletePath",value:function(){this._path&&(this.getTarget()._path.delete(),this._path=null)}},{key:"dispose",value:function(){if(!this.isDisposed){this.deletePath();var t=this.getTarget()._paint;t&&t.delete(),this._paint=null,Object(Te["a"])(Object(Re["a"])(i.prototype),"dispose",this).call(this)}}}]),i}(dn),ar={methods:{keydown:function(t){var e=this;"Delete"==t.code&&(this._deleteAction&&cancelAnimationFrame(this._deleteAction),this._deleteAction=requestAnimationFrame((function(){e.deleteActionFired()}))),"Space"==t.code&&(this.spacePressed=!0)},keyup:function(t){"Space"==t.code&&(this.spacePressed=!1)},keypress:function(t){var e=this;this._keyPressId&&cancelAnimationFrame(this._keyPressId),this._keyPressId=requestAnimationFrame((function(){if("KeyZ"==t.code){if(t.ctrlKey&&!t.shiftKey)return void e.undoActionFired();if(t.ctrlKey&&t.shiftKey)return void e.redoActionFired()}if("KeyV"==t.code&&(e.currentTool="select"),"KeyA"==t.code&&(e.currentTool="vertex-select"),"KeyW"==t.code&&(e.currentTool="pen"),"KeyG"==t.code){if(t.ctrlKey&&!t.shiftKey)return void e.groupActionFired();if(t.ctrlKey&&t.shiftKey)return void e.ungroupActionFired()}}))},groupActionFired:function(){var t=this.$refs["actionBar"];t&&t.groupFigures()},ungroupActionFired:function(){var t=this.$refs["actionBar"];t&&t.unGroup()},deleteActionFired:function(){var t=this.$refs["actionBar"];t&&t.deleteSelections()},redoActionFired:function(){var t=this.$refs["actionBar"];t&&t.redo()},undoActionFired:function(){var t=this.$refs["actionBar"];t&&t.undo()}},mounted:function(){window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),window.addEventListener("keypress",this.keypress)},data:function(){return{spacePressed:!1}}},sr={computed:{},methods:{unGroupFigures:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentSelections;if(this.mainRoot){var i=new Pn;e.forEach((function(e){if(e instanceof hi){var n=new Pn,o=e.children;o.forEach((function(i){var o=i.worldMatrix,r=t.mainRoot.worldMatrix.clone().invert(),a=r.multiply(o).decompose(),s=new Pn,c=Vn.newRemoveFigureAction(i,e);s.add(c);var h=Vn.newAddFigureAction(i,t.mainRoot);s.add(h);var l=Vn.newPoseChangeAction([{figure:i,pose:a}]);s.add(l),n.add(s)}));var r=Vn.newRemoveFigureAction(e,t.mainRoot);n.add(r),i.add(n)}})),this.actionStack.excute(i)}},groupFigures:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentSelections;if(this.mainRoot){var e=new hi({name:"Group"}),i=t.map((function(t){return t})),n=tn.calculateFiguresBounds(i),o=this.mainRoot.worldMatrix.clone().invert(),r=o.multiplyWithVertexDatas(n.left,n.top),a=o.multiplyWithVertexDatas(n.right,n.bottom);e.x=r[0],e.y=r[1],e.width=a[0]-r[0],e.height=a[1]-r[1];var s=new Pn,c=Vn.newAddFigureAction(e,this.mainRoot);s.add(c),i.forEach((function(t){var i=new Pn,n=Vn.newTranslateAction([t],-e.x,-e.y);if(i.add(n),t.parent){var o=Vn.newRemoveFigureAction(t,t.parent);i.add(o)}var r=Vn.newAddFigureAction(t.getTarget(),e);i.add(r),s.add(i)})),this.actionStack.excute(s),this.mainRoot.refresh()}}}},cr={methods:{clipFigures:function(t){var e=t.mask,i=t.figures;if(e&&i&&0!=i.length&&this.mainRoot){var n=e.worldMatrix.invert(),o=new Pn;i.forEach((function(t){var i=new Pn,r=t.worldMatrix,a=n.clone().multiply(r),s=Vn.newPoseChangeAction([{figure:t,pose:a.decompose()}]);i.add(s);var c=Vn.newRemoveFigureAction(t,t.parent);i.add(c);var h=Vn.newAddFigureAction(t,e);i.add(h),o.add(i)})),e.clip||o.add(Vn.newChangePropertyAction(e,"clip",!0)),e.showBorder&&o.add(Vn.newChangePropertyAction(e,"showBorder",!1)),e.fill&&o.add(Vn.newChangePropertyAction(e,"fill",!1)),this.actionStack.excute(o),this.mainRoot.refresh()}},unClipFigures:function(t){var e=this;if(t&&0!=t.length&&this.mainRoot){var i=new Pn;t.forEach((function(t){var n=t.children,o=new Pn;n.forEach((function(i){var n=i.worldMatrix,r=e.mainRoot.worldMatrix.clone().invert(),a=r.multiply(n).decompose(),s=new Pn;s.add(Vn.newRemoveFigureAction(i,t)),s.add(Vn.newAddFigureAction(i,e.mainRoot)),s.add(Vn.newPoseChangeAction([{figure:i,pose:a}])),o.add(s)})),t.clip&&o.add(Vn.newChangePropertyAction(t,"clip",!1)),t.showBorder||o.add(Vn.newChangePropertyAction(t,"showBorder",!0)),t.fill||o.add(Vn.newChangePropertyAction(t,"fill",!0)),i.add(o)})),this.actionStack.excute(i),this.mainRoot.refresh()}}}},hr={name:"Canvas",mixins:[ar,sr,cr],components:{ToolsBar:X,ActionBar:nr},emits:["selection:change","tooltip:update","root:update"],mounted:function(){var t=this.$el,e=t.querySelector("#canvas-container"),i=e.clientWidth,n=e.clientHeight,o=window.devicePixelRatio,r=t.querySelector("#front-canvas"),a=t.querySelector("#main-canvas"),s=t.querySelector("#backend-canvas");this.tools={},u(r,i,n,o),u(a,i,n,o),u(s,i,n,o);var c=Ee.makeCanvasSurface("front-canvas"),h=c.getCanvas();h.scale(o,o),this.frontRoot=new dn(c,{width:i,height:n}),this.mainSurface=Ee.makeCanvasSurface("main-canvas");var l=this.mainSurface.getCanvas();function u(t,e,i,n){t.width=e*n,t.height=i*n}l.scale(window.devicePixelRatio,window.devicePixelRatio),this.createTools(this.frontRoot,this.mainRoot)},methods:{createNewMainRoot:function(t,e){this.disposeMainRoot(),null==this.mainRoot&&(null==this.actionStack&&(this.actionStack=new xn),this.mainRoot=new rr(this.mainSurface,this.frontRoot.width,this.frontRoot.height,{width:t,height:e,name:"Document Root"}),this.mainRoot.surface=this.mainSurface,this.mainRoot.on("addChild",this.figureAdded),this.mainRoot.on("removeChild",this.figureRemoved),this.configToolsMainRoot(this.mainRoot),this.currentTool="select",this.mainRoot.init(),this.$el.focus(),this.$emit("root:update",this.mainRoot))},disposeMainRoot:function(){if(null!=this.mainRoot){var t=this.currentSelections;this.currentSelections=[],t.length=0,this.mainRoot.off("addChild",this.figureAdded),this.mainRoot.off("removeChild",this.figureRemoved),this.mainRoot.dispose(),this.mainRoot=null,this.configToolsMainRoot(null),this.actionStack.dispose(),this.actionStack=null}},configToolsMainRoot:function(t){for(var e in this.tools){var i=this.tools[e];i.mainRoot=t}},createTools:function(t,e,i){var n=this;function o(t){null==n.registedTools&&(n.registedTools=[]),n.tools[t.id]=t,t.on("transformFigure",n.figureTransform),t.on("complete",n.toolCompleted),t.on("active",n.toolActived),t.on("selectionChange",(function(t){n.selectionChange(t.event)})),t.on("toolSwitch",n.toolSwitch),t.on("updateTooltip",n.toolTipUpdated),t.on("cursorChange",n.cursorChange),n.registedTools.push(t)}o(new In(t,e,i)),o(new Nn(t,e,i)),o(new Ln(t,e,i)),o(new Un(t,e,i)),o(new Gn(t,e,i)),o(new Wn(t,e,i)),o(new Kn(t,e,i)),o(new Xn(t,e,i)),o(new $n(t,e,i)),o(new Qn(t,e,i)),o(new zn(t,e,i)),o(new lo(t,e,i)),o(new co(t,e,i)),o(new Zn(t,e,i)),o(new io(t,e,i)),o(new to(t,e,i)),o(new oo(t,e,i)),o(new ho(t,e,i)),o(new uo(t,e,i))},mousewheel:function(t){var e=this;t.altKey&&(this._zoomId&&cancelAnimationFrame(this._zoomId),this._zoomId=requestAnimationFrame((function(){t.altKey&&e.zoomMainRoot(t.deltaY<0)})))},mousedown:function(t){this.spacePressed&&this.mainRoot?this.toolSwitch({event:{id:"move-root",x:t.offsetX,y:t.offsetY}}):this.activeTool(this.getCurrentTool(),t.offsetX,t.offsetY,t)},mousemove:function(t){var e=this.getCurrentTool();e=null==this.currentActivedTool?e:this.currentActivedTool,e&&e.move(t.offsetX,t.offsetY,t)},deactiveCurrentTool:function(t){this.currentActivedTool&&this.currentActivedTool.deactive(t.offsetX,t.offsetY,t),this.currentActivedTool=null},mouseout:function(t){this.deactiveCurrentTool(t)},mouseover:function(t){this.deactiveCurrentTool(t)},mouseup:function(t){this.deactiveCurrentTool(t)},mouseleave:function(t){this.deactiveCurrentTool(t)},zoomMainRoot:function(t){if(this.mainRoot){var e=.05;t||(e*=-1),this.mainRoot.zoom+=e,this.mainRoot.refresh()}},getCurrentTool:function(){return this.tools[this.currentTool]},cursorChange:function(t){var e=this;this.$nextTick((function(){e.cursor=t.event.cursor}))},useTool:function(t,e){t.prepare(e),t.updateCurrentSelections(this.currentSelections),this.cursor=t.defaultCursor},unUseTool:function(t,e){t.unUse(e),t.updateCurrentSelections(),this.cursor="default"},toolTipUpdated:function(t){var e=t.event.tooltip;this.$emit("tooltip:update",e)},activeTool:function(t,e,i,n){t&&(this.cursor=t.defaultCursor,t.active(e,i,n))},toolSwitch:function(t){var e=t.source,i=t.event,n=i.id,o=i.x,r=i.y,a=i.args,s=this.tools[n];s&&(e&&e.deactive(o,r),this.useTool(s,a),this.activeTool(s,o,r))},toolActived:function(t){this.currentActivedTool=t.source},isAddShapeTool:function(t){return"rect"==t||"ellipse"==t||"star"==t||"polygon"==t||"line"==t},isTransformTool:function(t){return"rotate"==t||"e-resize"==t||"s-resize"==t||"n-resize"==t||"w-resize"==t||"se-resize"==t||"sw-resize"==t||"ne-resize"==t||"nw-resize"==t},processVertexSelectResult:function(t){var e=t.type;t.figure,t.point;if("move"==e){var i=Vn.newTranslateAction(t.figures,t.dx,t.dy);this.actionStack.excute(i)}if("vertex"==e){var n=t.vertex,o=t.copy,r=new Pn;n.x!=o.x&&r.add(Vn.newChangePropertyAction(n,"x",o.x)),n.y!=o.y&&r.add(Vn.newChangePropertyAction(n,"y",o.y)),n.type!=o.type&&r.add(Vn.newChangePropertyAction(n,"type",o.type)),o.in!=n.in&&r.add(Vn.newChangePropertyAction(n,"in",o.in)),o.out!=n.out&&r.add(Vn.newChangePropertyAction(n,"out",o.out)),this.actionStack.excute(r)}},processPenResult:function(t){var e,i=t.type,n=t.figure,o=t.point,r=t.path,a=t.index;"add"==i&&(n?e=Vn.newAddFigureAction(n,this.mainRoot,"路径图形"):o&&(e=Vn.newInsertPointAction(o,r,a))),"close"==i&&(e=Vn.newChangePropertyAction(r,"close",!0)),"minus"==i&&(e=Vn.newDeletePointAction(r,a)),e&&this.actionStack.excute(e),"close"==i&&this.selectionChange({type:"new",selections:[]}),this.mainRoot.refresh()},toolCompleted:function(t){var e=t.event,i=e.id,n=e.result;if(n&&this.isAddShapeTool(i)&&this.addShape(n,"添加图形"),n&&"pen"==i&&this.processPenResult(n),n&&"vertex-select"==i&&this.processVertexSelectResult(n),"move"==i&&n){var o=Vn.newTranslateAction(n.figures,n.dx,n.dy);this.actionStack.excute(o)}if(n&&this.isTransformTool(i)){var r=Vn.newPoseChangeAction(n);this.actionStack.excute(r)}n&&"select"==i&&this.selectionChange(n),this.mainRoot.refresh();var a=this.getCurrentTool();this.currentActivedTool.id!=a.id&&(this.unUseTool(this.currentActivedTool),a.updateCurrentSelections(this.currentSelections),this.cursor=a.defaultCursor),this.currentActivedTool=null},getTransformFeedback:function(){return null==this.transformFeedback&&(this.transformFeedback=new wn,this.frontRoot.addChild(this.transformFeedback),this.frontRoot.transformFeedback=this.transformFeedback),this.transformFeedback},changeFigureProperty:function(t){var e=new Pn;t.forEach((function(t){var i=t.model,n=t.property,o=t.value;i&&n&&e.add(Vn.newChangePropertyAction(i,n,o))})),this.actionStack.excute(e),this.mainRoot.refresh(),this.frontRoot.refresh()},addShape:function(t){if(t){var e=t.figure;if(e){var i=t.name,n=Vn.newAddFigureAction(e,this.mainRoot,i);this.excuteAction(n)}}},vertexAdded:function(t){},vertexRemoved:function(t){},figureAdded:function(t){var e=t.event.child;this.selectionChange({type:"new",selections:[e]}),this.$emit("root:update",this.mainRoot)},figureRemoved:function(t){var e=t.event.child,i=this.currentSelections.indexOf(e);-1!=i&&this.currentSelections.splice(i,1),this.$emit("root:update",this.mainRoot)},selectionChange:function(t){var e=this;t&&("new"==t.type&&(this.currentSelections=t.selections),"plus"==t.type&&this.currentSelections.concat(t.selections),"minus"==t.type&&t.selections.forEach((function(t){var i=e.currentSelections.indexOf(t);-1!=i&&e.currentSelections.splice(i,1)})))},excuteAction:function(t){if(t)return this.actionStack.excute(t)},toolUpdate:function(t){this.currentTool=t}},data:function(){return{actionStack:null,cursor:"auto",currentSelections:[],currentTool:null,mainRoot:null}},computed:{canvasBGColor:function(){return this.mainRoot?"graybg":"blackbg"}},watch:{currentTool:function(t,e){if(t!=e){var i=this.tools[t],n=this.tools[e];n&&this.unUseTool(n),i&&this.useTool(i)}},currentSelections:{handler:function(t,e){var i=this;this.currentSelections.sort((function(t,e){if(t instanceof li||e instanceof li)return 0;i.mainRoot.indexOfChild(e),i.mainRoot.indexOfChild(t)}));var n=this.getCurrentTool();n&&n.updateCurrentSelections(t),this.mainRoot.refresh(),this.frontRoot.refresh(),this.$emit("selection:change",{selections:t})},deep:!0},actionStack:{handler:function(){this.frontRoot.refresh(),this.mainRoot.refresh()},deep:!0}},props:{}};i("714c");hr.render=un;var lr=hr,ur={class:"document-root"},dr=Object(n["h"])("div",{class:"document-header"},[Object(n["h"])("i",{class:"iconfont icon-document",style:{"margin-right":"5px"}}),Object(n["h"])("span",{style:{"font-weight":"bold"}},"Shape Structure")],-1),fr=Object(n["h"])("div",{style:{"background-color":"#777777",height:"1px","margin-top":"5px","margin-bottom":"10px"}},null,-1),pr={class:"document-content"};function vr(t,e,i,o,r,a){var s=Object(n["v"])("tree-node");return Object(n["q"])(),Object(n["d"])("div",ur,[dr,fr,Object(n["h"])("div",pr,[(Object(n["q"])(!0),Object(n["d"])(n["a"],null,Object(n["u"])(i.nodes,(function(t){return Object(n["q"])(),Object(n["d"])(s,{key:t.id,model:t},null,8,["model"])})),128))])])}var br={key:0,class:"tree-node"},yr=Object(n["h"])("i",{class:"iconfont icon-arrow-right",style:{"font-size":"1em"}},null,-1),gr={key:1,style:{width:"1.4em"}},mr={class:"tree-node-contents",style:"padding-left:2em"},kr={key:0};function Or(t,e,i,o,r,a){var s=Object(n["v"])("tree-node",!0);return Object(n["q"])(),Object(n["d"])("div",null,[null!=i.model?(Object(n["q"])(),Object(n["d"])("div",br,[Object(n["h"])("div",{class:"tree-node-label",onClick:e[1]||(e[1]=function(){return a.expand&&a.expand.apply(a,arguments)})},[a.hasChildren?(Object(n["q"])(),Object(n["d"])("div",{key:0,id:"collapse-icon-"+i.model.id,class:["collapse-icon",a.collapsed?"collapse-icon-rotate":""]},[yr],10,["id"])):(Object(n["q"])(),Object(n["d"])("div",gr)),Object(n["h"])("i",{class:["iconfont node-icon",a.nodeIcon]},null,2),Object(n["h"])("small",null,Object(n["x"])(i.model.name),1)]),Object(n["h"])("div",mr,[a.collapsed?(Object(n["q"])(),Object(n["d"])("div",kr,[(Object(n["q"])(!0),Object(n["d"])(n["a"],null,Object(n["u"])(a.children,(function(t){return Object(n["q"])(),Object(n["d"])(s,{key:t.id,model:t},null,8,["model"])})),128))])):Object(n["e"])("",!0)])])):Object(n["e"])("",!0)])}var jr={name:"TreeNode",data:function(){return{iconWidth:0}},updated:function(){if(this.model){var t=this.$el,e=t.querySelector("#collapse-icon-"+this.model.id);null!=e&&(this.iconWidth=e.clientWidth)}},computed:{collapsed:function(){return!!this.model&&(null==this.model.collapsed&&(this.model.collapsed=!0),this.model.collapsed)},nodeIcon:function(){return tn.objectIcon(this.model)},children:function(){if(this.hasChildren)return this.model.children},hasChildren:function(){if(this.model&&this.model.children)return this.model.children.length>0}},methods:{expand:function(t){this.hasChildren&&(null==this.model.collapsed?this.model.collapsed=!0:this.model.collapsed=!this.model.collapsed)}},props:{model:{type:Object}}};i("f1b5");jr.render=Or;var wr=jr,xr={components:{TreeNode:wr},name:"Document",props:{nodes:{type:Array}},watch:{nodes:{handler:function(){},deep:!0}}};i("4a0b");xr.render=vr;var Cr=xr,_r={name:"Main",components:{ToolsBar:X,PropertyBar:on,Canvas:lr,Document:Cr},emits:["tooltip:update"],mounted:function(){this.svgDownloadLink=document.createElement("a");var t=this.svgDownloadLink;t.style.display="none",document.body.appendChild(t)},methods:{createSVG:function(){var t=this;this.rootDocument&&this.rootDocument.getSVGString().then((function(e){if(t.svgDownloadLink){var i=t.svgDownloadLink;i.setAttribute("href","data:xml/plain;charset=utf-8,"+encodeURIComponent(e)),i.setAttribute("download","untitle.svg"),i.click()}}))},createNewDocument:function(t){"create"==t.type&&this.$refs["canvas"].createNewMainRoot(t.width,t.height)},rootFigureUpdate:function(t){this.rootDocument=t},tooltipUpdate:function(t){this.$emit("tooltip:update",t)},selectionChange:function(t){this.selections=t.selections},propertyChange:function(t){this.$refs["canvas"].changeFigureProperty(t)}},computed:{nodes:function(){if(this.rootDocument)return this.rootDocument.children}},data:function(){return{currentTool:"select",selections:[],rootDocument:null}}};i("54c1");_r.render=U;var Sr=_r,Pr={id:"footer",class:"bluebg"},Fr=Object(n["h"])("div",null,[Object(n["h"])("small",null,"v0.0.1")],-1);function Ar(t,e,i,o,r,a){return Object(n["q"])(),Object(n["d"])("div",Pr,[Object(n["h"])("div",null,[Object(n["h"])("small",null,Object(n["x"])(i.tooltip),1)]),Fr])}var Tr={name:"Footer",props:{tooltip:{type:String,default:"NONE"}}};i("7843");Tr.render=Ar;var Rr=Tr,Mr={name:"App",mounted:function(){var t=this,e=this.$el,i=e.querySelector("#main-loader");i&&(i.addEventListener("transitionend",(function(){t.showLoader=!1})),i.addEventListener("animationend",(function(){t.showLoader=!1}))),Ee.initCanvasKit("lib/").then((function(e){t.loaded=!0}))},methods:{documentUpdate:function(t){this.root=t},tooltipUpdate:function(t){this.tooltip=t},newDocument:function(t){this.$refs["main"].createNewDocument(t)},createSVG:function(t){this.$refs["main"].createSVG()}},data:function(){return{loaded:!1,showLoader:!0,tooltip:"",root:null}},components:{Header:z,Main:Sr,Footer:Rr}};i("7240");Mr.render=s;var Dr=Mr,Vr=i("6c02"),Br=i("cf05"),Er=i.n(Br),qr={class:"home"},Ir=Object(n["h"])("img",{alt:"Vue logo",src:Er.a},null,-1);function zr(t,e,i,o,r,a){return Object(n["q"])(),Object(n["d"])("div",qr,[Ir])}var Hr={name:"Home"};Hr.render=zr;var Nr=Hr,Lr=[{path:"/",name:"Home",component:Nr},{path:"/about",name:"About",component:function(){return i.e("about").then(i.bind(null,"f820"))}}],Gr=Object(Vr["a"])({history:Object(Vr["b"])(""),routes:Lr}),Ur=Gr,Wr=i("5502"),Yr=Object(Wr["a"])({state:{},mutations:{},actions:{},modules:{}});Object(n["c"])(Dr).use(Yr).use(Ur).mount("#app")},6231:function(t,e,i){},"6ae5":function(t,e,i){},"714c":function(t,e,i){"use strict";i("6231")},7240:function(t,e,i){"use strict";i("362c")},7843:function(t,e,i){"use strict";i("9b77")},8358:function(t,e,i){"use strict";i("c446")},"8aa9":function(t,e,i){"use strict";i("3c95")},"9b77":function(t,e,i){},"9fb6":function(t,e,i){},a3cf:function(t,e,i){},b2bb:function(t,e,i){},bae3:function(t,e,i){},be6a:function(t,e,i){"use strict";i("495b")},c446:function(t,e,i){},c5a6:function(t,e,i){"use strict";i("b2bb")},cf05:function(t,e,i){t.exports=i.p+"img/logo.82b9c7a5.png"},f1b5:function(t,e,i){"use strict";i("a3cf")},f693:function(t,e,i){"use strict";i("9fb6")}});