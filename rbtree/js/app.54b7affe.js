(function(){"use strict";var e={207:function(e,t,n){n.r(t),t["default"]={title:{front:"Red-Black",next:"Tree"}}},5551:function(e,t,n){n.r(t),t["default"]={title:{front:"红黑",next:"树",githubdes:"Github地址"},operation:{insert:"插入",randomInsert:"随机插入",delete:"删除",randomDelete:"随机删除",placeholder:"0-999",generate:"生成",generateholder:">100个节点"},main:{error1:"ID只能是0-999的数字",error2:"生成节点个数只能是1-99个"},footer:{reportbug:"提交bug"},tip:{insertNode:"插入节点",replaceNode:"替换节点",deleteNode:"删除节点",currentBlance:"当前处理节点",nextBlance:"下个处理节点",case:"情景",reason:"原因",process:"操作",pause:"暂停",forward:"下一步",none:"无",blanced:"已平衡",notblanced:"未平衡",insertBlanceOp:"插入平衡操作",deleteBlanceOp:"删除平衡操作",redKey:"红色",blackKey:"黑色",rRotateKey:"右旋转",lRotateKey:"左旋转"},canvas:{deleteNode:"删除节点",insertNode:"插入节点"},message:{insertsuccess:"插入节点({id})完成",updatewarning:"节点({id})已经存在，不替换，仅更新",deletesuccess:"删除节点({id})完成",deleteerror:"没有找到对应节点({id})",generatesuccess:"生成{num}个节点的红黑树完成",deleteBlance:{additional1:". 删除替换节点({0}), 并将删除点键值({1})改为替换点键值({0})",additional2:". 删除节点和替换节点是同一个节点({0}), 直接删除节点({0})",additional3:"已经平衡",simple:{case1:{ca:"简单情景(1). 替换点为红色, 且最多只有一个子节点",op:"无需平衡操作",re:"替换点({0})为红色节点，根据红黑树特点, 该节点的父节点必定是黑色, 且其子节点也必定为黑色(或者为空), 直接删除该节点({0})不会影响子树平衡"},case2:{re:"让替换点({0})的唯一红色子节点({1})改成黑色并代替替换点, 不会影响子树平衡.",op:"将红色子节点({0})改为黑色",ca:"简单情景(2). 替换点为黑色, 且最多只有一个子节点, 并且该子节点是红色"},case3:{re:"替换点({0})为黑色，直接删除会影响通过该节点路径上的黑色节点数目.",op:"需要对替换点({0})进行子树平衡",ca:"简单情景(3). 替换点为黑色, 但不具有至少一个红色子节点"}},complex:{case1:{re:"根节点无需平衡处理",ca:"情景(1). 处理节点是根节点"},case2:{re:"这样操作能让下次平衡处理的时候, 处理节点的父节点为红色, 可以转入到情景(4), 情景(5), 情景(6)",op:"将父节点({0})改为红色，兄弟节点({1})改为黑色，并将父节点({0})进行{3}旋转，继续以该点(${2})进行平衡",ca:"情景(2). 处理节点的兄弟节点为红色"},case3:{re:"该节点的子树无论怎样操作也不能平衡, 所以修改兄弟节点为红色,这样通过父节点路径的黑色节点即使在删除替代点后也不会减少, 并让父节点进行平衡",op:"更改兄弟节点({0})为红色，将其父节点({1})作为下个处理点进行平衡",ca:"情景(3).处理节点是黑色, 其兄弟节点以及兄弟节点的所有子节点都为黑色（或者兄弟节点没有子节点），且父节点也为黑色"},case4:{op:"更改兄弟节点({0})为红色，父节点({0})为黑色, 平衡完成",ca:"情景(4). 处理节点是黑色, 其兄弟节点以及兄弟节点的所有子节点都为黑色（或者兄弟节点没有子节点），且父节点为红色"},case5:{re:"通过变换颜色以及对兄弟节点的旋转, 可以转换到情景(6)",op:"更改兄弟节点({0})为红色，兄弟的同向红色子节点({1})改为黑色，对兄弟节点({0})进行{3}旋转，继续以该点({2})进行平衡",ca:"情景(5). 处理节点是黑色, 其兄弟节点也为黑色, 且兄弟节点有一红色节点和处理节点在同一则(同为左节点或同为右节点)"},case6:{op:"兄弟节点({0})和父节点({1})调换颜色，兄弟的红色子节点({2})改为黑色，对父节点({1})进行{3}旋转，平衡完成",ca:"情景(6). 处理节点是黑色, 其兄弟节点也为黑色, 兄弟节点的子节点不同色(或仅有一个红色子节点), 且兄弟节点的红色子节点和处理节点不在同一则"}}},insertBlance:{case1:{re:"黑色节点无需更对子树平衡"},case2:{re:"根节点必须为黑色",op:"将节点({0})改成黑色"},case3:{ca:"父节点为黑色节点，无需平衡"},case4:{op:"将祖父节点({0})改为红色，再将父节点({1})、叔父节点({2})改为黑色, 对祖父节点({0})进行平衡处理",ca:"情景(1). 处理节点的父节点、叔父节点都为红色"},case5:{re:"旋转后的下一个处理节点是当前处理点的父节点, 这样能让它们都在同一则, 转入情景(2)",op:"对父节点({0})进行{1}旋转",ca:"情景(3). 处理节点和其父节点同为红色，请不在同一侧"},case6:{op:"修改祖父节点({0})为红色，更改父节点({1})为黑色，对祖父节点进行{2}旋转, 达到平衡",ca:"情景(2). 处理节点的父节点为红色，和处理节点在同一侧，并且处理节点没有叔父节点或者叔父节点为黑色"}}}}},143:function(e,t,n){n(6992),n(8674),n(9601),n(7727);var i=n(9963),a=n(3781),r=n(6252),s={id:"app",class:"bg-light"};function o(e,t,n,i,a,o){var l=(0,r.up)("Header"),h=(0,r.up)("MainSpace"),c=(0,r.up)("Footer");return(0,r.wg)(),(0,r.j4)("div",s,[(0,r.Wm)(l,{onLangChange:o.switchLang,currentLang:a.currentLang},null,8,["onLangChange","currentLang"]),(0,r.Wm)(h),(0,r.Wm)(c)])}var l=n(3577),h={class:"bg-dark d-flex"},c={class:"container-fluid"},d={class:"d-flex justify-content-between align-items-center"},u={class:"header-left"},f={id:"title-text"},g={class:"text-white title-text-container title-font-size",style:{"font-weight":"bolder"}},p={id:"title-next",class:"text-dark title-text-container title-font-size"},v={class:"header-right"},m={class:"title-link-container"},y=(0,r.Wm)("i",{id:"github",class:"fab fa-github title-font-size title-right-icon"},null,-1);function b(e,t,n,i,a,s){return(0,r.wg)(),(0,r.j4)("div",h,[(0,r.Wm)("div",c,[(0,r.Wm)("div",d,[(0,r.Wm)("div",u,[(0,r.Wm)("div",f,[(0,r.Wm)("div",g,(0,l.zw)(e.$t("default.title.front")),1),(0,r.Wm)("div",p,(0,l.zw)(e.$t("default.title.next")),1)])]),(0,r.Wm)("div",v,[(0,r.ry)("",!0),(0,r.Wm)("div",m,[(0,r.Wm)("a",{href:"https://github.com/eclipseglory/91datastructure/tree/main/rbtree",target:"_blank",title:e.$t("default.title.githubdes")},[y],8,["title"])])])])])])}var k={name:"Header",props:{currentLang:{type:String,default:"zh"}},emits:["langChange"],methods:{changeLang:function(e){this.$emit("langChange",e)}},computed:{currentLangText:function(){return this.isChinese?"中文":"Exllent English"},isChinese:function(){return"zh"==this.currentLang}}};k.render=b;var w=k,x={class:"mt-auto bg-dark footer-container"},_=(0,r.Wm)("div",{class:"text-light"},null,-1),C=(0,r.Wm)("div",{id:"center",class:"text-light"},[(0,r.Wm)("small",null,[(0,r.Uk)("Developed by "),(0,r.Wm)("a",{id:"developer",href:"#",title:"Developer's blog,if he had"},"老脸"),(0,r.Uk)(" (v2021.4.15)")])],-1),S={id:"left"},B=(0,r.Wm)("i",{class:"fas fa-bug footer-left-icon"},null,-1);function N(e,t,n,i,a,s){return(0,r.wg)(),(0,r.j4)("footer",x,[_,C,(0,r.Wm)("div",S,[(0,r.Wm)("a",{href:"https://github.com/eclipseglory/91datastructure/issues",target:"_blank",title:e.$t("default.footer.reportbug")},[B],8,["title"])])])}var T={name:"Footer"};T.render=N;var P=T,M={id:"main"};function I(e,t,n,i,a,s){var o=(0,r.up)("OperateSpace"),l=(0,r.up)("CanvasSpace");return(0,r.wg)(),(0,r.j4)("div",M,[(0,r.Wm)(o,{disabled:a.disableOperation,onAdd:s.add,onDelete:s.del,onRandomDelete:s.randomDelete,onGenerate:s.generate,onInvalidId:s.invalidId,onInvalidNum:s.invalidNum},null,8,["disabled","onAdd","onDelete","onRandomDelete","onGenerate","onInvalidId","onInvalidNum"]),(0,r.Wm)(l,{ref:"canvas","onOperation:over":s.operationOver,"onOperation:start":s.operationStart},null,8,["onOperation:over","onOperation:start"])])}var W={id:"operate-space"},R={class:"row bb",style:{padding:"20px"}},O={class:"mb-3"},$={class:"input-group mb-3"},A=(0,r.Wm)("i",{class:"fas fa-sitemap"},null,-1),D={class:"row bb",style:{padding:"20px"}},L={class:"input-group mb-3"},K=(0,r.Wm)("i",{class:"far fa-plus-square"},null,-1),E={class:"mb-3"},Z=(0,r.Wm)("i",{class:"fas fa-plus"},null,-1),z={class:"row",style:{padding:"20px"}},H={class:"input-group mb-3"},Y=(0,r.Wm)("i",{class:"far fa-minus-square"},null,-1),j={class:"mb-3"},F=(0,r.Wm)("i",{class:"fas fa-minus"},null,-1);function X(e,t,n,a,s,o){return(0,r.wg)(),(0,r.j4)("div",W,[(0,r.Wm)("div",R,[(0,r.Wm)("div",O,[(0,r.Wm)("div",$,[(0,r.Wm)("button",{disabled:!o.generateEnable,onClick:t[1]||(t[1]=function(){return o.generate&&o.generate.apply(o,arguments)}),class:"btn btn-primary btn-sm",type:"button",id:"generatebutton"},[A,(0,r.Uk)(" "+(0,l.zw)(e.$t("default.operation.generate")),1)],8,["disabled"]),(0,r.wy)((0,r.Wm)("input",{disabled:n.disabled,"onUpdate:modelValue":t[2]||(t[2]=function(e){return s.generateNumber=e}),type:"text",class:["form-control",{"is-invalid":!s.validateGenerate}],onInput:t[3]||(t[3]=function(){return o.generateChange&&o.generateChange.apply(o,arguments)}),placeholder:e.$t("default.operation.generateholder"),id:"generatenumber","aria-describedby":"generatebutton"},null,42,["disabled","placeholder"]),[[i.nr,s.generateNumber]])])])]),(0,r.Wm)("div",D,[(0,r.Wm)("div",L,[(0,r.Wm)("button",{disabled:!o.addButtonEnable,onClick:t[4]||(t[4]=function(){return o.add&&o.add.apply(o,arguments)}),class:"btn btn-primary btn-sm",type:"button",id:"addbutton"},[K,(0,r.Uk)(" "+(0,l.zw)(e.$t("default.operation.insert")),1)],8,["disabled"]),(0,r.wy)((0,r.Wm)("input",{disabled:n.disabled,"onUpdate:modelValue":t[5]||(t[5]=function(e){return s.addId=e}),type:"text",class:["form-control",{"is-invalid":!s.validAddId}],onInput:t[6]||(t[6]=function(){return o.inputChange&&o.inputChange.apply(o,arguments)}),placeholder:e.$t("default.operation.placeholder"),id:"idinput","aria-describedby":"addbutton"},null,42,["disabled","placeholder"]),[[i.nr,s.addId]])]),(0,r.Wm)("div",E,[(0,r.Wm)("button",{disabled:n.disabled,onClick:t[7]||(t[7]=function(){return o.randomAdd&&o.randomAdd.apply(o,arguments)}),class:"btn btn-primary btn-sm",style:{width:"100%"},type:"button",id:"randomadd"},[Z,(0,r.Uk)(" "+(0,l.zw)(e.$t("default.operation.randomInsert")),1)],8,["disabled"])])]),(0,r.Wm)("div",z,[(0,r.Wm)("div",H,[(0,r.Wm)("button",{disabled:!o.deleteButtonEnable,class:"btn btn-danger btn-sm",onClick:t[8]||(t[8]=function(){return o.del&&o.del.apply(o,arguments)}),type:"button",id:"deletebutton"},[Y,(0,r.Uk)(" "+(0,l.zw)(e.$t("default.operation.delete")),1)],8,["disabled"]),(0,r.wy)((0,r.Wm)("input",{disabled:n.disabled,"onUpdate:modelValue":t[9]||(t[9]=function(e){return s.deleteId=e}),type:"text",class:[{"is-invalid":!s.validDeleteId},"form-control"],onInput:t[10]||(t[10]=function(){return o.inputChange2&&o.inputChange2.apply(o,arguments)}),placeholder:e.$t("default.operation.placeholder"),id:"delete_idinput","aria-describedby":"deletebutton"},null,42,["disabled","placeholder"]),[[i.nr,s.deleteId]])]),(0,r.Wm)("div",j,[(0,r.Wm)("button",{disabled:n.disabled,onClick:t[11]||(t[11]=function(){return o.randomDelete&&o.randomDelete.apply(o,arguments)}),class:"btn btn-danger btn-sm",style:{width:"100%"},type:"button",id:"randomdelete"},[F,(0,r.Uk)(" "+(0,l.zw)(e.$t("default.operation.randomDelete")),1)],8,["disabled"])])])])}n(9494),n(9653);var G={data:function(){return{addId:"",validAddId:!0,deleteId:"",validDeleteId:!0,generateNumber:"",validateGenerate:!0}},emits:["add","delete","randomDelete","invalid-id","generate","invalid-num"],props:{disabled:!1},computed:{addButtonEnable:function(){return!this.disabled&&this.validAddId},deleteButtonEnable:function(){return!this.disabled&&this.validDeleteId},generateEnable:function(){return!this.disabled&&this.validateGenerate}},methods:{generate:function(){if(this.validateGenerate){var e=Number.parseInt(this.generateNumber);isNaN(e)||this.$emit("generate",e)}},add:function(){if(this.validAddId){var e=Number.parseInt(this.addId);this.addNode(e)}},randomDelete:function(){this.$emit("randomDelete")},del:function(){if(this.validDeleteId){var e=Number.parseInt(this.deleteId);this.$emit("delete",e)}},generateChange:function(e){var t=e.target.value,n=Number.parseInt(t);this.validateGenerate=!isNaN(n)&&n>0&&n<100,this.validateGenerate||this.$emit("invalid-num",n)},inputChange:function(e){var t=e.target.value,n=Number.parseInt(t);this.validAddId=!isNaN(t)&&n>=0&&n<1e3,this.validAddId||this.$emit("invalid-id",t)},inputChange2:function(e){var t=e.target.value,n=Number.parseInt(t);this.validDeleteId=!isNaN(t)&&n>=0&&n<1e3,this.validDeleteId||this.$emit("invalid-id",t)},randomAdd:function(){var e=Math.floor(1e3*Math.random());this.addNode(e)},addNode:function(e){this.$emit("add",e)}}};G.render=X;var U=G,q={id:"canvas-group"},V=(0,r.Wm)("canvas",{id:"canvas"},null,-1),J={class:"toast-body"},Q=(0,r.Wm)("button",{type:"button",class:"btn-close btn-close-white me-2 m-auto","data-bs-dismiss":"toast","aria-label":"Close"},null,-1);function ee(e,t,n,i,a,s){var o=(0,r.up)("Tip");return(0,r.wg)(),(0,r.j4)("div",q,[V,(0,r.Wm)(o,{ref:"blanceTip",onNextStep:s.blanceNextStep,waitTime:6},null,8,["onNextStep"]),(0,r.Wm)("div",{id:"result-tip",class:["toast align-items-center text-white border-0 position-absolute",a.tipColor],role:"alert","aria-live":"assertive","aria-atomic":"true"},[(0,r.Wm)("div",{class:["d-flex justify-content-baseline",a.tipTextColor]},[(0,r.Wm)("div",J,[(0,r.Wm)("i",{class:a.tipIcon,style:{"margin-right":"0.5em"}},null,2),(0,r.Wm)("small",null,(0,l.zw)(a.tipMsg),1)]),Q],2)],2)])}var te=n(1278),ne=n(2610),ie=(n(4747),n(4916),n(5306),n(2222),n(1539),n(561),function(){function e(){(0,te.Z)(this,e),this.root}return(0,ne.Z)(e,[{key:"insertNode",value:function(e){return null==this.root?(this.root=e,this.root.changeToBlack(),this.root):(this.root=this._findRoot(),this.root.insertNode(e))}},{key:"_findRoot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root;return null==e?null:null!=e.parent?this._findRoot(e.parent):(this.root=e,e)}},{key:"findNode",value:function(e){if(null!=this.root)return this.root=this._findRoot(this.root),this.root.findNode(e)}}]),e}()),ae=n(8198),re=n(4175),se=n(485),oe=n(9666),le=n(7224),he=(n(3290),function(){function e(){(0,te.Z)(this,e)}return(0,ne.Z)(e,null,[{key:"getFrontLineColor",value:function(){var e=this.SCHEMAS[this.currentSchema];return null!=e?e.frontline:"#000000"}},{key:"getFocusColor",value:function(){var e=this.SCHEMAS[this.currentSchema];return null!=e?e.focus:"#000000"}},{key:"getLightColor",value:function(){var e=this.SCHEMAS[this.currentSchema];return null!=e?e.light:"#000000"}},{key:"getLightSecondColor",value:function(){var e=this.SCHEMAS[this.currentSchema];return null!=e?e.lightsecond:"#000000"}},{key:"getSecondColor",value:function(){var e=this.SCHEMAS[this.currentSchema];return null!=e?e.second:"#000000"}},{key:"getLineColor",value:function(){var e=this.SCHEMAS[this.currentSchema];return null!=e?e.line:"#000000"}},{key:"getRedColor",value:function(){var e=this.getRedColorString();return this.hexToRgb(e)}},{key:"getRedColorString",value:function(){var e=this.SCHEMAS[this.currentSchema];return null!=e?e.red:"#ffffff"}},{key:"getBlackColor",value:function(){var e=this.getBlackColorString();return this.hexToRgb(e)}},{key:"getBlackColorString",value:function(){var e=this.SCHEMAS[this.currentSchema];return null!=e?e.black:"#000000"}},{key:"getBackGroundColor",value:function(){var e=this.SCHEMAS[this.currentSchema];return null!=e?e.bg:"#ffffff"}},{key:"hexToRgb",value:function(e){var t=this.cache[e];if(null==t){var n=e.substring(1,3),i=Number.parseInt(n,16);n=e.substring(3,5);var a=Number.parseInt(n,16);n=e.substring(5,7);var r=Number.parseInt(n,16);t={red:i,green:a,blue:r},this.cache[e]=t}return t}}]),e}());(0,le.Z)(he,"SCHEMAS",{default:{red:"#DC3545",black:"#212529",line:"#576088",bg:"#F8F9FA",focus:"#ffcef3",light:"#fdfdfd",lightsecond:"#a1eafb",second:"#cabbe9",frontline:"#8559a5"}}),(0,le.Z)(he,"currentSchema","default"),(0,le.Z)(he,"cache",{});var ce=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,te.Z)(this,e),this.x=t,this.y=n}return(0,ne.Z)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x!=e&&(this._x=e,this._length=null)}},{key:"y",get:function(){return this._y},set:function(e){this._y!=e&&(this._y=e,this._length=null)}},{key:"length",get:function(){return null==this._length&&(this._length=Math.sqrt(this.x*this.x+this.y*this.y)),this._length}},{key:"normalize",value:function(){var e=this.length;this.x=this.x/e,this.y=this.y/e}},{key:"multiply",value:function(e){this.x*=e,this.y*=e}},{key:"plus",value:function(e){this.x+=e.x,this.y+=e.y}},{key:"clone",value:function(){return new e(this.x,this.y)}}]),e}(),de=(n(9714),function(){function e(){(0,te.Z)(this,e)}return(0,ne.Z)(e,null,[{key:"_getOpMsg",value:function(e,t,n){return this.$t("default.message.".concat(e),{id:t,num:n})}},{key:"generateOperationOverMsg",value:function(e,t,n,i){if(null==this.$t)return"";var a="default.message.".concat(e).concat(i);return this.$t(a,{id:t,num:n})}},{key:"generateDeleteBlanceMsgSimple",value:function(e,t,n){if(null==this.$t)return"";var i="default.message.deleteBlance.simple.case".concat(e,".").concat(t);return this.$t(i,n)}},{key:"generateDeleteBlanceMsgComplex",value:function(e,t,n){if(null==this.$t)return"";var i="default.message.deleteBlance.complex.case".concat(e,".").concat(t);return this.$t(i,n)}},{key:"generateDeleteBlanceAdditionalMsg",value:function(e,t){if(null==this.$t)return"";var n="default.message.deleteBlance.additional".concat(e);return this.$t(n,t)}},{key:"generateInsertBlanceMsg",value:function(e,t,n){if(null==this.$t)return"";var i="default.message.insertBlance.case".concat(e,".").concat(t);return this.$t(i,n)}}]),e}());(0,le.Z)(de,"$t",void 0);var ue=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,te.Z)(this,e),this._id=t,null==this._id)throw"ID can not be null";this._black=i,this.value=n,this.left,this.right,this.parent}return(0,ne.Z)(e,[{key:"isBlack",get:function(){return this._black}},{key:"isRed",get:function(){return!this.isBlack}},{key:"id",get:function(){return this._id},set:function(e){this._id=e}},{key:"update",value:function(e){this.value=e.value}},{key:"changeToRed",value:function(){this._black=!1}},{key:"changeToBlack",value:function(){this._black=!0}},{key:"disConnectParent",value:function(){return null==this.parent?null:this.parent.left==this?(this.parent.left=null,this.parent=null,!0):this.parent.right==this?(this.parent.right=null,this.parent=null,!1):null}},{key:"leftRotate",value:function(){if(null==this.right)throw"Cant left rotate without right child node";var t=[],n=this.parent,i=!1;null!=this.parent&&(i=this.disConnectParent()),t.push(this);var a=this.right;if(t.push(this.right),this.right.disConnectParent(),null!=a.left){var r=a.left;t.push(a.left),a.left.disConnectParent(),e.createConnection(this,r,!1)}return e.createConnection(a,this),null!=n&&e.createConnection(n,a,i),t}},{key:"rightRotate",value:function(){if(null==this.left)throw"Cant right rotate without left child node";var t=[],n=this.parent,i=!1;null!=this.parent&&(i=this.disConnectParent()),t.push(this);var a=this.left;if(t.push(this.left),this.left.disConnectParent(),null!=a.right){var r=a.right;t.push(a.right),a.right.disConnectParent(),e.createConnection(this,r)}return e.createConnection(a,this,!1),null!=n&&e.createConnection(n,a,i),t}},{key:"rotate",value:function(e){return e?this.leftRotate():this.rightRotate()}},{key:"findReplaceNode",value:function(){if(null!=this.left&&null!=this.right){var e=this.findNextNode();return e.findReplaceNode()}var t=[{node:this}],n=null!=this.left?this.left:this.right;if(this.isRed){var i=de.generateDeleteBlanceMsgSimple(1,"re",[this.id]),a=de.generateDeleteBlanceMsgSimple(1,"op"),r=de.generateDeleteBlanceMsgSimple(1,"ca");return this._debug(i),{blance:!1,replace:this,ca:r,reason:i,operation:a,op:"delete"}}if(null!=n&&n.isRed){var s=de.generateDeleteBlanceMsgSimple(2,"re",[this.id,n.id]),o=de.generateDeleteBlanceMsgSimple(2,"op",[n.id]),l=de.generateDeleteBlanceMsgSimple(2,"ca");return this._debug(s),n.changeToBlack(),{change:[n],blance:!1,replace:this,reason:s,ca:l,operation:o,op:"delete"}}var h=de.generateDeleteBlanceMsgSimple(3,"re",[this.id]),c=de.generateDeleteBlanceMsgSimple(3,"op",[this.id]),d=de.generateDeleteBlanceMsgSimple(3,"ca");return{blance:!0,replace:this,reason:h,ca:d,operation:c,focus:t,op:"delete"}}},{key:"blanceSubTreeAfterDelete",value:function(){var e=this.parent;if(null==e){this._debug("平衡点为根节点，平衡完成");var t=de.generateDeleteBlanceMsgComplex(1,"re"),n=de.generateDeleteBlanceMsgComplex(1,"ca");return{reason:t,ca:n,focus:[{node:this}],op:"delete"}}var i=e.left==this?e.right:e.left,a=e.left==this;if(null==i)throw"Red-Black tree struct error";if(i.isRed){var r=[];r.push({node:e,left:a});var s=de.generateDeleteBlanceMsgComplex(2,"re"),o=de.generateDeleteBlanceMsgComplex(2,"op",[e.id,i.id,this.id,"".concat(a?"左":"右")]),l=de.generateDeleteBlanceMsgComplex(2,"ca"),h={ca:l,next:this,change:[i,e],rotated:r,focus:[{node:i},{node:e}],op:"delete"};i.changeToBlack(),e.changeToRed();var c=e.rotate(a);return this._debug(o),h["effected"]=c,h["operation"]=o,h["reason"]=s,h}if(e.isBlack){if((null==i.left||i.left.isBlack)&&(null==i.right||i.right.isBlack)){i.changeToRed();var d=de.generateDeleteBlanceMsgComplex(3,"re"),u=de.generateDeleteBlanceMsgComplex(3,"op",[i.id,e.id]),f=de.generateDeleteBlanceMsgComplex(3,"ca");return this._debug(u),{next:e,change:[i],ca:f,reason:d,operation:u,focus:[{node:i}],op:"delete"}}}else if((null==i.left||i.left.isBlack)&&(null==i.right||i.right.isBlack)){e.changeToBlack(),i.changeToRed();var g=de.generateDeleteBlanceMsgComplex(4,"op",[i.id,e.id]),p=de.generateDeleteBlanceMsgComplex(4,"ca");return this._debug(g),{ca:p,change:[i,e],operation:g,focus:[{node:i},{node:e}],op:"delete"}}var v=a?i.left:i.right;if(null!=v&&v.isRed){i.changeToRed(),v.changeToBlack();var m=de.generateDeleteBlanceMsgComplex(5,"re"),y=de.generateDeleteBlanceMsgComplex(5,"op",[i.id,v.id,this.id,"".concat(a?"右":"左")]),b=de.generateDeleteBlanceMsgComplex(5,"ca"),k=[];k.push({node:i,left:!a});var w=i.rotate(!a);return this._debug(y),{ca:b,next:this,change:[i,v],rotated:k,effected:w,operation:y,reason:m,focus:[{node:i},{node:v}],op:"delete"}}var x=a?i.right:i.left;if(null!=x&&x.isRed){var _=[],C=[];x.changeToBlack(),C.push({node:x}),_.push(x);var S=e.isBlack,B=i.isBlack;i.isRed?e.changeToRed():e.changeToBlack(),S?i.changeToBlack():i.changeToRed(),S&&e.isBlack||(_.push(e),C.push({node:e})),B&&i.isBlack||(_.push(i),C.push({node:i}));var N=[],T=de.generateDeleteBlanceMsgComplex(6,"op",[i.id,e.id,x.id,"".concat(a?"左":"右")]),P=de.generateDeleteBlanceMsgComplex(6,"ca");N.push({node:e,left:a});var M=e.rotate(a);return this._debug(T),{change:_,rotated:N,effected:M,ca:P,operation:T,focus:C,op:"delete"}}}},{key:"findNode",value:function(e){return e==this.id?this:this.id>e?null!=this.left?this.left.findNode(e):null:null!=this.right?this.right.findNode(e):null}},{key:"findNextNode",value:function(){if(this.right){var e=this.right;while(1){if(null==e.left)return e;e=e.left}}}},{key:"findPreNode",value:function(){if(this.left){var e=this.left;while(1){if(null==e.right)return e;e=e.right}}}},{key:"childIsSameColor",value:function(){if(null==this.left&&null==this.right)return!0;if(null!=this.left&&null!=this.right)return this.left.isRed&&this.right.isRed||this.left.isBlack&&this.right.isBlack;var e=null!=this.left?this.left:this.right;return e.isBlack}},{key:"deleteMe",value:function(){if(null==this.left&&null==this.right)return this.disConnectParent()}},{key:"insertNode",value:function(t){return t.id==this.id?(this._debug("找到更新点，使用".concat(t.toString(),"更新信息")),this.update(t),null):this.id>t.id?null!=this.left?this.left.insertNode(t):(this._debug("找到插入位置，插入节点".concat(t.toString(),"作为左节点")),e.createConnection(this,t),t):null!=this.right?this.right.insertNode(t):(this._debug("找到插入位置，插入节点".concat(t.toString(),"作为右节点")),e.createConnection(this,t,!1),t)}},{key:"blanceSubTreeAfterInsert",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(null==this.parent){if(this.isBlack){var t=de.generateInsertBlanceMsg(1,"re");return{reason:t,op:"insert"}}this._debug("平衡子树 : "),this._debug("该节点为根节点，修改颜色"),this.changeToBlack(),e.push(this);var n=de.generateInsertBlanceMsg(2,"re"),i=de.generateInsertBlanceMsg(2,"op",[this.id]);return{change:e,reason:n,operation:i,op:"insert",focus:[{node:this}]}}if(this.isBlack)return null;if(this._debug("平衡子树 : "),this.parent.isBlack){var a=de.generateInsertBlanceMsg(3,"ca");return this._debug(a),{ca:a,op:"insert",focus:[{node:this}]}}var r=this.parent.parent;if(null==r)throw"Blance sub-tree error, grande node can not be null";var s=r.left==this.parent?r.right:r.left,o=r.left==this.parent,l=this.parent.left==this;if(null!=s&&s.isRed){var h=de.generateInsertBlanceMsg(4,"op",[r.id,this.parent.id,s.id]),c=de.generateInsertBlanceMsg(4,"ca");return this._debug(h),s.changeToBlack(),this.parent.changeToBlack(),e.push(s),e.push(this.parent),r.changeToRed(),e.push(r),{next:r,change:e,ca:c,operation:h,op:"insert",focus:[{node:this},{node:s},{node:this.parent},{node:r}]}}var d,u,f,g,p=this.parent,v=[],m=[{node:this}];return o!=l?(g=de.generateInsertBlanceMsg(5,"re"),f=de.generateInsertBlanceMsg(5,"op",[this.parent.id,"".concat(l?"右":"左")]),u=de.generateInsertBlanceMsg(5,"ca"),this._debug(f),v.push({node:this.parent,left:!l}),d=this.parent.rotate(!l)):(f=de.generateInsertBlanceMsg(6,"op",[r.id,this.parent.id,"".concat(o?"右":"左")]),u=de.generateInsertBlanceMsg(6,"ca"),this._debug(f),this.parent.changeToBlack(),r.changeToRed(),e.push(r),e.push(this.parent),m.push({node:r}),m.push({node:this.parent}),v.push({node:r,left:!o}),d=r.rotate(!o)),p.isBlack?{change:e,effected:d,rotated:v,operation:f,reason:g,ca:u,op:"insert",focus:m}:{next:p,change:e,effected:d,rotated:v,operation:f,ca:u,reason:g,op:"insert",focus:m}}},{key:"_debug",value:function(e){console.log("".concat(this.toString()," - ").concat(e))}},{key:"toString",value:function(){return null!=this.value?"Node(".concat(this.id,")[").concat(this.value,"]"):"Node(".concat(this.id,")")}}],[{key:"createConnection",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n?e.left=t:e.right=t,t.parent=e}}]),e}(),fe=function(e){(0,se.Z)(n,e);var t=(0,oe.Z)(n);function n(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20;return(0,te.Z)(this,n),i=t.call(this,e,r,s),i.xPadding=o,i.yPadding=l,i._radius=a,i.x=0,i.y=0,i._red=255,i._green=255,i._blue=255,i.shadowBlur=3,i.shadowOffset=2,i._connectionsParams=new Array(2),i.scale=1,i.innerPercent=1,i}return(0,ne.Z)(n,[{key:"innerPercent",get:function(){return this._innerPercent},set:function(e){(e>=0||e<=1)&&this._innerPercent!=e&&(this._innerPercent=e,this._path=null)}},{key:"isLeftLeaf",get:function(){return null==this.parent||this.parent.left==this}},{key:"red",get:function(){return this._red},set:function(e){e!=this._red&&(this._red=e,this._colorStr=null)}},{key:"green",get:function(){return this._green},set:function(e){e!=this._green&&(this._green=e,this._colorStr=null)}},{key:"blue",get:function(){return this._blue},set:function(e){e!=this._blue&&(this._blue=e,this._colorStr=null)}},{key:"radius",get:function(){return this._radius},set:function(e){e!=this._radius&&(this._radius=e,this._path=null)}},{key:"_getColorString",value:function(){return null==this._colorStr&&(this._colorStr="rgb(".concat(this.red,",").concat(this.green,",").concat(this.blue,")")),this._colorStr}},{key:"_getPath",value:function(){if(null==this._path){this._path=new Path2D;var e=this._path,t=this.radius*this.innerPercent;if(this.innerPercent<=0)this._path.rect(-this.radius,-this.radius,2*this.radius,2*this.radius);else if(this.innerPercent>=1)this._path.arc(0,0,this.radius,0,2*Math.PI);else{var n=-this.radius,i=n;e.arc(t+n,t+i,t,Math.PI,Math.PI+Math.PI/2);var a=2*this.radius-t+n,r=i;e.lineTo(a,r),e.arc(a,r+t,t,-Math.PI/2,0),a=2*this.radius+n,r=2*this.radius-t+i,e.lineTo(a,r),e.arc(a-t,r,t,0,Math.PI/2),a=t+n,r=i+2*this.radius,e.lineTo(a,r),e.arc(a,r-t,t,Math.PI/2,Math.PI),e.closePath()}}return this._path}},{key:"calculateWidth",value:function(){var e=0,t=0;if(null!=this.left){var n=this.left.calculateWidth();e=n["width"],t=n["height"]}var i=0,a=0;if(null!=this.right){var r=this.right.calculateWidth();i=r["width"],a=r["height"]}var s=Math.max(e+i,2*this.radius+this.xPadding),o=Math.max(t,a)+2*this.radius+this.yPadding;return this.dimension={left:e,right:i,width:s,height:o},this.dimension}},{key:"layout",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(null!=this.left&&(e=this.left.layout({x:n.x,y:n.y+2*this.radius+this.yPadding},i)),null!=this.right&&(t=this.right.layout({x:n.x+this.dimension.left,y:n.y+2*this.radius+this.yPadding},i)),this.oldX=this.x,this.oldY=this.y,null!=e&&null!=t)this.x=(e+t)/2;else{var a=this.dimension.width;this.x=n.x+a/2}return this.y=n.y+this.radius,this.oldX==this.x&&this.oldY==this.y||i.push(this),this.x}},{key:"_getConnectionParams",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=n?0:1,a=this._connectionsParams[i];if(null==a){a={sourceX:this.x,sourceY:this.y,targetX:e,targetY:t},this._connectionsParams[i]=a;var r=new ce(e-this.x,t-this.y);a["radian"]=Math.atan2(r.y,r.x),r.normalize(),r.multiply(this.radius+this.shadowOffset);var s=new ce(this.x,this.y);s.plus(r),r.multiply(-1);var o=new ce(e,t);o.plus(r),a["sx"]=s.x,a["sy"]=s.y,a["ex"]=o.x,a["ey"]=o.y}else{var l=a.sourceX,h=a.sourceY,c=a.targetX,d=a.targetY;if(l!=this.x||h!=this.y||c!=e||d!=t)return this._connectionsParams[i]=null,this._getConnectionParams(e,t,n)}return a}},{key:"_getLeftConnectionParam",value:function(e,t){return this._getConnectionParams(e,t)}},{key:"_getRightConnectionParam",value:function(e,t){return this._getConnectionParams(e,t,!1)}},{key:"_drawConnectLine",value:function(e,t){null!=t&&this._drawConnection(e,this._getConnectionParams(t.x,t.y,t==this.left),t.scale)}},{key:"draw",value:function(e){this.scale>0&&(this._drawConnectLine(e,this.left),this._drawConnectLine(e,this.right),e.save(),e.translate(this.x,this.y),e.scale(this.scale,this.scale),e.fillStyle=this._getColorString(),e.save(),e.shadowBlur=this.shadowBlur,e.shadowOffsetX=this.shadowOffset,e.shadowOffsetY=this.shadowOffset,e.shadowColor="#433d3c",e.fill(this._getPath()),e.restore(),e.fillStyle=he.getBackGroundColor(),e.textBaseline="middle",e.textAlign="center",e.font="".concat(Math.floor(.9*this.radius),"px Arial"),e.fillText("".concat(this.id),0,0,2*this.radius),e.restore()),this.left&&this.left.draw(e),this.right&&this.right.draw(e)}},{key:"_drawConnection",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!(i<=0)){e.save(),e.globalAlpha*=i,e.beginPath(),e.moveTo(t.sx,t.sy),e.lineTo(t.ex,t.ey);var a=he.getLineColor();e.strokeStyle=a,e.fillStyle=a,e.lineWidth=2,e.stroke(),e.translate(t.ex,t.ey),e.rotate(t.radian-Math.PI),e.fill(n._getArrowPath(this.radius/2)),e.restore()}}},{key:"changeToBlack",value:function(){this.recordOldColor();var e=he.getBlackColor();this.red=e.red,this.green=e.green,this.blue=e.blue,(0,ae.Z)((0,re.Z)(n.prototype),"changeToBlack",this).call(this)}},{key:"changeToRed",value:function(){this.recordOldColor();var e=he.getRedColor();this.red=e.red,this.green=e.green,this.blue=e.blue,(0,ae.Z)((0,re.Z)(n.prototype),"changeToRed",this).call(this)}},{key:"recordOldColor",value:function(){this.oldRed=this.red,this.oldGreen=this.green,this.oldBlue=this.blue}},{key:"reverseColor",value:function(){var e=this.red;this.red=this.oldRed,this.oldRed=e,e=this.blue,this.blue=this.oldBlue,this.oldBlue=e,e=this.green,this.green=this.oldGreen,this.oldGreen=e}}],[{key:"_getArrowPath",value:function(e){if(null==this._arrowPath){this._arrowPath=new Path2D;var t=this._arrowPath;t.moveTo(0,0);var n=e,i=Math.floor(Math.cos(30/180*Math.PI)*n),a=Math.floor(Math.sin(30/180*Math.PI)*n);t.lineTo(i,a),t.lineTo(i,Math.floor(a-n)),t.closePath()}return this._arrowPath}}]),n}(ue);(0,le.Z)(fe,"_arrowPath",void 0);var ge=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{nodeRadius:20,nodeXPadding:10,nodeYPadding:20,padding:{left:0,right:0,top:0,bottom:0}};(0,te.Z)(this,e),this.nodeRadius=null==t.nodeRadius?20:t.nodeRadius,this.nodeXPadding=null==t.nodeXPadding?10:t.nodeXPadding,this.nodeYPadding=null==t.nodeYPadding?20:t.nodeYPadding,this.padding=null==t.padding?{left:0,right:0,top:0,bottom:0}:t.padding,this._tree=new ie,this.width=0,this.height=0}return(0,ne.Z)(e,[{key:"root",get:function(){return this._tree.root},set:function(e){this._tree.root=e}},{key:"updateSize",value:function(e){this.oldWidth=this.width,this.oldHeight=this.height,this.width=e.width,this.height=e.height}},{key:"insertNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new fe(e,this.nodeRadius,t.value,!1,this.nodeXPadding,this.nodeYPadding);n.changeToRed();var i=this._tree.insertNode(n);return i}},{key:"findNode",value:function(e){return this._tree.findNode(e)}},{key:"draw",value:function(e){e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.translate(e.canvas.width/2,e.canvas.height/2);var t=1;this.width>canvas.width&&(t=Math.min(canvas.width/this.width,t)),this.height>canvas.height&&(t=Math.min(canvas.height/this.height,t)),1!=t&&e.scale(t,t),e.translate(-this.width/2+this.padding.left,-this.height/2+this.padding.top),this._tree._findRoot(),null!=this.root&&this.root.draw(e),e.restore()}},{key:"layout",value:function(){var e=this._tree._findRoot();if(null==e)return null;var t=e.calculateWidth(),n=[];return e.layout({x:0,y:0},n),{dirty:n,region:{width:t.width+this.padding.left+this.padding.right,height:t.height-this.nodeYPadding+this.padding.top+this.padding.bottom}}}},{key:"_constriantNodePosition",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(null!=e){e.oldX=e.x,e.x=t.x,e.oldY=e.y,e.y=t.y,e.oldX==e.x&&e.oldY==e.y||i.push(e);var a=n/2;this._constriantNodePosition(e.left,{x:t.x-a,y:t.y+2*e.radius+this.nodeYPadding},a,i),this._constriantNodePosition(e.right,{x:t.x+a,y:t.y+2*e.radius+this.nodeYPadding},a,i)}}}]),e}(),pe=(n(4197),n(2990),n(8927),n(3105),n(5035),n(4345),n(7174),n(2846),n(4731),n(7209),n(6319),n(8867),n(7789),n(3739),n(9368),n(4483),n(2056),n(3462),n(678),n(7462),n(3824),n(5021),n(2974),n(5016),4),ve=.001,me=1e-7,ye=10,be=11,ke=1/(be-1),we="function"===typeof Float32Array,xe=function(){function e(t,n,i,a){if((0,te.Z)(this,e),!(0<=t&&t<=1&&0<=i&&i<=1))throw new Error("bezier x values must be in [0, 1] range");if(this.mY1=n,this.mY2=a,this.mX1=t,this.mX2=i,this.linearEasing=!1,t===n&&i===a)this.linearEasing=!0;else{this.sampleValues=we?new Float32Array(be):new Array(be);for(var r=0;r<be;++r)this.sampleValues[r]=this.calcBezier(r*ke,t,i)}}return(0,ne.Z)(e,[{key:"easing",value:function(e){return 0===e||1===e||this.linearEasing?e:this.calcBezier(this.getTForX(e,this.mX1,this.mX2),this.mY1,this.mY2)}},{key:"getTForX",value:function(e,t,n){for(var i=0,a=1,r=be-1,s=this.sampleValues;a!==r&&s[a]<=e;++a)i+=ke;--a;var o=(e-s[a])/(s[a+1]-s[a]),l=i+o*ke,h=this.getSlope(l,t,n);return h>=ve?this.newtonRaphsonIterate(e,l,t,n):0===h?l:this.binarySubdivide(e,i,i+ke,t,n)}},{key:"A",value:function(e,t){return 1-3*t+3*e}},{key:"B",value:function(e,t){return 3*t-6*e}},{key:"C",value:function(e){return 3*e}},{key:"calcBezier",value:function(e,t,n){return((this.A(t,n)*e+this.B(t,n))*e+this.C(t))*e}},{key:"getSlope",value:function(e,t,n){return 3*this.A(t,n)*e*e+2*this.B(t,n)*e+this.C(t)}},{key:"binarySubdivide",value:function(e,t,n,i,a){var r,s,o=0;do{s=t+(n-t)/2,r=this.calcBezier(s,i,a)-e,r>0?n=s:t=s}while(Math.abs(r)>me&&++o<ye);return s}},{key:"newtonRaphsonIterate",value:function(e,t,n,i){for(var a=0;a<pe;++a){var r=this.getSlope(t,n,i);if(0===r)return t;var s=this.calcBezier(t,n,i)-e;t-=s/r}return t}}]),e}(),_e=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x1:0,y1:0,x2:0,y2:0};(0,te.Z)(this,e),this.duration=t,this.timingFunction=new xe(n.x1,n.y1,n.x2,n.y2),this.figures=[],this.loop=!1,this.loopWithReverse=!1}return(0,ne.Z)(e,[{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4?arguments[4]:void 0,r=i-n;0!=r&&this.figures.push({figure:e,prop:t,start:n,end:i,delta:r,processor:a})}},{key:"forward",value:function(e){var t=this;return this.running?Promise.resolve():new Promise((function(n,i){var a=Math.floor(t.duration/16.6);t._run(e,a,0,!1,n)}))}},{key:"stop",value:function(){this._stop=!0}},{key:"reverse",value:function(e){var t=this;return this.running?Promise.resolve():new Promise((function(n,i){var a=Math.floor(t.duration/16.6);t._run(e,a,0,!0,n)}))}},{key:"_run",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0;if(this._stop)r();else{this._stop=!1;var s=i/t,o=this.timingFunction.easing(s);if(this.figures.forEach((function(e){if(0!=e.delta){var t=e.figure,n=e.prop;if(a){var i=e.end-e.delta*o;e.processor&&(i=e.processor(i)),t[n]=i}else{var r=e.delta*o+e.start;e.processor&&(r=e.processor(r)),t[n]=r}}})),i++,e&&e(o),i>t)return this.running=!1,this.loop?(this.loopWithReverse&&(a=!a),void this._run(e,t,0,a,r)):void r();requestAnimationFrame((function(){n._run(e,t,i,a,r)}))}}}]),e}(),Ce=function(){function e(t){(0,te.Z)(this,e),this.refNode=t}return(0,ne.Z)(e,[{key:"nodeBounds",get:function(){return this._nodeBounds}},{key:"refNode",get:function(){return this._r},set:function(e){if(this._r!=e){this._r=e;var t=this.refNode.x-this.refNode.radius,n=this.refNode.y-this.refNode.radius,i=t+2*this.refNode.radius,a=n+2*this.refNode.radius;this._nodeBounds={left:t,top:n,right:i,bottom:a},this.whenRefNodeChange()}}},{key:"whenRefNodeChange",value:function(){}},{key:"dispose",value:function(){}}]),e}(),Se=function(e){(0,se.Z)(n,e);var t=(0,oe.Z)(n);function n(e){var i;return(0,te.Z)(this,n),i=t.call(this,e),i.opacity=1,i}return(0,ne.Z)(n,[{key:"_getPaths",value:function(){if(null==this._paths){this._paths=[new Path2D,new Path2D,new Path2D];var e=.8*this.refNode.radius,t=2*this.refNode.radius-e,n=this._paths[0];n.rect(-t/2,-t/2,t,t);var i=this._paths[1];i.rect((-t-e)/2,(-t-e)/2,e,e);var a=this._paths[2];a.rect((t-e)/2,(t-e)/2,e,e)}return this._paths}},{key:"whenRefNodeChange",value:function(){this._paths&&(this._paths.length=0),this._paths=null}},{key:"draw",value:function(e){if(0!=this.opacity){e.save(),e.translate(this.refNode.x,this.refNode.y),e.scale(.8,.8),e.globalAlpha=this.opacity;var t=this._getPaths();e.strokeStyle=he.getLineColor();var n=e.lineWidth;e.lineWidth=3,e.stroke(t[0]),e.lineWidth=n,e.fillStyle=he.getBlackColorString(),e.fill(t[1]),e.stroke(t[1]),e.fillStyle=he.getRedColorString(),e.fill(t[2]),e.stroke(t[2]),e.restore()}}},{key:"dispose",value:function(){this._paths.length=0,this._paths=null}}]),n}(Ce),Be=function(){function e(t,n){(0,te.Z)(this,e),this.brTree=t,this.width=0,this.opacity=0,this.ctx=n,this.effects=[],this.scale=1}return(0,ne.Z)(e,[{key:"add",value:function(e){this.effects.push(e)}},{key:"draw",value:function(){var e=this.ctx;e.save(),e.clearRect(0,0,e.canvas.width,e.canvas.height),this.opacity>0&&(e.globalAlpha=this.opacity,e.fillStyle="black",e.fillRect(0,0,e.canvas.width,e.canvas.height)),e.translate(e.canvas.width/2,e.canvas.height/2);var t=1;this.scale=1,this.brTree.width>e.canvas.width&&(t=Math.min(e.canvas.width/this.brTree.width,t)),this.brTree.height>e.canvas.height&&(t=Math.min(e.canvas.height/this.brTree.height,t)),1!=t&&(this.scale=t,e.scale(t,t)),e.translate(-this.brTree.width/2,-this.brTree.height/2),e.globalAlpha=1,this.effects.forEach((function(t){t.draw(e)})),e.restore()}},{key:"clean",value:function(){var e=this.ctx;e.clearRect(0,0,e.canvas.width,e.canvas.height),this.effects.forEach((function(e){e.dispose()})),this.effects.length=0}}]),e}(),Ne=function(e){(0,se.Z)(n,e);var t=(0,oe.Z)(n);function n(e,i){var a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:he.getLightColor();return(0,te.Z)(this,n),a=t.call(this,e),a.parent=i,a.radiusPercent=1,a.shadowColor=r,a}return(0,ne.Z)(n,[{key:"_getPath",value:function(){if(null==this._path){this._path=new Path2D;var e=this._path,t=this.refNode.radius;e.arc(0,0,Math.floor(2*t),0,2*Math.PI),e.closePath()}return this._path}},{key:"whenRefNodeChange",value:function(){this._path=null}},{key:"draw",value:function(e){if(!(this.radiusPercent<=0)){e.save(),e.globalAlpha=.5;var t=this.refNode;e.translate(t.x+e.canvas.width,t.y+e.canvas.height),e.globalAlpha=this.radiusPercent,e.shadowBlur=2*t.radius*this.parent.scale,e.shadowOffsetX=-e.canvas.width*this.parent.scale,e.shadowOffsetY=-e.canvas.height*this.parent.scale,e.shadowColor=this.shadowColor,e.fill(this._getPath()),e.restore()}}},{key:"dispose",value:function(){this.parent=null}}]),n}(Ce),Te=Math.PI/4,Pe=function(e){(0,se.Z)(n,e);var t=(0,oe.Z)(n);function n(e){var i,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,te.Z)(this,n),i=t.call(this,e),i.left=a,i.progress=1,i}return(0,ne.Z)(n,[{key:"whenRefNodeChange",value:function(){this._arrow=null}},{key:"_getArrowPath",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.refNode.radius/5;if(null==this._arrow){this._arrow=new Path2D;var t=this._arrow,n=1.6*e;t.moveTo(0,n);var i=n/Math.sin(30/180*Math.PI),a=i*Math.cos(30/180*Math.PI),r=0;t.lineTo(a,r),t.lineTo(0,-n),t.closePath()}return this._arrow}},{key:"draw",value:function(e){if(!(this.progress<=0)){e.save(),e.translate(this.refNode.x,this.refNode.y);var t=1.8*this.refNode.radius;e.beginPath();var n=this.refNode.radius/5;if(e.lineWidth=n,e.strokeStyle=he.getFrontLineColor(),e.lineCap="round",this.left){var i=-(Math.PI+Math.PI/2),a=this.progress*i+Te;e.arc(0,0,t,Te,a,!0),e.stroke();var r=Math.cos(a)*t,s=Math.sin(a)*t;e.translate(r,s),e.rotate(a-Math.PI/2),e.fillStyle=he.getFrontLineColor(),e.fill(this._getArrowPath(n))}else{var o=Math.PI/2+Math.PI,l=this.progress*o+(Math.PI-Te);e.arc(0,0,t,Math.PI-Te,l,!1),e.stroke();var h=Math.cos(l)*t,c=Math.sin(l)*t;e.translate(h,c),e.rotate(l+Math.PI/2),e.fillStyle=he.getFrontLineColor(),e.fill(this._getArrowPath(n))}e.restore()}}}]),n}(Ce),Me=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{left:0,top:0,bottom:0,right:0};(0,te.Z)(this,e),this.ctx=t,this.fctx=n,this.brTree=new ge({nodeRadius:i,nodeXPadding:a,nodeYPadding:r,padding:s}),this.effectLayer=new Be(this.brTree,this.fctx),this._eventHandler={},this.nodeIds=[]}return(0,ne.Z)(e,[{key:"on",value:function(e,t){if("blanceStepOver"!=e)if("blanceStepStart"!=e){var n=this._eventHandler[e];null==n&&(this._eventHandler[e]=[],n=this._eventHandler[e]),n.push(t)}else this._blanceStartHandler=t;else this._blanceOverHandler=t}},{key:"_fireBlanceStepStart",value:function(e){if(this._blanceStartHandler)return this._blanceStartHandler(e)}},{key:"_fireBlanceStepOver",value:function(){if(this._blanceOverHandler)return this._blanceOverHandler()}},{key:"_fireOperationStart",value:function(){var e=this._eventHandler["operationStart"];null!=e&&e.forEach((function(e){e()}))}},{key:"_fireOperationOver",value:function(e){var t=this._eventHandler["operationOver"];null!=t&&t.forEach((function(t){t(e)}))}},{key:"generate",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this.brTree.root=null,this.nodeIds.length=0,this.brTree.draw(this.ctx),this._fireOperationStart();for(var n=0;n<t;){var i=Math.floor(1e3*Math.random());if(null==this.brTree.root)this.brTree.insertNode(i),this.recordId(i);else{var a=this.brTree.insertNode(i);if(null==a)continue;this.recordId(i);var r=a.blanceSubTreeAfterInsert();while(null!=r&&null!=r.next)r=r.next.blanceSubTreeAfterInsert()}n++}var s=this.brTree.width/2,o=this.brTree.height/2;function l(e,t){null!=e&&(e.oldX=s,e.oldY=o,t.add(e,"innerPercent",e.innerPercent,e.isLeftLeaf?1:0),l(e.left,t),l(e.right,t))}var h=this.brTree.layout(),c=new _e(500,{x1:.37,y1:-.47,x2:.61,y2:1.45});if(null==h)this.brTree.updateSize({width:0,height:0});else{var d=h.dirty,u=h.region;l(this.brTree.root,c),this.brTree.updateSize(u),d.forEach((function(t){e.registPositionChange(c,t)}))}this._registerTreeDimensionChange(c),c.forward((function(){e.brTree.draw(e.ctx)})).then((function(){e._fireOperationOver({op:"generate",num:t,type:"success"})}))}},{key:"randomDelete",value:function(){if(this.nodeIds.length>0){var e=Math.floor(Math.random()*this.nodeIds.length),t=this.nodeIds[e];this.deleteNode(t)}}},{key:"deleteNode",value:function(e){var t=this;if(!isNaN(e)){this._fireOperationStart();var n=this.brTree.findNode(e);if(null!=n){var i=n.findReplaceNode(),a=i.replace,r=i.blance;console.log("删除节点".concat(n,":替换节点").concat(a));var s=[];s.push({node:a,color:he.getFocusColor()}),a.id!=n.id&&s.push({node:n,color:he.getSecondColor()}),i.change&&i.change.forEach((function(e){return s.push({node:e})})),i["focus"]=s,i.replaceNode=a,i.deleteNode=n;var o=de.generateDeleteBlanceAdditionalMsg(1,[a.id,n.id]);return a.id==n.id&&(o=de.generateDeleteBlanceAdditionalMsg(2,[a.id])),r?this.blanceAfterDelete(a,n,a).then((function(){o=de.generateDeleteBlanceAdditionalMsg(3)+o,t._deleteReplaceNode(a,n,{focus:s,deleteNode:n,replaceNode:a,change:i.change,operation:o}).then((function(){t._fireOperationOver({op:"delete",id:e,type:"success"})}))})):(null!=i.operation&&(i.operation+=o),this._deleteReplaceNode(a,n,i).then((function(){t._fireOperationOver({op:"delete",id:e,type:"success"})}))),this.removeId(e),e}return this._fireOperationOver({op:"delete",id:e,type:"error"}),null}}},{key:"_deleteReplaceNode",value:function(e,t,n){var i=this;return new Promise((function(a,r){i._excuteProcessAnimated(t,(function(){return n}),(function(){var n=new _e(500,{x1:.37,y1:-.47,x2:.61,y2:1.45});n.add(e,"scale",1,0),n.add(t,"id",t.id,e.id,(function(e){return Math.floor(e)})),n.forward((function(n){if(i.brTree.draw(i.ctx),1==n){var r=null==e.left?e.right:e.left;t.id=e.id,t.value=e.value;var s=e.parent,o=[];r&&(o.push(r),r.disConnectParent());var l=e.disConnectParent();null!=s?(l?s.left=r:s.right=r,r&&(r.parent=s)):i.brTree.root=r,i._refreshTreeAnimated(null,o,null).then((function(){a()}))}}))}),!1)}))}},{key:"recordId",value:function(e){-1==this.nodeIds.indexOf(e)&&this.nodeIds.push(e)}},{key:"removeId",value:function(e){var t=this.nodeIds.indexOf(e);-1!=t&&this.nodeIds.splice(t,1)}},{key:"addNode",value:function(e){var t=this;if(isNaN(e))return null;this._fireOperationStart();var n=this.brTree.insertNode(e);return null==n?(this._fireOperationOver({op:"update",id:e,type:"warning"}),null):(this.recordId(e),this._refreshTreeAnimated(n).then((function(){return t.blanceAfterInsert(n,n)})).then((function(){t._fireOperationOver({op:"insert",id:e,type:"success"})})),e)}},{key:"registPositionChange",value:function(e,t){e.add(t,"x",t.oldX,t.x),e.add(t,"y",t.oldY,t.y)}},{key:"registColorChange",value:function(e,t){e.add(t,"red",t.oldRed,t.red),e.add(t,"green",t.oldGreen,t.green),e.add(t,"blue",t.oldBlue,t.blue)}},{key:"refreshEffectLayerWithAnimation",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=function(e){i&&t.effectLayer.draw(),1==e&&(a||t.effectLayer.clean())};return n?e.reverse(r):e.forward(r)}},{key:"fadeInEffectLayer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,n=new _e(t);return n.add(this.effectLayer,"opacity",0,.5),n.forward((function(t){e.effectLayer.draw()}))}},{key:"fadeOutEffectLayer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300,n=new _e(t);return n.add(this.effectLayer,"opacity",this.effectLayer.opacity,0),n.forward((function(){e.effectLayer.draw()}))}},{key:"blanceAfterDelete",value:function(e,t,n){return this._excuteProcessAnimated(e,(function(e){var i=e.blanceSubTreeAfterDelete();if(i.deleteNode=t,i.replaceNode=n,i.focus){for(var a=!1,r=!1,s=!1,o=0;o<i.focus.length;o++){var l=i.focus[o];if(l.id==t.id){l["color"]=he.getFocusColor(),a=!0;break}if(l.id==n.id){r=!0,l["color"]=he.getSecondColor();break}if(l.id==e.id){s=!0,l["color"]=he.getLightSecondColor();break}}a||i.focus.push({node:t,color:he.getFocusColor()}),r||t.id==n.id||i.focus.push({node:n,color:he.getSecondColor()}),s||t.id==e.id||n.id==e.id||i.focus.push({node:e,color:he.getLightSecondColor()})}return i}))}},{key:"_nextStep",value:function(){this._blanceEffectAnimation&&(this._blanceEffectAnimation.loop=!1)}},{key:"_excuteProcessAnimated",value:function(e,t,n){var i=this,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise((function(r,s){if(null==e||null==t)return n&&n(),r();var o=t(e);if(null==o)return n&&n(),r();i.fadeInEffectLayer().then((function(){var t=i._createBlanceStepEffectAnimation(o.focus,o);return t.loop=!0,t.loopWithReverse=!0,i._blanceEffectAnimation=t,i._fireBlanceStepStart({current:e,blance:o}),new Promise((function(e,n){t.forward((function(){return i.effectLayer.draw()})).then((function(){e()}))}))})).then((function(){return i._blanceEffectAnimation=null,i._fireBlanceStepOver(),i.effectLayer.clean(),i.fadeOutEffectLayer()})).then((function(){if(a)return i._refreshTreeAnimated(null,o.effected,o.change)})).then((function(){var e=o.next;if(null==e)return i.effectLayer.clean(),n&&n(),r();setTimeout((function(){i._excuteProcessAnimated(e,t,n,a).then((function(){r()}))}),500)}))}))}},{key:"_createBlanceStepEffectAnimation",value:function(e,t){var n=this,i=new _e(600);return null!=e&&e.forEach((function(e){var t=new Ne(e.node,n.effectLayer,e.color);i.add(t,"radiusPercent",0,1),n.effectLayer.add(t)})),t.change&&t.change.forEach((function(e){var t=new Se(e);n.effectLayer.add(t),i.add(t,"opacity",0,1)})),t.rotated&&t.rotated.forEach((function(e){var t=e.left,a=e.node,r=new Pe(a,t);i.add(r,"progress",0,1),n.effectLayer.add(r)})),i}},{key:"blanceAfterInsert",value:function(e,t){return this._excuteProcessAnimated(e,(function(e){var n=e.blanceSubTreeAfterInsert();if(n.insertNode=t,n.focus){for(var i=!1,a=!1,r=0;r<n.focus.length;r++){var s=n.focus[r];if(s.id==t.id){s["color"]=he.getFocusColor(),i=!0;break}if(s.id==e.id){s["color"]=he.getSecondColor(),a=!0;break}}i||n.focus.push({node:t,color:he.getFocusColor()}),a||t.id==e.id||n.focus.push({node:e,color:he.getSecondColor()})}return n}))}},{key:"_registerTreeDimensionChange",value:function(e){e.add(this.brTree,"width",this.brTree.oldWidth,this.brTree.width),e.add(this.brTree,"height",this.brTree.oldHeight,this.brTree.height)}},{key:"_refreshTreeAnimated",value:function(e,t,n){var i=this,a=this.brTree.layout(),r=new _e(500,{x1:.37,y1:-.47,x2:.61,y2:1.45});if(null==a)this.brTree.updateSize({width:0,height:0});else{var s=a.dirty,o=a.region;this.brTree.updateSize(o),s.forEach((function(t){null!=e&&e.id==t.id||i.registPositionChange(r,t)})),e&&(r.add(e,"scale",0,1),r.add(e,"innerPercent",e.innerPercent,e.isLeftLeaf?1:0)),n&&n.forEach((function(e){i.registColorChange(r,e)})),t&&t.forEach((function(t){null!=e&&e.id==t.id||r.add(t,"innerPercent",t.innerPercent,t.isLeftLeaf?1:0)}))}return this._registerTreeDimensionChange(r),r.forward((function(){i.brTree.draw(i.ctx)}))}}]),e}(),Ie={id:"toast-container",class:"toast-container"},We={id:"toast",class:"toast hide",role:"alert","aria-live":"assertive","aria-atomic":"true"},Re={class:"toast-header"},Oe={class:"me-auto"},$e=(0,r.Wm)("i",{class:"fas fa-info-circle",style:{"margin-right":"0.2em"}},null,-1),Ae={class:"toast-body"},De={id:"message-container"},Le={key:0,id:"blance-node",class:"border-bottom"},Ke={class:"text-dark"},Ee={style:{"margin-left":"5px"}},Ze={key:1,class:"node-text-container"},ze={id:"blance-node",class:"border-bottom"},He={class:"text-dark"},Ye={style:{"margin-left":"5px"}},je={id:"blance-node",style:{"justify-content":"flex-end"}},Fe={class:"text-dark"},Xe={style:{"margin-left":"5px"}},Ge={class:"node-text-container"},Ue={id:"blance-node",class:"border-bottom"},qe={class:"text-dark"},Ve={style:{"margin-left":"5px"}},Je={id:"blance-node",style:{"justify-content":"flex-end"}},Qe={class:"text-dark"},et={style:{"margin-left":"5px"}},tt={key:2,id:"blance-operation",class:"border-bottom"},nt={class:"text-primary"},it=(0,r.Wm)("i",{class:"fas fa-tasks",style:{"margin-right":"0.2em"}},null,-1),at={key:3,id:"blance-reason",class:"border-bottom"},rt={class:"text-primary"},st=(0,r.Wm)("i",{class:"far fa-bell",style:{"margin-right":"0.2em"}},null,-1),ot={key:4,id:"blance-operation"},lt={class:"text-primary"},ht=(0,r.Wm)("i",{class:"far fa-question-circle",style:{"margin-right":"0.2em"}},null,-1),ct={id:"toast-footer",class:"mt-2 pt-2 border-top"},dt=(0,r.Wm)("i",{class:"fas fa-pause-circle"},null,-1),ut=(0,r.Wm)("i",{class:"fas fa-arrow-circle-right"},null,-1);function ft(e,t,n,i,a,s){return(0,r.wg)(),(0,r.j4)("div",Ie,[(0,r.Wm)("div",We,[(0,r.Wm)("div",Re,[(0,r.Wm)("strong",Oe,[$e,(0,r.Uk)((0,l.zw)(s.tipName),1)]),(0,r.Wm)("small",{class:s.tipTitle.color},(0,l.zw)(s.tipTitle.msg),3)]),(0,r.Wm)("div",Ae,[(0,r.Wm)("div",De,[s.hasInsertNode?((0,r.wg)(),(0,r.j4)("div",Le,[(0,r.Wm)("strong",Ke,(0,l.zw)(e.$t("".concat(a.msgKey,"insertNode"))+":"),1),(0,r.Wm)("small",Ee,(0,l.zw)(s.insertNodeText),1)])):(0,r.ry)("",!0),s.hasDeleteNode&&s.hasReplaceNode?((0,r.wg)(),(0,r.j4)("div",Ze,[(0,r.Wm)("div",ze,[(0,r.Wm)("strong",He,(0,l.zw)(e.$t("".concat(a.msgKey,"deleteNode"))+":"),1),(0,r.Wm)("small",Ye,(0,l.zw)(s.deleteNodeText),1)]),(0,r.Wm)("div",je,[(0,r.Wm)("strong",Fe,(0,l.zw)(e.$t("".concat(a.msgKey,"replaceNode"))+":"),1),(0,r.Wm)("small",Xe,(0,l.zw)(s.replaceNodeText),1)])])):(0,r.ry)("",!0),(0,r.Wm)("div",Ge,[(0,r.Wm)("div",Ue,[(0,r.Wm)("strong",qe,(0,l.zw)(e.$t("".concat(a.msgKey,"currentBlance"))+":"),1),(0,r.Wm)("small",Ve,(0,l.zw)(s.currentBlanceText),1)]),(0,r.Wm)("div",Je,[(0,r.Wm)("strong",Qe,(0,l.zw)(e.$t("".concat(a.msgKey,"nextBlance"))+":"),1),(0,r.Wm)("small",et,(0,l.zw)(s.nextBlanceText),1)])]),s.nullCase?(0,r.ry)("",!0):((0,r.wg)(),(0,r.j4)("div",tt,[(0,r.Wm)("div",nt,[it,(0,r.Wm)("strong",null,(0,l.zw)(e.$t("".concat(a.msgKey,"case"))+":"),1)]),(0,r.Wm)("small",null,[(0,r.Wm)("div",{innerHTML:s.ca},null,8,["innerHTML"])])])),s.nullOp?(0,r.ry)("",!0):((0,r.wg)(),(0,r.j4)("div",at,[(0,r.Wm)("div",rt,[st,(0,r.Wm)("strong",null,(0,l.zw)(e.$t("".concat(a.msgKey,"process"))+":"),1)]),(0,r.Wm)("small",null,[(0,r.Wm)("div",{innerHTML:s.operation},null,8,["innerHTML"])])])),s.nullReason?(0,r.ry)("",!0):((0,r.wg)(),(0,r.j4)("div",ot,[(0,r.Wm)("div",lt,[ht,(0,r.Wm)("strong",null,(0,l.zw)(e.$t("".concat(a.msgKey,"reason"))+":"),1)]),(0,r.Wm)("small",null,[(0,r.Wm)("div",{innerHTML:s.reason},null,8,["innerHTML"])])]))]),(0,r.Wm)("div",ct,[(0,r.Wm)("button",{type:"button",disabled:a.pause,onClick:t[1]||(t[1]=function(){return s.pauseHere&&s.pauseHere.apply(s,arguments)}),class:"btn btn-secondary btn-sm"},[dt,(0,r.Uk)(" "+(0,l.zw)(e.$t("".concat(a.msgKey,"pause"))),1)],8,["disabled"]),(0,r.Wm)("button",{type:"button",class:"btn btn-primary btn-sm",onClick:t[2]||(t[2]=function(){return s.nextStep&&s.nextStep.apply(s,arguments)})},[ut,(0,r.Uk)(" "+(0,l.zw)(s.nextString),1)])])])])])}var gt={name:"Tip",mounted:function(){var e=this.$el.querySelector("#toast");this.toast=new bootstrap.Toast(e,{autohide:!1})},emits:["next-step"],methods:{_startCount:function(){var e=this;if(this.currentCount<=0)return null!=this.intervalId&&clearTimeout(this.intervalId),void this.nextStep();this.currentCount--,this.intervalId=setTimeout((function(){e._startCount()}),1e3)},nextStep:function(){this.hideTip(),this.$emit("next-step")},showTip:function(e){this.currentCount=this.waitTime,this.currentBlance=e.current,this.blance=e.blance,this.toast.show(),this.pause=!1,this._startCount()},hideTip:function(){null!=this.intervalId&&clearTimeout(this.intervalId),this.currentBlance=null,this.blance=null,this.toast.hide()},pauseHere:function(){null!=this.intervalId&&clearTimeout(this.intervalId),this.pause=!0}},computed:{nextString:function(){var e=this.$t("".concat(this.msgKey,"forward"));return this.pause||(e="".concat(this.$t("".concat(this.msgKey,"forward"))," (").concat(this.currentCount,")")),e},hasDeleteNode:function(){return null!=this.blance&&null!=this.blance.deleteNode},hasReplaceNode:function(){return null!=this.blance&&null!=this.blance.replaceNode},hasInsertNode:function(){return null!=this.blance&&null!=this.blance.insertNode},deleteNodeText:function(){if(this.hasDeleteNode)return this.blance.deleteNode.id},replaceNodeText:function(){if(this.hasReplaceNode)return this.blance.replaceNode.id},insertNodeText:function(){if(this.hasInsertNode)return this.blance.insertNode.id},currentBlanceText:function(){return null==this.currentBlance?"":this.currentBlance.id},nextBlanceText:function(){return null==this.blance?"":null==this.blance.next?this.$t("".concat(this.msgKey,"none")):this.blance.next.id},tipTitle:function(){return null==this.blance?"":null==this.blance.next?{msg:this.$t("".concat(this.msgKey,"blanced")),color:"text-success"}:{msg:this.$t("".concat(this.msgKey,"notblanced")),color:"text-danger"}},tipName:function(){return null==this.blance?"":"insert"==this.blance.op?this.$t("".concat(this.msgKey,"insertBlanceOp")):this.$t("".concat(this.msgKey,"deleteBlanceOp"))},nullReason:function(){if(null==this.blance)return!0;var e=this.blance.reason;return null==e||0==e.length},nullOp:function(){if(null==this.blance)return!0;var e=this.blance.operation;return null==e||0==e.length},nullCase:function(){if(null==this.blance)return!0;var e=this.blance.ca;return null==e||0==e.length},reason:function(){if(this.nullReason)return"";var e=this.blance.reason;return e=e.replaceAll(this.$t("".concat(this.msgKey,"redKey")),'<span class="text-danger" style="font-weight:bold">'.concat(this.$t("".concat(this.msgKey,"redKey")),"</span>")),e=e.replaceAll(this.$t("".concat(this.msgKey,"blackKey")),'<span class="text-black" style="font-weight:bold">'.concat(this.$t("".concat(this.msgKey,"blackKey")),"</span>")),e},ca:function(){if(this.nullCase)return"";var e=this.blance.ca;return e=e.replaceAll(this.$t("".concat(this.msgKey,"redKey")),'<span class="text-danger" style="font-weight:bold">'.concat(this.$t("".concat(this.msgKey,"redKey")),"</span>")),e=e.replaceAll(this.$t("".concat(this.msgKey,"blackKey")),'<span class="text-black" style="font-weight:bold">'.concat(this.$t("".concat(this.msgKey,"blackKey")),"</span>")),e},operation:function(){if(this.nullOp)return"";var e=this.blance.operation;return e=e.replaceAll(this.$t("".concat(this.msgKey,"lRotateKey")),'<span class="text-primary" style="font-weight:bold">'.concat(this.$t("".concat(this.msgKey,"lRotateKey")),"</span>")),e=e.replaceAll(this.$t("".concat(this.msgKey,"rRotateKey")),'<span class="text-success" style="font-weight:bold">'.concat(this.$t("".concat(this.msgKey,"rRotateKey")),"</span>")),e=e.replaceAll(this.$t("".concat(this.msgKey,"redKey")),'<span class="text-danger" style="font-weight:bold">'.concat(this.$t("".concat(this.msgKey,"redKey")),"</span>")),e=e.replaceAll(this.$t("".concat(this.msgKey,"blackKey")),'<span class="text-black" style="font-weight:bold">'.concat(this.$t("".concat(this.msgKey,"blackKey")),"</span>")),e}},data:function(){return{pause:!1,currentCount:0,blance:null,currentBlance:null,msgKey:"default.tip."}},props:{waitTime:{type:Number,default:6}}};gt.render=ft;var pt=gt,vt={props:{radius:{type:Number,default:22},xpadding:{type:Number,default:14},ypadding:{type:Number,default:30}},components:{Tip:pt},data:function(){return{tipMsg:"",op:"",tipColor:"bg-success",tipTextColor:"text-white",tipIcon:"fas fa-check-circle"}},emits:["operation:start","operation:over","blance:start","blance:over"],methods:{generate:function(e){this.animationController&&this.animationController.generate(e)},randomDelete:function(){this.animationController&&this.animationController.randomDelete()},add:function(e){this.animationController&&this.animationController.addNode(e)},delete:function(e){this.animationController&&this.animationController.deleteNode(e)},showError:function(e){this.tipMsg=e,this.tipColor="bg-danger",this.tipTextColor="text-white",this.tip.show()},blanceNextStep:function(){this.animationController&&this.animationController._nextStep()},fireOperationStart:function(){this.$emit("operation:start")},fireOperationOver:function(e){this.op=e.op;var t=e.id,n=e.num;this.tipMsg=de.generateOperationOverMsg(e.op,t,n,e.type),"success"==e.type&&(this.tipColor="bg-success",this.tipTextColor="text-white",this.tipIcon="fas fa-check-circle"),"update"==e.op&&(this.tipColor="bg-warning",this.tipTextColor="text-dark",this.tipIcon="fas fa-edit"),"error"==e.type&&(this.tipColor="bg-danger",this.tipTextColor="text-white",this.tipIcon="fas fa-exclamation-circle"),this.tip.show(),this.$emit("operation:over",e)},fireBlanceStart:function(e){this.$refs.blanceTip.showTip(e),this.$emit("blance:start",e)},fireBlanceOver:function(e){this.$emit("blance:over",e)}},mounted:function(){var e=this.$el,t=e.querySelector("#result-tip");this.tip=new bootstrap.Toast(t,{delay:3e3});var n=this.$el.querySelector("#canvas"),i=document.createElement("canvas");i.id="__front-canvas",i.className="front-canvas";var a=window.devicePixelRatio;null==a&&(a=1);var r=e.clientWidth,s=e.clientHeight;n.width=r*a,n.height=s*a,i.width=n.width,i.height=n.height,i.style.width="".concat(r,"px"),i.style.height="".concat(s,"px"),n.style.width="".concat(r,"px"),n.style.height="".concat(s,"px"),e.insertBefore(i,n.nextSibling);var o=n.getContext("2d"),l=i.getContext("2d");this.animationController=new Me(o,l,this.radius,this.xpadding,this.ypadding),this.animationController.on("operationStart",this.fireOperationStart),this.animationController.on("operationOver",this.fireOperationOver),this.animationController.on("blanceStepOver",this.fireBlanceOver),this.animationController.on("blanceStepStart",this.fireBlanceStart)}};vt.render=ee;var mt=vt,yt={name:"MainSpace",components:{OperateSpace:U,CanvasSpace:mt},data:function(){return{disableOperation:!1}},methods:{invalidId:function(e){this.$refs.canvas.showError($t("default.main.error1"))},invalidNum:function(e){this.$refs.canvas.showError($t("default.main.error2"))},add:function(e){this.$refs.canvas.add(e)},del:function(e){this.$refs.canvas.delete(e)},randomDelete:function(){this.$refs.canvas.randomDelete()},generate:function(e){this.$refs.canvas.generate(e)},operationStart:function(){this.disableOperation=!0},operationOver:function(){this.disableOperation=!1}}};yt.render=I;var bt=yt,kt={name:"App",components:{Header:w,Footer:P,MainSpace:bt},data:function(){return{currentLang:"zh"}},created:function(){de.$t=this.$t},methods:{switchLang:function(e){this.currentLang=e}}};kt.render=o;var wt=kt,xt=(0,a.o)({locale:"zh",fallbackLocale:"en",messages:{zh:n(5551),en:n(207)}}),_t=(0,i.ri)(wt);_t.use(xt),_t.mount("#app")}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,i,a,r){if(!i){var s=1/0;for(h=0;h<e.length;h++){i=e[h][0],a=e[h][1],r=e[h][2];for(var o=!0,l=0;l<i.length;l++)(!1&r||s>=r)&&Object.keys(n.O).every((function(e){return n.O[e](i[l])}))?i.splice(l--,1):(o=!1,r<s&&(s=r));o&&(e.splice(h--,1),t=a())}return t}r=r||0;for(var h=e.length;h>0&&e[h-1][2]>r;h--)e[h]=e[h-1];e[h]=[i,a,r]}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var a,r,s=i[0],o=i[1],l=i[2],h=0;for(a in o)n.o(o,a)&&(n.m[a]=o[a]);for(l&&l(n),t&&t(i);h<s.length;h++)r=s[h],n.o(e,r)&&e[r]&&e[r][0](),e[s[h]]=0;n.O()},i=self["webpackChunkbrtree"]=self["webpackChunkbrtree"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(143)}));i=n.O(i)})();